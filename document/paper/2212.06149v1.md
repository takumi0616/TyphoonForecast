# 再解析データを用いた熱帯低気圧の形成予測

## 著者情報
- **Sandeep Kumar** - デリー大学シャヒード・バガット・シン・カレッジ数学科 & IIIT デリー計算機科学科
- **Koushik Biswas** - IIIT デリー計算機科学科
- **Ashish Kumar Pandey** - IIIT デリー数学科

## 概要

熱帯低気圧（TC）の形成プロセスは、時間と空間によって変化する様々な大気、海洋、地理的要因に支配される、最も複雑な自然現象の一つです。数十年にわたる研究にもかかわらず、熱帯低気圧の形成を正確に予測することは依然として困難な課題です。既存の数値モデルには固有の限界があり、機械学習モデルはTC形成の背後にある因果要因の空間的・時間的次元を捉えることができません。

本研究では、最大60時間のリードタイムで高精度に熱帯低気圧の形成を予測できる深層学習モデルを提案します。このモデルは、高解像度再解析データERA5（ECMWF再解析第5世代）とベストトラックデータIBTrACS（International Best Track Archive for Climate Stewardship）を使用して、世界の6つの海洋流域における熱帯低気圧の形成を予測します。60時間のリードタイムで、モデルは6つの海洋流域全体で**86.9%〜92.9%**の範囲の精度を達成しました。モデルの訓練時間は海洋流域とデータ量に応じて約5〜15分で、数秒以内に予測できるため、実用的な使用に適しています。

**キーワード：** 熱帯低気圧、形成、予測、再解析データ

## 1. はじめに

### 1.1 背景
自然災害の形成は、時間的、空間的、高度的次元を持つ複数の因果要因を含む複雑な現象です。自然災害の進化過程を理解し、それをモデル化することは常に困難な課題です。そのような自然災害の一つが熱帯低気圧（TC）で、世界の熱帯・亜熱帯海域で頻繁に発生します。

### 1.2 熱帯低気圧の形成メカニズム
赤道付近では、暖かい空気が海面上で上昇し、低気圧システム（LPS）を作り出します。これは熱帯低気圧とも呼ばれます。これにより、LPS周辺の空気がそれに向かって移動し、さらに温められて上昇します。上昇する湿った空気は冷却され、雲を形成します。この雲の形成と風の回転のプロセスは、次のような好条件の助けを借りて強化されます：

- 海面温度が26°C以上
- 低い鉛直ウィンドシア
- 高い相対湿度
- 大気の不安定性

温かいコアの上昇する湿った空気と隣接する冷たい環境との温度差により、急速に上昇する浮力のある空気が生じます。これらすべてが、海洋学的、大気的、地理的要因に依存する複雑なTC発達プロセスを作り出します。

### 1.3 研究の重要性
これらのLPSのうち、上記の好条件下で完全なTCに発展するのはごく一部です。TC発達プロセスの背後にある理論はまだ確立されていないため、TC形成の予測は困難な問題です。TCは大雨、雷雨、沿岸地域の鉄砲水をもたらし、生態系、インフラ、人命に多大な損失をもたらします。また、気候変動により、TCの頻度、強度、および関連する危険性が増加することが予想されています。

これらすべてが、災害軽減の観点から、十分に前もってTC形成を予測できるモデルの開発を重要にしています。これにより、災害管理者は予防措置を講じるのに十分な時間を得られます。

### 1.4 本研究の貢献
本研究では、世界の6つの海洋流域（北大西洋（NA）、北インド洋（NI）、南インド洋（SI）、西太平洋（WP）、南太平洋（SP）、東太平洋（EP））について、わずか12時間の先行データを使用して最大60時間のリードタイムでTC形成を予測する深層学習モデルを提案しました。

## 2. 関連研究

### 2.1 TC検出のアプローチ
TCを検出するには主に2つのアプローチがあります：

1. **モデル駆動アプローチ：** TC発達の物理現象を支配する方程式に基づく（数値シミュレーションを含む）
2. **データ駆動アプローチ：** TCに関する履歴データを利用する（機械学習手法を含む）

### 2.2 従来の手法

#### Dvorak手法
最も初期の従来のTC検出方法は、初期段階のDvorak分析（EDA）（拡張Dvorak手法）で、衛星雲画像を利用します。しかし、この手法はパラメータの主観的解釈を含み、十分に科学的ではありません。EDAは、国立ハリケーンセンター（NHC）、中央太平洋ハリケーンセンター（CPHC）、日本気象庁（JMA）で使用され、形成の48時間前まで台風の発生を予測し、最大57%の精度を達成しています。

研究により、グローバルアンサンブルモデル（ECMWF、JMA、NCEP、英国気象庁）とEDAを組み合わせることで、精度を79%まで向上できることが示されています。

#### 数値気象予報（NWP）システム
5つのグローバルNWPシステム（GFS、ECMWF、CMC、UKMO、NOGAPS）の北大西洋海域における2004-2011年のTC予測性能評価では、最高のヒット率44%を達成できることが示されました。

### 2.3 統計的手法
線形判別分析（LDA）が、導出された大規模環境パラメータから24時間のTC形成確率を予測するために使用されました。しかし、TC形成につながる要因は非線形で複雑な関係を持つため、これらの線形手法はTC形成予測タスクには不適切です。

### 2.4 機械学習手法
様々な機械学習モデルがTC形成予測問題に適用されています：

#### 決定木（DT）
- 北太平洋海域の2004-2013年の6-9月について、NOGAPSから導出された5つのパラメータを使用
- 24時間のリードタイムで**84.6%**の精度を報告
- 相対渦度に基づいて発達と非発達の擾乱を区別

#### 多様な機械学習手法の比較
- DT、ランダムフォレスト（RF）、サポートベクターマシン（SVM）を使用
- WindSat衛星データから導出された8つの予測変数を使用
- 西北太平洋海域の2005-2009年を対象
- 最大持続風速が13m/s（25ノット）に達したときにTCと分類

#### 13予測変数を使用した包括的比較
メソスケール対流システム（MCS）データとERA-Interimデータセットから導出された13の予測変数を使用：
- ロジスティック回帰（LR）
- ナイーブベイズ（NB）
- 決定木（DT）
- K近傍法（KNN）
- 多層パーセプトロン（MLP）
- 二次判別分析（QDA）
- SVM
- AdaBoost（ADA）
- ランダムフォレスト（RF）

F1スコア、精度、再現率の観点から、6時間、12時間、24時間、48時間のリードタイムについて、グローバル（すべての海洋流域）、NA、西北太平洋（WNP）海洋流域での精度を報告しました。

### 2.5 深層学習手法
近年、深層学習研究がTCの進路、強度、上陸特性に関連する予測問題を解決することに成功しています。

#### TC検出のための深層学習
- **CNNを使用した研究：** 雲解像全球非静力学大気モデルで生成された30年間のシミュレートされた外向き長波放射（OLR）データを使用して、世界の6つの海洋流域でTCとその前駆体を検出
- TCとその前駆体は、温度、風の水平成分、海面気圧（SLP）を入力とするTC追跡アルゴリズムに基づいて1つのクラスとして分類
- 緯度30°S〜30°Nの限定範囲に制限

#### 進行中のTC検出
- 衛星データを使用してNI海洋流域の8つのTCの進行中のTCを検出
- ハイブリッドCNN-LSTMモデルを使用して、進行中のTCが台風レベル（風速64ノット以上）に強化されるかどうかを24時間のリードタイムで予測
- 6時間、12時間、18時間、または24時間の先行データを使用
- IBTrACSデータとERA-Interimデータセットを使用
- 3つの海洋流域（WP、EP、NA）で実施

**現状の課題：** 深層学習研究は非常に少なく、それぞれが独自のTC形成検出基準を持っています。

## 3. データ

### 3.1 ERA5再解析データセット
本研究では、最近の研究でTC関連の進路、強度、上陸特性の問題に答えるために成功裏に使用された再解析データセットに着想を得て、ECMWFが提供するERA5高解像度再解析データセットを使用しました。これは、全球の時間毎の気象・気候データを提供する高解像度データです。

研究により、再解析データセットでTCがどれだけよく表現されているかが示されています。TCの形成プロセスは、LPSの中心周辺の様々な高度における大規模な大気要因によって決定されます。

### 3.2 使用された気象変数
本研究では、3つの気圧レベル（高度）で以下の変数を抽出しました：
- **225 hPa（約10-12 km高度）**
- **500 hPa（約5-6 km高度）**
- **700 hPa（約3 km高度）**

**抽出された変数：**
1. **風場 u, v：** 東西および南北の空気の移動とその速度を表す
2. **ジオポテンシャル z：** 海面に対する重力ポテンシャルエネルギーを表す
3. **相対湿度 r：** 水蒸気圧を表す
4. **温度 t：** 大気温度を表す

### 3.3 空間解像度
TC形成の背後にある大気因果要因は最大1000キロメートル（km）の水平範囲を持つ可能性があるため、これらの変数は次のように抽出されました：
- **空間領域：** 5° × 5°
- **解像度：** 0.25°
- **グリッド：** 41 × 41

赤道付近で1度は約110 kmで、極に向かうにつれて減少します。これにより、約25 kmの解像度で約1000 kmの空間範囲が得られました。

### 3.4 IBTrACSデータセット
国立海洋大気庁（NOAA）が管理するIBTrACSデータセットは、熱帯低気圧またはLPSとして最初に検出されたときからの、時間、進路（緯度と経度）、強度、その他多くの変数の形式で、すべてのTCの3時間毎のグローバル記録を保持しています。

**TC発生時刻の定義：** TC発生時刻の定義は曖昧であるため、IBTrACSでLPSとして最初に記録された時刻をTC形成時刻としました。

### 3.5 データセット構築

#### 正例クラス（TC形成）
1980年から2021年9月までの前述の6つの海洋流域すべてのTCについて、TC形成時刻と対応する位置（緯度、経度）の記録を抽出しました。

**各海洋流域の正例数：**
- 北大西洋（NA）：653
- 北インド洋（NI）：360
- 南インド洋（SI）：832
- 西太平洋（WP）：1,431
- 南太平洋（SP）：509
- 東太平洋（EP）：983

#### 負例クラス（非TC形成）
特定の海洋流域の負例クラス（非TC形成データ）を生成するために、アルゴリズム1に従いました。これにより、データセット内の正例クラスと負例クラスの数が等しくなりました。

**負例サンプルの定義：**
時刻 t と位置 loc を表す負例クラスサンプルは、次の条件を満たします：
- 5日間の時間ウィンドウ内に既存のTC形成がない
- t が5日間のウィンドウ内にある場合、5°の空間ウィンドウ内に既存のTC形成がない

### 3.6 再解析データの抽出
各サンプル（TC形成および非TC形成）について、上記の再解析データを次のように抽出しました：
- **グリッドサイズ：** 各サンプルの位置を中心とした41 × 41
- **時間点：** t-6k（12 ≥ k ≥ 4）、ここで t はTC形成時刻または非TC形成サンプルのランダムに選択された時刻
- **時間間隔：** 6時間間隔
- **データポイント数：** t-72h から t-24h まで9時間点

データの図示表現を図2に示します。

## 4. モデルとその実装

### 4.1 訓練データセットの準備
TCの場合、上記のように6時間間隔で9つのデータポイントが利用可能です。T個のデータポイント（(T-1)*6時間のデータ）を使用してTCの形成を予測したい場合、10-T個の訓練データポイントを生成します。

**単一訓練ポイントの形式：**
```
( u₂₂₅(t), v₂₂₅(t), z₂₂₅(t), r₂₂₅(t), t₂₂₅(t),
  u₅₀₀(t), v₅₀₀(t), z₅₀₀(t), r₅₀₀(t), t₅₀₀(t),
  u₇₀₀(t), v₇₀₀(t), z₇₀₀(t), r₇₀₀(t), t₇₀₀(t) )
```

ここで、k ≤ t ≤ T+k-1 で、k は 1 から 10-T まで変化します。

各訓練ポイントについて、目標変数は1（正例クラス）または0（負例クラス）です。このプロセスにより、リード時間 6k 時間（4 ≤ k ≤ 9+4-T）で 10-T 個の訓練ポイントが形成されます。

### 4.2 モデルアーキテクチャ
データセットには空間的および時間的次元の両方があるため、モデルはCNN（畳み込みニューラルネットワーク）とLSTM（長短期記憶）ネットワークの組み合わせを利用して、TC形成の背後にある因果要因を効果的に捉えます。

**入力データの次元：** (T, 15, 41, 41)
- **T：** 連続データポイントの長さ（6*(T-1)時間）
- **15：** チャネル数（3つの気圧レベルでのu, v, z, r, t場に対応）
- **(41, 41)：** TC形成位置を中心としたグリッドの形状

**モデル構造：**
1. **4つの交互の畳み込み層とマックスプーリング層**
   - KerasのTimeDistributedレイヤーを使用して長さTの連続特徴を生成

2. **3つのLSTM層からなるスタックLSTM**
   - 過学習を避けるために、連続する2つのLSTM層の間にドロップアウト0.15を使用

3. **軽量モデル**
   - わずか283,073個の訓練可能なパラメータ

図3にT=3の場合のモデルと各レイヤーの入出力サイズを示します。

### 4.3 訓練と実装

#### ハイパーパラメータ
様々なモデル構成（レイヤー数とノード数、活性化関数、学習率）を実験しました。すべての海洋流域で良好に機能する構成を報告します：

- **活性化関数：**
  - 最後のレイヤー以外：ReLU(x) = max(0, x)
  - 最後のレイヤー：Sigmoid(x) = 1/(1+exp(-x))

- **データ正規化：**
  - Scikit-learnライブラリのMinMaxScalerを使用して(-1, 1)の範囲にスケーリング
  - より高速で安定した訓練のため

- **最適化設定：**
  - オプティマイザ：Adam
  - デフォルト学習率：0.001
  - 損失関数：バイナリクロスエントロピー
  - バッチサイズ：32
  - エポック数：30

#### 実装環境
- **プラットフォーム：** Nvidia Tesla V100 GPU、16 GB RAM
- **フレームワーク：** TensorFlowで開発されたKeras API
- **訓練時間：** 海洋流域とTに応じて30エポックで約5〜15分

### 4.4 評価指標
研究では、以下の指標でモデルの性能を評価しました：

**指標の定義：**
```
適合率（Precision, P）= TP / (TP + FP)
再現率（Recall, R）= TP / (TP + FN)
精度（Accuracy）= (TP + TN) / (TP + TN + FP + FN)
F1スコア（F1）= 2PR / (P + R)
```

ここで：
- **TP（True Positive）：** 実際にTCで、TCと予測
- **TN（True Negative）：** 実際に非TCで、非TCと予測
- **FP（False Positive）：** 実際に非TCだが、TCと予測
- **FN（False Negative）：** 実際にTCだが、非TCと予測

**評価方法：**
- 5分割交差検証を使用
- データセットを5つの等しいサブセットに分割
- 4つのサブセットで訓練し、1つのサブセットで評価
- 5回の実行の平均と変動を報告

**望ましい特性：**
- **高い適合率：** モデルからのTC形成警告を無視できないことを示す
- **高い再現率：** モデルが高い確率で可能なTC形成を検出できることを示す
- **F1スコア：** 適合率と再現率のバランスの尺度

## 5. 結果と分析

### 5.1 全体的な性能

提案されたモデルは、t-72からt-24時間までの6時間間隔の12時間または24時間（T = 3または5に対応）の連続データを入力として受け取り、TCが形成されるかどうかを予測します。

**予測リードタイム：**
- 特定のTに対して、リードタイム 6k（4 ≤ k ≤ 13-T）で予測
- したがって、モデルは少なくとも24時間のリードタイムで予測（実用的な有用性のための最小要件）

### 5.2 詳細な性能結果

#### T = 3（12時間データ）の場合
表2は、T = 3の場合の5分割交差検証性能（±標準偏差）を示します：

**24時間リードタイム：**
- 精度：91.7%〜97.7%の範囲
- 適合率：88.4%〜96.4%の範囲
- 再現率：94.4%〜99.2%の範囲
- F1スコア：92.0%〜97.8%の範囲

**36時間リードタイム：**
- 精度：96.4%〜99.3%の範囲
- 24時間リードタイムよりもさらに優れている
- すべての海洋流域で一貫して高い性能

**48時間リードタイム：**
- 精度：95.4%〜99.1%の範囲
- 24時間リードタイムより優れ、36時間リードタイムとほぼ同等

**60時間リードタイム：**
- 精度：86.9%〜92.9%の範囲
- TC形成の背後にある因果要因の動態が時間とともに急速に変化することを考えると、優れていると考えられる

#### T = 5（24時間データ）の場合
表3は、T = 5の場合の5分割交差検証性能を示します：

**24時間リードタイム：**
- 精度：93.5%〜97.4%の範囲
- 36時間（T = 5）のデータがより良い結果を提供

**36時間リードタイム：**
- 精度：97.2%〜99.1%の範囲
- 優れた性能を維持

**48時間リードタイム：**
- 精度：24時間および36時間リードタイムと比較して約5%〜9%低下
- 48時間リードタイム予測には T = 3 がより良い選択

### 5.3 適合率と再現率の分析

**適合率：**
- T = 3および5の両方で88.4%〜96.4%の範囲で非常に高い
- 誤警報率が非常に小さい
- モデルからの可能なTC形成に関する警告は無視できない

**再現率：**
- T = 3および5の両方で94.4%〜99.2%の範囲で非常に高い
- モデルがほぼすべてのTC形成ケースを検出している
- 実用目的で信頼性を持って使用できる

### 5.4 訓練の収束
図4は、NA海洋流域の訓練セットとテストセットのエポック毎の精度を示しています。他の海洋流域でも同様の訓練-テスト精度の収束を達成しました。

### 5.5 既存研究との比較

表4は、研究[15]で報告された最良の5分割交差検証性能との比較を示します。[15]では、9つの機械学習モデルを評価し、全体的にAdaBoostが最も良好に機能しました。

**比較結果：**

**24時間リードタイム：**
- **NA海洋流域：**
  - 適合率：ほぼ同等（0.951 vs 0.937）
  - 再現率：大幅な改善（0.965 vs 0.880）
  - F1スコア：改善（0.953 vs 0.908）

- **WP海洋流域：**
  - 適合率：ほぼ同等（0.920 vs 0.948）
  - 再現率：大幅な改善（0.965 vs 0.754）
  - F1スコア：大幅な改善（0.937 vs 0.817）

**48時間リードタイム：**
- **NA海洋流域：**
  - 適合率：9%以上の改善（0.977 vs 0.888）
  - 再現率：28%以上の改善（0.976 vs 0.683）
  - F1スコア：大幅な改善（0.976 vs 0.757）

- **WP海洋流域：**
  - 適合率：9%以上の改善（0.978 vs 0.889）
  - 再現率：28%以上の改善（0.966 vs 0.642）
  - F1スコア：大幅な改善（0.972 vs 0.701）

### 5.6 36時間リードタイムの優位性
36時間リードタイムの精度が24時間リードタイムよりも優れている理由として、研究で選択した再解析変数がこのリードタイムでTC形成をより良く区別し、表現する可能性が考えられます。

## 6. 結論

### 6.1 主な成果
本研究では、わずか12時間のデータを使用し、最大60時間のリードタイムで、世界の6つの海洋流域全体で高い適合率、再現率、F1スコアでTC形成を予測できる深層学習モデルを提案しました。

潜在的なサイクロン形成に関する早期情報は、社会的、経済的、環境的に大きな利益をもたらします。

### 6.2 重要な知見
本研究を通じて、著者らは次のことを確立しました：
- 再解析データセットには、サイクロン形成の背後にある複雑で非線形な自然現象を捉えるのに十分な情報が含まれている
- より長いリードタイム予測のために再解析データセットをさらに活用できる

### 6.3 今後の改善可能性

#### 追加変数の探索
再解析データセットは、以下のような他の多くの変数を提供します：
- 雲の被覆
- 渦度
- 海面温度など

これらの変数を探索することで、モデルをさらに改善できる可能性があります。

#### データセットの不均衡への対処
提案モデルの欠点の1つは、研究において正例と負例のサンプル数を等しく取ったことです。ランダムな場所と時刻が与えられた場合、TC形成の可能性は非常に低いです。したがって、本研究の可能な改善は、正例サンプルよりも多くの負例サンプルを取ることです。

## 参考文献（References）

[1] Erik Palmen. On the formation and structure of tropical hurricanes. Geophysica, 3(1):26–38, 1948.

[2] RUSSELL L ELSBERRY. Tropical cyclone motion. global perspectives on tropical cyclones. WMO/TD-No. 693, pages 106–197, 1995.

[3] William M Gray. Global view of the origin of tropical disturbances and storms. Monthly Weather Review, 96(10):669–700, 1968.

[4] Kerry A Emanuel. The finite-amplitude nature of tropical cyclogenesis. Journal of Atmospheric Sciences, 46(22):3431–3456, 1989.

[5] Thomas Knutson, et al. Tropical cyclones and climate change assessment: Part i: Detection and attribution. Bulletin of the American Meteorological Society, 100(10):1987 – 2007, 2019.

[6] Vernon F. Dvorak. Tropical cyclone intensity analysis and forecasting from satellite imagery. Monthly Weather Review, 103(5):420 – 430, 1975.

[7] Vernon F Dvorak. Tropical cyclone intensity analysis using satellite data, volume 11. US Department of Commerce, National Oceanic and Atmospheric Administration, 1984.

[8] Joshua H. Cossuth, et al. Tropical cyclone formation guidance using pregenesis dvorak climatology. part i: Operational forecasting and predictive potential. Weather and Forecasting, 28(1):100 – 118, 2013.

[9] Munehiko Yamaguchi and Naohisa Koide. Tropical cyclone genesis guidance using the early stage dvorak analysis and global ensembles. Weather and Forecasting, 32(6):2133 – 2141, 2017.

[10] Daniel J Halperin, et al. An evaluation of tropical cyclone genesis forecasts from global numerical models. Weather and Forecasting, 28(6):1423–1445, 2013.

[11] Andrea B. Schumacher, Mark DeMaria, and John A. Knaff. Objective estimation of the 24-h probability of tropical cyclone formation. Weather and Forecasting, 24(2):456 – 471, 2009.

[12] Christopher C Hennon and Jay S Hobgood. Forecasting tropical cyclogenesis over the atlantic basin using large-scale data. Monthly weather review, 131(12):2927–2940, 2003.

[13] Wei Zhang, et al. Discriminating developing versus nondeveloping tropical disturbances in the western north pacific through decision tree analysis. Weather and Forecasting, 30(2):446 – 454, 2015.

[14] Minsang Kim, et al. Machine learning approaches for detecting tropical cyclone formation using satellite data. Remote Sensing, 11(10), 2019.

[15] Tao Zhang, et al. Prediction of tropical cyclone genesis from mesoscale convective systems using machine learning. Weather and Forecasting, 34(4):1035 – 1049, 2019.

[16-48] [その他の参考文献は原論文を参照]

## まとめ

本研究は、わずか12時間の先行データを使用して最大60時間のリードタイムで熱帯低気圧の形成を高精度で予測できる深層学習モデルを提示しました。主な成果は以下の通りです：

### 主要な成果

1. **高い予測精度**：
   - 24時間リードタイム：91.7%〜97.7%の精度
   - 36時間リードタイム：96.4%〜99.3%の精度
   - 60時間リードタイム：86.9%〜92.9%の精度

2. **優れた性能指標**：
   - 適合率：88.4%〜96.4%（誤警報率が非常に低い）
   - 再現率：94.4%〜99.2%（ほとんどすべてのTC形成を検出）
   - F1スコア：92.0%〜97.8%

3. **実用性**：
   - 訓練時間：約5〜15分（海洋流域により異なる）
   - 予測時間：数秒以内
   - 単一GPU（Nvidia Tesla V100）で動作

4. **広範な適用**：
   - 世界の6つの海洋流域すべてで高精度を達成
   - 既存の機械学習手法と比較して大幅な改善

### 重要な知見

本研究により、ERA5再解析データセットには、サイクロン形成の背後にある複雑で非線形な自然現象を捉えるのに十分な情報が含まれていることが確立されました。

### 今後の改善方向

1. **追加変数の探索**：雲の被覆、渦度、海面温度などの他の変数を含める
2. **データ不均衡への対処**：正例よりも多くの負例サンプルを使用
3. **より長いリードタイム**：60時間を超える予測への拡張

この研究は、熱帯低気圧の早期警告システムの改善に貢献し、災害管理と人命保護に重要な影響を与える可能性があります。
