# AI の天気予報モデルは分布外のグレイスワン熱帯低気圧を予測できるか？

## 論文情報

- **タイトル**: Can AI weather models predict out-of-distribution gray swan tropical cyclones?
- **著者**: Y. Qiang Sun, Pedram Hassanzadeh, Mohsen Zand, Ashesh Chattopadhyay, Jonathan Weare, Dorian S. Abbot
- **所属**: シカゴ大学、カリフォルニア大学サンタクルーズ校、ニューヨーク大学
- **発表日**: 2024 年 10 月 22 日
- **arXiv ID**: 2410.14932v1

## 概要

本論文は、AI の天気予報/気候モデルが、訓練データセットには存在しないが物理的には可能な「グレイスワン」の極端気象現象を予測できるかという重要な問題を検証している。特に、AI モデルが訓練セットに存在する弱い気象現象から、未知のより強い気象極端現象へ外挿できるかをテストしている。

### 研究の核心的な問い

訓練データに含まれるカテゴリー 1-2 の熱帯低気圧（TC）から、未知のカテゴリー 5 の TC を予測できるか？

## 1. イントロダクション

### 1.1 AI の天気予報モデルの台頭

近年、以下のような高精度な AI 天気予報モデルが急速に登場している：

- **FourCastNet** [1]
- **Pangu** [2]
- **GraphCast** [3]
- **AIFS** [4]
- **Fuxi** [5]
- **Stormer** [6]

これらのデータ駆動型モデルは、1979-2015 年の ERA5 再解析データセットで訓練された深層ニューラルネットワーク（NN）であり、6 時間または 12 時間単位で 3 次元全球大気状態の進化を予測する。

### 1.2 AI モデルの利点

#### 精度

- 2018-2023 年の範囲外（out-of-sample）予測で、最良の数値モデルを最大 10 日間上回る
- 熱帯低気圧の追跡などの極端現象の一部の側面で優れた性能

#### 計算速度

- 訓練後、最先端の数値モデルより**10^4 ～ 10^5 倍高速**に実行可能
- 大規模アンサンブルおよび確率的予報の生成が可能
- AI 気候エミュレーターの開発への新しい道を開く

### 1.3 主要な研究課題

**最も稀で影響力のある極端現象の予測/エミュレート能力**

#### データ不均衡問題

最も極端な気象現象の稀少性により、AI モデルにとって学習が困難になる：

- 統計学習における古典的な「データ不均衡」問題
- AI の天気予報モデルは、熱波や TC のピーク振幅を過小評価する傾向

#### TC 追跡の現状

- TC 追跡で顕著なスキル（強度よりもはるかに優れている）
- しかし、TC 追跡は、稀ではない大規模な背景風によって主に決定される

### 1.4 グレイスワン極端現象

**定義**（Lin and Emmanuel [35]）:

- 物理的には可能だが、歴史的記録で実際に観測されたことがない稀な気象現象
- AI 気候科学の文脈では、訓練セットよりも稀で強い、物理的に可能な気象現象
- つまり、「分布外」の現象

### 1.5 研究の動機

#### 仮説

物理システム（気候など）では、AI モデルが弱い（分布内）現象から主要な物理的関係を学習し、より強い（分布外）現象に一般化できる可能性がある。

#### 既存の示唆的研究

- **Hakim and Masanam [36]**: AI の天気予報モデルが、訓練セットのどのパターンとも大きく異なる、高度に局所的な（ただし極端ではない）摂動に対する大気の応答を予測する能力
- **Rackow et al. [37]**: 気候変動下での比較的堅牢な予報スキル

### 1.6 本研究の目的

**高度に制御された実験**で、AI の天気予報モデル FourCastNet がグレイスワン TC を予報できるかを検証する。

## 2. 研究方法

### 2.1 実験設計の概要（図 1）

#### 訓練セットの作成

元の ERA5 1979-2015 訓練セット（Full）から 4 つの追加訓練セットを作成：

1. **noTC**:

   - 熱帯域（30S-30N）で平均海面気圧（mslp）が 25 パーセンタイル（988 hPa）未満のサンプルを削除
   - 大まかに、世界のどこでもカテゴリー 3-5 の TC を含むサンプルを削除したことに相当

2. **Rand**:

   - noTC と同じサイズと季節分布
   - Full セットからサンプルの 25%をランダムに削除
   - ただし、カテゴリー 3-5 の TC の削除は回避

3. **noWP**:

   - 西太平洋上で熱帯域 mslp が 988 hPa 未満のサンプルを削除

4. **noNA**:
   - 北大西洋上で熱帯域 mslp が 988 hPa 未満のサンプルを削除

#### モデルの訓練

- 各訓練セットで 5 つのバージョンの FourCastNet を訓練
- それぞれ異なるランダムな重みとバイアスの初期化から
- **合計 25 の独立訓練モデル**

#### テスト

- テスト期間（2018-2023）の最も強い TC（下位 5 パーセンタイル）の mslp 進化に関する予報スキルを定量化
- これは大まかにカテゴリー 5 に対応

### 2.2 なぜ FourCastNet か

- 訓練用に公開された最初の最先端 AI の天気予報モデル
- 訓練コストが最も安い
- ただし、25 の独立バージョンの訓練は計算的に要求が大きい

**注意**: 各バージョンはランダムな初期重みから訓練する必要があり、事前訓練された FourCastNet のファインチューニングはできない

### 2.3 一般化可能性の期待

現在の最先端 AI 天気/気候モデルは同じ主要な学習プロセスを共有しているため、本研究の知見は他のモデルや極端現象にも適用されることが期待される。

### 2.4 データと FourCastNet の詳細

#### ERA5 データ

- 0.25 度の ECMWF ERA5 再解析データ
- 訓練: 1979-2015 年
- テスト: 2018-2023 年

#### TC の定義

- **カテゴリー 5（ERA5 内）**: mslp が 970.0 hPa 未満で、12 時間以上持続
- **訓練セットのカテゴリー 3-5 相当**: mslp < 988.0 hPa

#### テストケース構成

- 各カテゴリー 5 TC テストケース：
  - 1 つのコントロールメンバー（ERA5 からの初期条件、IC）
  - 50 の摂動 IC メンバー
  - 摂動は ECMWF のアンサンブル・データ同化（EDA）から取得

#### FourCastNet アーキテクチャ

- 適応フーリエニューラルオペレーター（AFNO）フレームワークを使用
- ビジョントランスフォーマーのアテンション機構を効率的にパラメータ化
- 6 時間のタイムステップ（Δt=6h）
- 自己回帰的に x(t+Δt)を x(t)から予測：
  ```
  x(t+Δt) = M(x(t), θ)
  ```
  - x(t): ERA5 からの 33 個の大気変数からなる 3D 大気状態
  - θ: モデルの訓練可能なパラメータ

#### 訓練手順

1. **事前訓練**: 80 エポック
   - コサイン学習率スケジュール
   - 開始学習率: ℓ₁ = 5×10⁻⁴
2. **ファインチューニング**: 追加 50 エポック

   - コサイン学習率スケジュール
   - 低い学習率: ℓ₂ = 10⁻⁴

3. **ノイズ追加**:
   - 訓練中、入力 x(t)にゼロ平均ガウスノイズ（分散 0.3）を追加
   - 推論時のアンサンブル予報の安定性に不可欠

#### 計算リソース

- 1 モデルの完全訓練: 4 つの A100 GPU で約 7 日間

#### 訓練セットの詳細な準備

**noTC 訓練セット**:

- 25 パーセンタイル閾値: 988.0 hPa
- FourCastNet のファインチューニングには 2 つの将来タイムステップが必要
- したがって、x(t)に加えて x(t-2Δt)と x(t-Δt)も削除
- 結果: 訓練データの 25%が除外

**Rand 訓練セット**:

- すべての主要 TC を含む
- nOTC と同じ総サンプル数と年間サイクル分布
- カテゴリー 3-5 の TC を含まないサンプルをランダムに削除

**noWP と noNA**:

- noWP: 西太平洋の強い TC によるサンプルの約 51%が削除
- noNA: 北大西洋の強い TC によるサンプルの約 9%が削除

## 3. 結果

### 3.1 分布外グレイスワン TC への外挿の失敗

#### ケーススタディ: ハリケーン・リー（2023 年、カテゴリー 5）

図 1(b)は、FourCastNet-Full、-Rand、-noTC のハリケーン・リーに対する予報スキルを比較している。

**ハリケーン・リーの特徴**:

- 24 時間で風速が 85 mph（140 km/h）増加
- 急速な強度化の後、ピーク強度に到達

**FourCastNet-Full と FourCastNet-Rand の性能**:

- 訓練データセットにリーと同様の強度の TC が存在
- 両モデルともリーの急速な強度化をかなりうまく予報
- ただし、ERA5 と比較して約 1 日の遅れがある予報 mslp 進化
- **重要**: 255 のアンサンブル予報のほとんどすべてが、970 hPa 未満の最小 mslp に到達（ERA5 データのカテゴリー 5 TC の閾値）

**FourCastNet-noTC の性能**:

- noTC 訓練データセットには比較的強い TC が存在しない（mslp≥988 hPa）
- したがって、ハリケーン・リーは FourCastNet-noTC にとって**分布外のグレイスワン現象**
- 性能は Full、Rand よりもはるかに悪い

**FourCastNet-noTC の予報の特徴的な挙動**:

1. すべてのメンバーが最初からリーの弱化を予報（つまり、mslp が増加）
2. その後、非常に遅い再強度化
3. mslp は 5 日間の予報期間中 980 hPa 以上に留まる

**誤報の重要性**:

- noTC の mslp 閾値は 988 hPa であり、FourCastNet-noTC の予測は熱帯域で見られた最低 mslp をかろうじて下回る程度
- FourCastNet-noTC は不正確なだけでなく、**「偽陰性」を生じる** - 意思決定において最悪のエラータイプ
- モデルは壊滅的なカテゴリー 5 TC ではなく、中程度のカテゴリー 3 TC を予報
- 予報が不正確であるという信号がない

#### 全 20 のカテゴリー 5 TC の集計結果（図 2）

**初期化フェーズ**:

1. **弱いフェーズ**: カテゴリー 4 から 5 への移行前
2. **強いフェーズ**: カテゴリー 4 から 5 への移行中

**FourCastNet-Full と FourCastNet-Rand の性能**（列(a)(b)(d)(e)）:

- 弱いフェーズと強いフェーズの両方からの初期化で、最小 mslp の進化をかなりうまく予報
- TC の強度を過小予測する一貫したバイアスを示す
  - 他の最先端 AI の天気予報モデルで報告された結果と類似
  - データ不均衡やスペクトルバイアスによるぼやけなどの問題に起因する可能性

**FourCastNet-noTC の性能**（列(c)(f)）:

- mslp の進化を大幅に過小予測
- 弱いフェーズから初期化した場合:
  - 初日の強度化にはある程度のスキルを示す
  - ERA5 mslp が約 1 日後に 988 hPa の臨界値に近づくと、予報の強度化が劇的に減速
  - mslp は 980 hPa をかろうじて下回る程度
- 強いフェーズから初期化した場合（分布外の初期条件）:
  - TC の弱化を予報
  - モデルは訓練で見た強度の値（988 hPa 以上）に向けて緩和しようとする
  - ERA5 で観測されたより低い mslp 値への強度化ではなく

**重要な観察**:

- FourCastNet-Full と FourCastNet-Rand のカテゴリー 5 TC での同様の性能は、25%短い訓練セットが予報スキルに影響しないことを示す
- したがって、これが FourCastNet-noTC の劣悪な性能の理由ではない

**結論**:
これらの比較は一貫して、**FourCastNet が弱い TC（カテゴリー 1-2）から学習し、未知の強いカテゴリー 5 TC へ外挿できない**ことを示している。

#### 典型的な天気での性能

グレイスワン TC への外挿能力の欠如にもかかわらず、FourCastNet-noTC は、すべてのモデルが訓練セットで見る典型的な天気について、FourCastNet-Full および FourCastNet-Rand と同様に機能する：

- **全球天気**: 類似の予報スキル（アノマリー相関係数、ACC に基づく）- 図 S2
- **弱い TC（カテゴリー 1-2）**: テストセットで類似の性能 - 図 S3

### 3.2 熱帯海盆間の一般化における部分的成功

#### 熱帯域と中緯度の低気圧の違い

**重要な観察**（図 3、図 S1(a)）:
FourCastNet-noTC の訓練データセットには：

- 熱帯域で mslp < 988 hPa の TC（またはサンプル）は存在しない
- しかし、中緯度では 988 hPa 未満の mslp を持つサンプルが豊富に存在（温帯低気圧に関連）
- 全球的に mslp の値を考慮すると、mslp < 988 hPa は全く前例のないものでも分布外でもない

#### なぜ中緯度低気圧からの学習が TC に適用されないのか？

**TC と温帯低気圧のダイナミクスの違い**:

**熱帯低気圧（TC）**:

- 対流と潜熱加熱によって駆動
- 方位角方向の風が低気圧中心の近くで最大に達する
- mslp が 1000 hPa 以下に減少すると風速が増加する顕著な傾向（図 3）

**温帯低気圧**:

- 傾圧不安定性によって駆動
- 風のプロファイルが異なる
- mslp と風速の関係がはるかに弱い
- mslp が低いときに低風速であることは珍しくない

**AI モデルにとっての影響**:

- これらの違いは、単一変数（mslp など）ではなく、状態ベクトル全体（入力）の進化に現れる
- 図 3 の同時確率密度関数（PDF）で見ることができる
- 異なる物理メカニズムが、時空間における物理変数間の異なる関係をもたらす
- これにより、FourCastNet-noTC が、中緯度の強い低 mslp 低気圧から熱帯域のグレイスワン現象へ一般化することが妨げられる

#### 熱帯海盆間の一般化

**研究の問い**:
FourCastNet は、訓練セットで見た一つの熱帯海盆の強い TC から別の海盆へ一般化できるか？

**2 つの主要な海盆の類似性**（図 S1(b)-(e)）:

- 北大西洋と西太平洋
- 主に大規模循環の違いにより違いがある
- しかし、両地域の TC は基本的に類似のダイナミカルプロセスによって駆動される
- mslp と 10 メートル風の分布に実質的な類似性

**結果**（図 4）:
FourCastNet-noWP と FourCastNet-noNA は、それぞれ西太平洋と北大西洋海盆のカテゴリー 5 TC でテストされた場合、FourCastNet-noTC よりも**大幅に良好な性能**を示す：

1. **強度化の予報**: すべてのテストされた TC について、弱いおよび強い初期条件の両方から強度化を予報
2. **最小 mslp**: 多くの嵐について 970 hPa 未満の最小 mslp を生成
3. **比較**: FourCastNet-noWP の性能は、西太平洋海盆でテストされた 13 の TC のうち 3 つについて、FourCastNet-Full と類似（図示なし）

**性能低下の理由**:
FourCastNet-noWP と FourCastNet-noNA の FourCastNet-Full に対する性能低下は、訓練データセットの強い TC の数が少ないことに起因する可能性がある（この効果を FourCastNet-Rand の訓練で意図的に回避）。

**結論**:
この分析は、FourCastNet が**ダイナミカルに類似した現象から学習することで地理的領域間を効果的に一般化できる**ことを示唆している。

**重要な強調**:
ダイナミカルな類似性の必要性を強調する必要がある。FourCastNet-noTC は強い温帯低気圧から未知の強い TC へ一般化できなかった。

### 3.3 予報の物理的整合性の欠如

#### 物理的制約の追加

物理的制約の追加は、以下の改善手段としてしばしば引用される：

- 極端気象現象に対する AI 天気/気候モデルのスキル改善
- 分布外一般化の改善

#### 勾配風バランスの検証

**勾配風バランス**（式 1）:
境界層の上では、TC は方位角平均において、気圧傾度力とコリオリ力および遠心力の間の勾配風バランスをほぼ満たす：

```
g ∂Z/∂r = V²ᵍ/r + fVᵍ
```

ここで：

- Vᵍ: 方位角勾配風
- Z: ジオポテンシャル高度（所定の気圧面の高度）
- g: 重力加速度
- r: サイクロン中心からの動径距離
- f: コリオリパラメータ

#### 結果（図 5）

**ERA5 データのカテゴリー 5 TC**:

- すべての動径長スケールにわたって勾配風バランスが成立
- ERA5 は観測により適合するためのデータ同化中の比較的小さな調整を伴う物理モデルに基づく
- TC の運動方程式における支配的なバランスは勾配風バランス

**FourCastNet-Full と FourCastNet-noTC の予報**:

- TC 中心から**約 200km 以内**で勾配風バランスが観測されない
- 期待されるバランスの欠如（つまり、完全風と勾配風の差）は、TC の強いフェーズで初期化された予報で最も顕著

**驚くべき発見**:
FourCastNet-Full はカテゴリー 5 TC の進化の予報において FourCastNet-noTC よりもはるかに成功しているにもかかわらず、**風と気圧場の物理的整合性は FourCastNet-Full と FourCastNet-noTC で同程度に悪い**。

#### 他のモデルでも同様の問題

最近のいくつかの研究が、他の最先端 AI 天気予報モデルでも物理的バランスの欠如を指摘している[32, 34]。

## 4. まとめと議論

### 4.1 主要な発見

本研究は、訓練セットからカテゴリー 3-5 の TC を削除した後に AI の天気予報モデル FourCastNet を訓練する制御実験を実施し、以下を実証した：

#### 1. 気象極端現象に対する分布外一般化（外挿）の欠如

**発見**:

- FourCastNet は、訓練セットに存在した弱い TC（カテゴリー 1-2）から、未知の強い TC（カテゴリー 5）について学習することが**できない**（図 1-2）
- これは、noTC 訓練セットに低 mslp の温帯低気圧（カテゴリー 5 TC のレベル）が存在するにもかかわらず

**理由**:

- 温帯低気圧と TC は異なるダイナミクスを持つ（mslp-風の同時 PDF に現れる、図 3 および図 S1）
- したがって、FourCastNet-noTC はこれらの現象からカテゴリー 5 TC について学習できなかった

#### 2. 海洋海盆間でダイナミカルに類似した現象に対する一部の一般化

**発見**:

- FourCastNet は、一つの海洋海盆で訓練セットで見た強い TC から、別の海盆の未知の強い TC について何かを学習することが**できる**（図 4）

**驚き**:

- 地域情報（例：緯度、経度、地形）が入力に暗黙的にエンコードされているため、これはやや驚くべきこと

#### 3. 物理的整合性の欠如

**発見**:

- Full または nOTC データセットで訓練されたかどうかに関わらず、FourCastNet は**勾配風バランスを生成できない**（図 5）
- これは訓練セットの TC が従う重要な物理的制約

#### 4. 一般的な指標はグレイスワンの劣悪な性能を隠蔽

**発見**:

- FourCastNet-Full、FourCastNet-Rand、FourCastNet-noTC は、以下の指標で類似の予報スキルを示す：
  - ACC（異常相関係数）: AI モデルの評価に一般的に使用される全球平均統計
  - 分布内 TC（ここではカテゴリー 1-2）の予報スキル
- 図 S2-S3 参照

### 4.2 含意

上記の発見(1)-(4)は、極端現象の理解と予測に AI の天気予報モデルと気候エミュレーターを使用する取り組みに重大な含意を持つ。

#### (a) AI の天気予報モデルは前例のない気象現象に対して信頼性の低い早期警告を生成

**問題**:

- AI の天気予報モデルは、**全球的に前例のない**気象極端現象を正確に予測できない
- しかし、訓練セットの世界の他の地域にダイナミカルに類似した同等またはより大きな振幅の現象が存在する場合、AI モデルはある程度の予報スキルを示す可能性がある

**社会的リスク**:

- AI の天気予報モデルが極端気象現象を誤予報する可能性、特にここで一貫して見られる「偽陰性」を生成する場合、深刻な社会的リスクを生じる
- この懸念は特に深刻：
  - 気候変動がいくつかのタイプのグレイスワン（TC を含む）の可能性を高めている
  - AI 天気予報の急速な進歩が、従来の物理ベースモデルよりもそのようなモデルへの運用上の依存を招いている

**必要な対応**:

1. グレイスワンの予報に対する AI の天気予報モデルの限界を完全に特徴づける必要がある（(c)参照）
2. AI モデルが失敗している早期警告信号を特定することが価値がある

#### (b) AI 気候エミュレーターはグレイスワン現象の統計を誤って特徴づける

**問題**:

- 現在の AI 気候エミュレーターは、グレイスワン現象統計（例：再現期間）のサンプリング誤差を確実に削減できない可能性がある
- 内部変動性から生じるこのタイプのエラーを削減できないことは、気候エミュレーターを開発する主要な動機を損なう

**理由**:

- エミュレーターは訓練セットの弱い現象からグレイスワン現象について学習する必要がある
- 本研究は、これができないことを発見

**結果**:

- これらのエミュレーターが生成する長い大規模アンサンブルの合成データには、訓練セットに存在するものより強く稀な極端現象に関する信頼できる情報が含まれない
- 推定統計の精度は依然として訓練セットの長さによって制限される

#### (c) AI モデルのグレイスワンと前例のない稀な現象の適切な定義/指標が必要

**理由**:

- FourCastNet が地域間でダイナミカルに類似した現象の学習を一般化する部分的能力
- 気候分析と AI アルゴリズムの一般的な正規化スキームの違い

**気候科学での定義**:

- 前例のない現象は、しばしば 1 つの変数（例：地表近くの気温や降雨量）の異常を**局所的な**統計と比較することに基づいて定義される

**AI の天気予報モデルの正規化**:

- 各入力変数をその全球平均と標準偏差に対して正規化することが多い

**含意**:

- 他の地域でのダイナミカルに類似した現象の存在を考慮すること
- 局所的ではなく完全な異常フィールドを調べること
- 単一変数入力ではなく完全な入力を分析すること
- これらは AI モデルにとって現象が真に分布外であるかを決定する上で重要

### 4.3 潜在的な対策

データ不均衡に対処するための一般的な AI 戦略と、AI の天気/気候モデルがグレイスワンの予報/エミュレートに役立つ可能性のある対策：

#### 1. 重み付き損失関数

**説明**:

- 稀な現象の学習を改善できる（気候科学への応用については文献[30, 46, 47]参照）

**制限**:

- 訓練セットに存在する稀な現象の学習を改善
- しかし、グレイスワンには役立たない

#### 2. アップサンプリング

**説明**:

- 強い合成 TC を生成し、noTC 訓練セットに含める

**アプローチ**:

- **生成 AI モデル**（例：拡散モデル）が役立つ可能性[21]

  - しかし、そのようなモデルは、自身の訓練セットにあったものを超えて物理的に現実的な極端現象を生成することがまだ示されていない
  - 実際、自身の出力で訓練された生成モデルの反復訓練はモデル崩壊につながることが示されている[48]

- **物理ベースまたは理論モデル**:
  - より有望なアプローチ
  - 強い合成 TC を生成するために使用[49]
  - そのような TC は物理的制約を満たす
  - より現実的な全球循環のスナップショットに適切に含める方法は、非物理的予測を引き起こさずに調査する必要がある

#### 3. 物理的制約の組み込み

**一般的な主張**:

- 保存則や対称性などの物理的制約の組み込みは、AI モデルにおける極端現象の表現を改善する方法としてしばしば言及される[27, 50, 51]

**現状**:

- そのようなアプローチは、おもちゃモデルと理想化されたシステムで有望性を示している
- 最先端モデルと複雑なデータへの適用可能性は実証されていない
- そのような制約がグレイスワンに役立つかどうかは未解決

**本研究の発見**:

- 勾配風バランスは、FourCastNet-noTC の予測において FourCastNet-Full よりも顕著に悪くない（図 5）
- これは、このバランスが何らかの形で強制されたとしても（これは簡単な作業ではない）、グレイスワンの表現が改善しない可能性を示唆

#### 4. 稀事象サンプリングと AI モデルの統合

**新興の対策**:

- 稀事象のための数学的手法と AI の天気/気候モデルの革新を統合

**稀事象サンプリングアルゴリズムの既存の成功**:
従来の物理ベースの地球物理モデルへの適用は、以下を生成することで既に有望性を示している：

- 稀な極端現象とグレイスワンさえも
- それらの統計（例：再現期間）の推定[24, 52-56]

**アプローチ**:

1. 物理ベースモデル（例：GCM）の再サンプリング
2. 関心のある稀な現象に向かって進行しているシミュレーションの迅速な最良推測によってガイド
3. AI の天気予報モデルによる安価なアンサンブル予報、または特定の稀な現象用に設計された AI モデル[57-59]を使用して迅速な最良推測を提供
4. 稀事象シミュレーションを使用して物理ベースモデル（例：数値天気/気候モデル）によって生成された、より強く稀な極端気象現象を、AI の天気/気候モデルの訓練セットに追加

#### 5. 厳密なテストの必要性

新しい AI モデルのグレイスワンの予測/エミュレートの忠実度を定量化するための厳密なテストが必要：

**本論文のアプローチ**:

- **利点**:
  - 明確
  - 予測された現象の物理的整合性を調べる簡単な方法を提供
- **欠点**:
  - 計算的に要求が大きい
  - AI モデルをランダムな重みから複数回訓練する必要がある

**代替アプローチ**:

- エミュレーターを使用して訓練セットよりもはるかに長い合成データセットを生成
- 適切な ground truth と極端現象統計を比較

**課題**:

- この アプローチでは、稀な現象の物理的整合性を要約統計（再現期間など）に加えて完全に調べる必要がある
- ground truth が必要
  - 例：少なくとも数百年の長いデータセット
  - ERA5 では利用不可能
  - 物理ベースの気候モデルで生成可能

### 4.4 今後の方向性

本研究は、以下の重要性を実証している：

1. **AI の天気/気候モデルの分布外グレイスワン現象に対する挙動のテストと改善**

   - ACC などの指標を用いた典型的な全球天気のテストに加えて
   - 訓練セットの分布と類似した極端気象現象のテストに加えて

2. **分布外の外挿の非自明性**

   - 極端気象現象に対する分布外の外挿は自明ではない
   - 今後、これを主張する人は証明の責任がある

3. **慎重に設計された指標と信頼できる ground truth の使用**

   - 弱いベースラインと報告バイアスは過度の楽観主義と誤解を招く結果につながる可能性がある[60]

4. **重要な道筋**
   - 極端気象現象の過大な社会的影響を考えると、これは強力な新しい AI の天気と気候モデルを改善し完全に活用するための重要な道筋を示している

## 5. 方法とデータの詳細

### 5.1 ERA5 データとその TC

**データソース**:

- すべての訓練とテストデータは 0.25 度の ECMWF の ERA5 再解析[61]から導出
- Copernicus Climate Data Store（CDS）を通じて入手可能
- https://cds.climate.copernicus.eu/

**期間**:

- 訓練: 1979-2015 年（[1]と同様）
- テスト: 2018-2023 年

**テストケース構成**:
各カテゴリー 5 TC テストケースは以下で構成される：

1. **コントロールメンバー**: ERA5 から直接の初期条件（IC）
2. **50 の摂動メンバー**: 摂動 IC を持つ

**摂動の取得**:

- ECMWF のアンサンブル・データ同化（EDA）から取得
- THORPEX Interactive Grand Global Ensemble（TIGGE）Data Retrieval を通じてアクセス可能
- https://apps.ecmwf.int/datasets/data/tigge/

**解像度調整**:

1. EDA データは最初 0.5 度解像度で提供
2. 0.25 度に再グリッド化
3. EDA アンサンブルの摂動フィールドを EDA メンバーとその平均の差として導出
4. これらのフィールドを 0.1 倍にリスケール
5. ERA5 フィールドに追加して、テスト（推論）用の 50 の IC メンバーを生成

### 5.2 TC 識別

**方法**:

- ERA5 データセット内で TC を識別するために閉じた mslp 等高線を追跡
- 最小気圧を強度の基準として使用

**TC 中心の定義**:

- 一般: 最小 mslp 位置
- 勾配風分析用: 最低 500 hPa ジオポテンシャル高度の位置（TC 構造の鉛直傾斜の可能性を考慮）

### 5.3 FourCastNet の詳細

**基本情報**:
FourCastNet[1]は最近開発された全球データ駆動型ディープラーニングベースの天気予報モデル

**予測方程式**:

```
x(t+Δt) = M(x(t), θ)
```

- x(t): ERA5 からの 33 個の大気変数からなる 3D 大気状態
- θ: モデルの訓練可能なパラメータ
- 自己回帰的に x(t+Δt)を x(t)から予測

**アーキテクチャ**:

- 適応フーリエニューラルオペレーター（AFNO）フレームワーク[62, 63]
- ビジョントランスフォーマーのアテンション機構を効率的にパラメータ化

**実装**:

- FourCastNet の公式コード使用
- [1]の Pathaket al.と全く同じ状態変数、アーキテクチャ、ハイパーパラメータ

**訓練手順の違い**:

- 訓練中に入力 x(t)にゼロ平均ガウスノイズ（分散 0.3）を追加
- これは推論時のすべての生成アンサンブル予報の安定性に不可欠

**訓練の詳細**:
各訓練セット（Full、noTC など）について：

1. 訓練可能なパラメータの異なるランダム初期化から開始する 5 つのモデルを訓練
2. 各モデルは：
   - まず 80 エポック訓練（コサイン学習率スケジュール、開始学習率 ℓ₁=5×10⁻⁴）
   - 次に 50 エポック追加ファインチューニング（コサイン学習率スケジュール、低い学習率 ℓ₂=10⁻⁴）
3. 1 つのモデルの完全訓練: 4 つの A100 GPU で約 7 日間

**公式コード**: https://github.com/NVlabs/FourCastNet

### 5.4 5 つの訓練セットの準備

**ヒストグラム分析**（図 1）:
訓練データの各サンプルについて、熱帯域（30°S-30°N）の mslp の最小値のヒストグラム

**重要な閾値**:

- 5 パーセンタイル: 約 970.0 hPa
- 25 パーセンタイル: 989.0 hPa

**noTC 訓練セットの作成**:

1. FourCastNet のファインチューニングステップには 2 つの将来タイムステップが必要
2. したがって、x(t)（熱帯域で mslp が 25 パーセンタイル未満のサンプル）に加えて、2 つの追加サンプル（x(t-2Δt)と x(t-Δt)）を削除する必要がある
3. 訓練データのちょうど 25%が除外されるように、臨界 mslp 閾値を 988.0 hPa に設定
4. 結果の訓練セット（noTC）を使用して FourCastNet-noTC を訓練

**閾値の意味**:

- 25 パーセンタイル閾値の mslp（<988.0 hPa）は、ERA5 データセット内の主要カテゴリー 3-5 TC の中心気圧にほぼ対応
- IBTrACs データに基づくと、約 24.8%の嵐が主要 TC（カテゴリー 3-5）になる
- ERA5 でのカテゴリー 3 TC の mslp の中央値は 987.0 hPa（使用した 988.0 hPa 閾値にかなり近い）- 図 S4 参照

**カテゴリー 5 の定義**（ERA5 内）:

- mslp が 970.0 hPa 未満で 12 時間以上持続する TC
- 注: 970.0 hPa は、ERA5 の IBTrAACs のカテゴリー 5 TC の平均 mslp 値よりも低い

**実世界のカテゴリー 5 TC**:

- 2018-2023 年に 20 以上のカテゴリー 5 TC が実世界に存在（Saffir-Simpson hurricane wind scale に基づく）
- 平均的には年に 5-7 個

**研究の枠組み**:

- 本研究では、ERA5 データセットの世界内で AI モデルを訓練・テスト
- カテゴリー 1-5 の用語は主にコミュニケーションを容易にするために使用

**Rand 訓練セット**:

- nOTC 訓練セットで除外されたすべてのサンプルを含む
- noTC 訓練セットのサイズに合わせるため、カテゴリー 3-5 の TC を含まないサンプルをランダムに削除
- したがって、Rand はすべての主要 TC を含み、noTC と同じ総訓練サンプル数と年間サイクル分布を持つ

**noWP（noNA）訓練セット**:

- 熱帯西太平洋（北大西洋）海盆で mslp 値が 988.0 hPa 未満のときにサンプルを除外
- 西太平洋には北大西洋海盆と比較してはるかに多くの強い TC が存在
- これは ERA5 データと観測の両方で真実
- 本研究では：
  - noTC で削除された TC の約 51%が西太平洋の低気圧による
  - 削除されたサンプルの約 9%のみが北大西洋の TC による

## 6. 結論

本研究は、最先端の AI 天気予報モデルである FourCastNet が、訓練データに存在しない極端な熱帯低気圧（グレイスワン）を予測する能力を、高度に制御された実験で初めて厳密にテストした。

**主要な発見**:

1. AI モデルは、訓練セットの弱い現象から学習して、より強い分布外の極端現象に外挿できない
2. ただし、ダイナミカルに類似した現象が訓練セットの他の地理的領域に存在する場合、ある程度の一般化が可能
3. 物理的制約（勾配風バランス）の欠如は、グレイスワンの予測失敗を説明しない
4. 標準的な評価指標は、グレイスワンに対する劣悪な性能を隠蔽する

これらの発見は、気候変動によって増加している稀で破壊的な極端現象を理解し予測するために、AI の天気/気候モデルを改善し完全に活用する上で重要な含意を持つ。
