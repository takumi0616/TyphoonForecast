# 再解析データを融合したConvLSTMによる台風経路予測

## 論文情報
- **著者**: Peng Lu, Mingyu Xu, Ao Sun, Zhenhua Wang, Zongsheng Zheng
- **所属**: Shanghai Ocean University, College of Information Technology
- **掲載誌**: Electronics
- **巻号**: Vol. 11, 3279
- **発行年**: 2022年10月12日
- **DOI**: 10.3390/electronics11203279

## 概要

### 要旨
台風の発生は人々の生命と財産に大きな脅威をもたらすため、災害防止と軽減のために台風経路を正確に予測することが重要である。近年、従来の機械学習手法を用いた研究では、時間的および空間的特徴を含めることに苦労している。さらに、衛星画像のみを使用して行われた研究では、台風の移動に対する物理的要因の影響を考慮していない。

そこで本論文では、ConvLSTM（Convolutional LSTM）モデルに畳み込み層を追加して、モデルの画像抽出能力を向上させることを提案する。台風中心の以前の位置は、その後の再解析画像上にマークされる。台風中心の後続座標は、各物理変数の予測座標をフィッティングすることによって求められる。

本論文の研究手法では、11の物理変数から、正準相関分析（CCA）とグレー関係分析（GRA）を用いて、台風の移動方向と距離と最も相関の高い物理変数グループを選択する必要があった。次に、再解析データを画像に変換し、連続的な再解析画像シーケンスをConvLSTMモデルに入力して予測を行う。提案手法を用いたERA5データセットの距離の平均絶対誤差は54.69 kmであり、モデルの有効性が証明された。

### キーワード
台風経路予測、ConvLSTM、再解析データ

## 1. はじめに

台風は地域住民に豊かな水産資源と淡水資源をもたらし、地球の熱バランスを維持することができる。しかし、台風は暴風雨や山洪水、土砂崩れ、高潮などの二次災害ももたらし、人々の日常生活、安全、財産を脅かす。近年、地球温暖化により台風がますます頻繁に発生し、世界中で大きな被害を引き起こしている。

例えば、2013年に台風ハイエン（Haiyan）がフィリピンを襲い、6,245人が死亡、28,626人が負傷、1,039人が行方不明となり、7億7,600万米ドルの経済的損害を引き起こした。したがって、台風経路を正確に予測することが必要であり、特に災害防止と軽減において重要である。これにより、人々は台風と二次災害に事前に備えることができ、台風関連の死傷者をある程度減らすことができる。

従来の予測手法は主に数値モデルと統計モデルを使用している。例えば、香港天文台はWRFモデルを使用して48時間先の台風中心座標を予測し、その平均誤差は107 kmであった。Shiwen Wangらは、高い水平解像度と複雑な物理パッケージを持つネストされた数値モデルを使用して台風軌跡を予測した。従来の手法から得られる精度は重要であるが、これらの手法は大量の複雑な数学的および物理的方程式モデルをデータを使用して計算する必要があり、高い計算性能と厳しいハードウェア要件を必要とし、時間の面で非効率的である。

従来の手法の高いハードウェア要件と低い計算効率の欠点を解決するために、現在、多くの研究者が機械学習手法を使用して台風経路を予測している。Thu Zar Hsanらは、サポートベクターマシン（SVM）と多項式回帰を組み合わせて台風経路を予測した。Jinkai Tanらは、台風経路を予測するために勾配ブースティング決定木（GBDT）非線形モデルの確立を提案した。

しかし、従来の機械学習手法では、データの時間的および空間的特徴を学習することが困難であり、したがって、他の研究者は再帰型ニューラルネットワーク（RNN）とLong Short-Term Memory（LSTM）予測モデルを選択した。さらに、Mario Rüttgersらは、研究のデータセットが台風中心の位置をマークした台風の衛星画像で構成されていることに言及した。さらに、生成的敵対ネットワーク（GAN）を使用して、4つの以前の時点での台風の衛星画像からなる時系列を入力することにより、台風の予測移動を示す衛星雲画像を生成した。

前述のモデルに加えて、研究者はConvLSTMを使用して台風経路を予測することも提案した。Seungkyun Hongらは、データセットで台風の衛星画像を使用し、畳み込みニューラルネットワーク（CNN）のジョイントインセプションユニットを使用して台風の中心を検出した。CNNと比較して、ConvLSTMはデータの時間的特徴を学習でき、RNNやLSTMなどのネットワークと比較して、画像内の特定の特徴を学習できる。さらに、GANと比較して、ConvLSTMの予測結果はより安定している。したがって、ConvLSTMは画像の時系列を予測するのに適している。

以前の研究と比較して、本研究は、台風経路の予測能力の観点から、ConvLSTMモデルの性能をさらに改善することを意図している。まず、相関分析を通じて支配的な物理的要因グループを選択し、次に、台風中心の以前の点をマークした再解析画像を取得し、ConvLSTMモデルに入力する。最後に、大きな地域でいくつかの台風経路を予測するのではなく、小さな地域で1つの台風経路のみを予測するために、選択された物理的要因の予測結果をフィッティングする。

さらに、経度と緯度の座標を使用して台風経路を予測する場合、衛星画像と同様に、台風経路に対する物理的要因の影響が無視される。これは、一部の物理的要因が台風の移動に大きな影響を与えるためである。したがって、近年、データを選択する際、研究者は台風経路に関連する物理変数から時間的および空間的特徴を学習するために、再解析データをモデルに入力し始めている。より頻繁に使用されている2つの再解析データベースは、ECMWFプロジェクト研究のシリーズによって生成されたERA-InterimとERA5である。

Mario Rüttgersらは、以前の研究を使用して、台風衛星画像と再解析画像を組み合わせて台風経路を予測した。Sophie Giffard-Roisinらは、CNNとニューラルネットワーク（NN）を使用して、風速と気圧の再解析画像、台風経路、最大風速などを訓練し、出力を融合して台風中心の将来の座標を取得した。さらに、畳み込み層はマトリックスデータよりも画像に適した特徴を抽出できるため、本研究では、再解析データをヒートマップに変換してから、予測のためにネットワークモデルに入力する。

研究者が台風の移動に関連する物理変数を見つけるとき、相関分析手法を使用して再解析データを選択する必要がある。JIE LIANらは、Granger因果検定、自己相関関数（ACF）、および部分自己相関関数（PACF）を使用して、相関する物理変数を選択した。Granger因果検定の適用条件では、時系列が定常である必要があるが、台風経路は突然曲がる可能性があり、経路シーケンスは定常性の条件を満たさない可能性がある。

Jian Pengらは、段階的重回帰分析（SMLR）とウェーブレットコヒーレンス分析を使用して、地表温度に影響を与える要因を求めた。しかし、台風経路と物理変数の間に線形関係がない可能性があるため、SMLRを使用して台風経路と物理変数の間の相関を分析することは合理的ではない。Ruipu Tanらは、エントロピー情報とGRAに基づく決定手法を使用して、台風によって引き起こされる災害を評価することを提案した。

Zhen Zhengらは、GRAを使用して画像をノイズ除去し、それらを適応的にバイナリ画像に変換し、形態学的計算モデルを使用して画像のエッジ部分を検出した。GRAの従属変数に関するデータは1次元である必要があるが、台風経路と物理変数の間の相関を分析する際の台風の移動を記述するデータは2次元である。したがって、GRAによって相関を直接分析することはできない。さらに、K. Fekaduは、CCAを使用してエチオピアの降雨に関する季節変化を分析および予測した。高次元データはCCAを使用して削減できる。

前任者の研究手法の上記の分析を組み合わせて、本論文は、画像からより多くの特徴を抽出するモデルの能力を向上させ、画像上に台風中心の以前の位置をマークするために、ConvLSTMのユニットに畳み込み層を追加することを提案する。これにより、画像処理手法の結果として、各物理変数に対応する台風中心の予測座標を取得でき、これらの物理変数をフィッティングして予測座標を取得する。

本論文は、台風の経度と緯度の座標と、データセットを構成する再解析データを使用して台風経路を予測する。台風経路の座標は、台風が移動している方向と移動距離を示すように変換される。CCAとGRAを組み合わせて相関を分析し、最も相関の高い物理変数グループを選別し、それらのデータを再解析画像に変換し、画像上に台風中心の以前の位置をマークする。物理変数グループを含むマークされた再解析画像シリーズは、予測を可能にするためにConvLSTMに入力される。

次に、画像上の台風中心の予測経路を示すマークされた点と、台風中心の真の以前の座標との相対位置に従って、予測された物理変数を含む対応する画像を使用して台風中心の座標が計算される。台風中心の最終予測経度と緯度座標は、各対応する物理変数の予測再解析画像に台風中心の座標をフィッティングすることによって計算される。

本論文の構成は以下の通りである。セクション2.1では、関連理論の研究結果を紹介する。データの取得とデータ処理を含むデータセットの確立については、セクション2.2で説明する。ConvLSTMモデルの構造と提案された改善については、セクション2.3で説明する。セクション3では、実験の結果を記述し、他の研究者の作業および結果と比較する。論文の議論と結論は、セクション4と5に記載されている。

## 2. 材料と方法

### 2.1 関連研究

#### 2.1.1 ConvLSTM

ConvLSTMモデルは、LSTMモデルの変種である。その入力と出力は多次元マトリックスの形式を取り、画像の空間的特徴を抽出して学習するのに便利である。ConvLSTMモデルのConvLSTMユニットは、まず畳み込み演算を使用して入力の空間的特徴を抽出する。次に、特徴抽出の結果を、入力データの時間的特徴を学習するために、ユニット内の各ゲートの畳み込み演算に入力する。演算の方法は式(1)に示されている。多くのConvLSTM層を積み重ねることで、ConvLSTMモデルの符号化-予測構造が形成される。

```
i_t = σ(W_xi * x_t + W_hi * h_t-1 + W_ci ∘ c_t-1 + b_i)
f_t = σ(W_xf * x_t + W_hf * h_t-1 + W_cf ∘ c_t-1 + b_f)
c_t = f_t ∘ c_t-1 + i_t ∘ tanh(W_xc * x_t + W_hc * h_t-1 + b_c)
o_t = σ(W_xo * x_t + W_ho * h_t-1 + W_co ∘ c_t + b_o)
h_t = o_t ∘ tanh(c_t)
```

#### 2.1.2 正準相関分析（CCA）

CCAは、線形相関分析を使用する統計手法であり、主に複数の変数間の線形関係を計算し、高次元データの次元削減の主な方法でもある。2つの多変数グループXとYがあると仮定すると、CCAアルゴリズムを使用してベクトルW_XとW_Yが見つかり、X^T W_XとY^T W_Yの間の相関係数を最大化し、多変数データの次元削減を達成する。X^T W_XとY^T W_Yの間の相関係数は、次の式を使用して計算される：

```
max_{W_X, W_Y} ρ = E[x^T y] / √(E[x^T x] * E[y^T y])
                 = E[W_X^T X Y^T W_Y] / √(E[W_X^T X X^T W_X] * E[W_Y^T Y Y^T W_Y])
```

ただし、正準相関分析（CCA）では、2つのデータグループXとYが対応関係を持つ必要がある。したがって、CCAによって分析されるデータはペアである必要がある。データセットがいくつかのクラスに分割されている場合、各クラスのデータは分離される。XとYのデータが1つのクラスにあると仮定すると、異なるクラスのW_XとW_Yの間の相関を計算することは困難である。したがって、CCAでクラス間の関係を考慮することは困難である。

#### 2.1.3 グレー関係分析（GRA）

グレー関係分析アルゴリズムは、灰色理論の重要な構成要素であり、系列の傾向を分析することによって、系列間の類似性と相違、および相関を達成できる。グレー関係分析アルゴリズムの成功した実装には、次の4つの主要なステップが含まれる：

1. 参照シーケンスと比較シーケンスを決定する。

2. データを正規化する。データセット内の各変数の意味の違いにより、データ範囲に違いがある。ただし、範囲の違いは、それらのプロパティが異なることを示すものではなく、異なる変数の異なる次元の結果である。したがって、相関分析の前に、無次元の状態とも呼ばれるデータの正規化が一般的に必要である。

3. 相関係数を計算する。式(3)に示されている：

```
ξ_i(k) = (min_{∀j∈i} min_{∀k} ||x*_0(k) - x*_j(k)|| + ρ max_{∀j∈i} max_{∀k} ||x*_0(k) - x*_j(k)||) / 
         (||x*_0(k) - x*_i(k)|| + ρ max_{∀j∈i} max_{∀k} ||x*_0(k) - x*_j(k)||)
```

ここで、ρは識別係数であり、一般的に(0, 1)の範囲である。x*_0(k)は参照シーケンスであり、x*_i(k)は比較シーケンスである。

4. 相関度を計算する。つまり、相関係数の平均値を計算することは、式(4)に示されている。相関度が大きいほど、参照シーケンスと比較シーケンスの間の相関が大きい：

```
r_i = (1/n) Σ_{k=1}^n ξ_i(k)
```

### 2.2 データセット

#### 2.2.1 台風中心の座標

本論文で使用される台風中心の経度と緯度の座標データは、日本国立情報学研究所のDigital Typhoonデータセットから取得した。データセットには、台風の衛星画像、台風経路の経度と緯度の座標、風速などが含まれている。台風の中心は台風の衛星画像の中心として取られる。実際、Lambert Aziumuthal正積図法を使用して、台風の中心を画像の中心として、地球の2600 km × 2600 kmの面積を描いた2次元平面の画像を投影する。本論文で使用されるデータセットには、2014年から2020年までの142の台風の経度と緯度の座標データが含まれ、時間ステップは6時間である。

#### 2.2.2 再解析データ

本論文で使用される再解析データは、ERA5データベースの気圧レベルに関する時間ごとのデータ、具体的には1979年から現在までのデータセットから取得した。ERA5は、同様に広く使用されているERA-Interimと比較して、より細かい空間的および時間的解像度とより時宜を得たデータ更新を提供する。本論文で使用されるデータセット内の再解析データには、ERA5データセットから2014年から2020年までの11の一般的な変数が含まれている。

これらの変数には、10 m u成分風、10 m v成分風、2 m露点温度、2 m温度、平均海面気圧、平均波向、平均波周期、海面温度、複合風波とうねりの有義波高、地表気圧、総降水量が含まれる。台風の経度と緯度の座標に対応して、再解析データの時間ステップは6時間であり、領域には西北太平洋が含まれ、データの空間解像度は0.125° × 0.125°である。

#### 2.2.3 データ処理

データセット内のデータの一部が欠落している可能性があるため、データを予備的にスクリーニングする際、欠落している台風データは削除された。さらに、短い台風シーケンスも、相関分析の精度に影響を与えるのを避けるために削除され、さらに、短い台風シーケンスは予測できないためである。

さらに、データセット内の台風中心の経度と緯度の座標の精度は小数点第1位まで正確である。したがって、再解析データの空間解像度の経度と緯度、および領域内の物理変数の値に対して補間が実行され、再解析データの精度も小数点第1位まで正確であることが保証される。これにより、再解析データが台風中心の経度と緯度の座標の精度と対応することが保証される。

各台風の中心を「台風領域」として、長さと幅が2600 kmの範囲内の経度と緯度を計算することにより、この領域内の経度、緯度、および物理変数値が再解析データから切り取られる。

データ処理後、本論文のデータセットは110の台風プロセスで構成され、トレーニングセットには2244の台風シーケンスが含まれ、テストセットには32の台風プロセスが含まれる。また、562の台風シーケンスが含まれ、各シーケンスには11の台風ポイントが含まれ、11番目の瞬間が「グランドトゥルース」である。

### 2.3 ConvLSTMの確立と予測

本論文で使用される方法は、まず台風中心の座標を移動角度と距離に変換することを含む。物理変数グループと移動角度および距離の間の相関は、CCAをGRAアルゴリズムと組み合わせて分析され、グループ内で最も相関の高い物理変数を選別する。次に、物理変数グループの再解析データから再解析画像が変換され、画像上に台風中心の以前の位置がマークされる。

各物理変数の再解析画像は、瞬間に示された後にカスケードされ、10の瞬間の再解析画像が時系列としてConvLSTMモデルに入力され、予測が可能になる。モデルは、後続の瞬間の各物理変数に対応する画像を予測できる。各物理変数に対応する台風中心を示す後続座標は、予測画像上のマークされた点、画像の中心、および以前の瞬間の台風中心の座標の真実の間の関連位置を組み合わせて計算され、6次多項式を使用してフィッティングして、台風中心の将来の座標を予測する結果を取得する。

#### 2.3.1 再解析データの相関分析

データセット内の11の再解析物理変数のすべてが台風経路に関連しているわけではない。したがって、再解析データを介した相関分析を使用して、物理変数の相関係数値が最も高いグループが選択される。台風中心の以前の座標を原点として使用し、以前の瞬間の台風中心の経度の間の角度、北半球の方向、および台風中心の以前と後続の座標の線（0° < 角度 < 360°）（以前の瞬間の2つの連続する瞬間の間の台風中心間の球面距離（d）を記録する）を、以前の瞬間の特定の物理変数の値、および次の瞬間の台風中心の位置に対応させ、これは相関再解析に便利である。

台風の移動角度（angle）と距離（d）を計算する方法は、それぞれ度とkmで次のとおりである：

Haversine式（Rは地球の半径であり、値は6371 km）：

```
d = 2 * sin^-1(√(sin((lat_2 - lat_1)/2 * π/180)^2 + cos(lat_1 * π/180) * cos(lat_2 * π/180) * sin((lon_2 - lon_1)/2 * π/180)^2)) * R
```

台風中心が台風中心の以前の位置の右上隅に移動する場合、移動角度は次のように計算される：

```
angle = cos^-1(|lat_dis| / d) * 180/π
```

台風中心が台風中心の以前の位置の右下隅に移動する場合、移動角度は次のように計算される：

```
angle = cos^-1(|lon_dis| / d) * 180/π + 90
```

台風中心が台風中心の以前の位置の左下隅に移動する場合、移動角度は次のように計算される：

```
angle = cos^-1(|lat_dis| / d) * 180/π + 180
```

台風中心が台風中心の以前の位置の左上隅に移動する場合、移動角度は次のように計算される：

```
angle = cos^-1(|lon_dis| / d) * 180/π + 270
```

ここで、lat_disは2つの連続する瞬間の台風中心点間の緯度方向の距離であり、lon_disは2つの連続する瞬間の台風中心点間の経度方向の距離である。lat_2は台風中心の後続緯度座標、lat_1は台風中心の以前の緯度座標、lon_2は台風中心の後続経度座標、lon_1は台風中心の以前の経度座標である：

```
lat_dis = |lat_2 - lat_1| * 111.11
lon_dis = cos(lat_1 * π/180) * 111.11 * |lon_2 - lon_1|
```

さらに、11の再解析物理変数を使用した合計2046の組み合わせがある。物理変数グループは相関分析の独立変数として取られ、台風の移動角度と距離は相関分析の従属変数として取られる。さらに、台風の移動方向と距離は2次元ベクトルデータを構成するが、従来の相関分析手法は一般的に1次元である。したがって、本論文では、CCAを使用して従属変数と独立変数の次元を1次元に削減する。

次に、従属変数と独立変数の間の相関度は、GRAを使用して計算され、2046の組み合わせを使用して、グループ内で最も相関の高い物理変数を見つける。セクション2.2.3で参照されている台風地域内の物理変数は、Basemapライブラリを使用してヒートマップに変換され、画像上に台風の中心を配置する。

本論文では、物理変数グループには次のものが含まれている：2 m露点温度、平均海面気圧、地表気圧、複合風波とうねりの有義波高、10 m u成分風。対応する熱図を図2に示す。ただし、物理変数グループと台風の移動角度と距離の間の相関を分析する方法を使用して達成された結果は、異なる年のデータに基づいて異なる可能性がある。

例えば、2014年から2021年までの台風経路データと再解析データとの相関を分析することから生じた物理変数グループには、2 m露点温度、平均海面気圧、平均波周期、地表気圧、海面温度、2 m温度、総降水量、10 m u成分風が含まれていた。

#### 2.3.2 ConvLSTMの確立と改善

物理変数ヒートマップを生成する際、台風中心の以前の位置は、図3に示すように、最終的な経度と緯度の座標予測を取得し、画像上の台風中心の以前の位置と台風中心の後続位置との相対位置を取得するために、25 px × 25 pxの黒いブロックで画像上にマークされた。これはまた、ConvLSTMモデルがマークされた点のより多くの特徴を学習できるため便利である。マークされた点の領域が大きい場合、モデルはマークされた点のより多くの特徴を学習でき、モデルの予測能力の精度を向上させることができるため、有用である。

本論文で提案された方法は、ConvLSTMを予測モデルとして使用した。ConvLSTMモデルの基本構造は、畳み込み演算とゲートユニットで構成されている。本研究では、できるだけ多くの画像特徴を抽出するために、各ConvLSTMユニットで2つの畳み込み演算が実行される。3つのチャネル（RGB）からなる5つの物理変数の熱マップは、64 px × 64 pxにリサイズされ、その後カスケードされて15チャネルの画像を形成する。台風中心の後続座標は、10の瞬間からの画像で構成される時系列を使用して予測される。これらはモデルの入力を構成する。図4は、ConvLSTMモデルの訓練プロセスを示している。

本論文は、画像特徴をより適切に抽出するために、各ConvLSTMユニットに畳み込み演算層を追加する。カーネルサイズは3 × 3に設定され、畳み込み結果は畳み込み演算後に正規化されて、ゲートユニットを計算する際に入力ゲート、忘却ゲート、出力ゲートの値が常に1にならないようにする。図5は、ConvLSTMユニット構造を示している。本論文のConvLSTMモデルは、再解析画像から時間的および空間的特徴を完全に抽出するために、上記のConvLSTMユニット構造に従って3つの層で構成されている。

さらに、MSE損失関数を使用して、ConvLSTMモデルの元のクロスエントロピー損失関数を置き換える。MSE損失関数は、予測値と実際の値の差の2乗の期待値を計算する。クロスエントロピー損失関数は、入力サンプルが特定のタイプに属する確率を計算する。本論文は時系列予測問題を研究しているため、MSE損失関数はクロスエントロピー損失関数よりも適している。

上記のConvLSTMモデルの設計と改善に従って、本研究で使用されるConvLSTMモデルのパラメータ設定を表1に示す。

**表1. モデルのパラメータ**

| パラメータ | 値 |
|-----------|-----|
| 入力次元 | (batch_size, 10, 15, 64, 64) |
| カーネルサイズ | (3 × 3) |
| ゲートユニットノード数 | 15 |
| 層数 | 3 |

#### 2.3.3 経路座標の予測

モデルによって得られた予測画像の輪郭が検出される。検出された輪郭点は組み合わされて輪郭の最小外接矩形をフィッティングし、矩形の中心点が取得されて、画像上のマークされた点の(x, y)座標を決定する。台風中心の以前の経度と緯度の座標に従って、画像内の予測点と台風の現在の中心点（つまり、画像の中心点）の相対位置は、台風の現在の中心点の経度と緯度の座標を使用して計算される。

計算方法は次のとおりである。ここで、lat_curは予測された台風中心の現在の緯度座標、lon_curは予測された台風中心の現在の経度座標、lat_preは台風中心の以前の緯度座標、lon_preは台風中心の以前の経度座標である：

```
lat_cur = lat_pre + (y - 32) × (23.4 ÷ 64)
lon_cur = lon_pre - (x - 32) × (2 × 1300) / (111 × cos(lat_cur × π/180) × 64)
```

マークされた点を直接検出できない予測画像に対してヒストグラム均等化が実行され、経度と緯度の座標を取得する。上記のプロセスが繰り返されて、マークされた点の認識率が向上する。さらに、訓練プロセスの終わりに、訓練セット内の各台風シーケンスの各物理変数画像に対応する経度と緯度の予測結果は、5つの要素を持つ6次多項式を使用して台風中心の現在の真の経度と緯度の座標とフィッティングされ、したがって、最終的な経度と緯度の座標が取得される。フィッティングモデルは、適応フィッティングが発生できるように、テストセット用に保存される。

## 3. 結果

### 3.1 実験環境

実験環境を表2に示す：

**表2. 実験環境**

| パラメータとデバイス名 | 値とバージョン |
|----------------------|--------------|
| GPU | NVIDIA GeForce RTX 3060 |
| epoch | 50 |
| batch_size | 10 |
| learning rate | 0.001 |

### 3.2 モデルの評価指標

台風中心の予測位置の精度は、距離、経度、緯度のMAE、および距離のRMSEを計算することによって評価される。絶対誤差はHaversine式を使用して計算され、次に平均絶対誤差がテストセットのシーケンス番号（n）に従って計算される。平方平均平方根誤差も絶対誤差に従って計算される。計算式は次のとおりである：

```
E = 2R * sin^-1(√(sin((lat_real - lat_pred)/2 × π/180)^2 + 
    cos(lat_pred × π/180) * cos(lat_real × π/180) * sin((lon_real - lon_pred)/2 × π/180)^2))

MAE = (1/n) Σ_{i=1}^n E_i

RMSE = √((1/n) Σ_{i=1}^n E_i^2)

MAE_LAT = (1/n) Σ_{i=1}^n |lat_real - lat_pred|

MAE_LON = (1/n) Σ_{i=1}^n |lon_real - lon_pred|
```

ここで、lat_realは台風中心の現在の真の緯度座標、lat_predは台風中心の現在の予測緯度座標、lon_realは台風中心の現在の真の経度座標、lon_predは台風中心の現在の予測経度座標である。

モデルによる予測された物理変数再解析画像の精度は、画像の平均類似度を使用して評価される。2つの画像の類似度は、コサイン類似度式を使用して計算される。コサイン値が1に近いほど、2つの画像の類似度が高い。そうでない場合、類似度は低い。コサイン類似度式と平均類似度は次のように計算される。ここで、aとbは2つの画像のベクトルであり、nは予測画像の総数である：

```
Similarity = cos(θ) = (a · b) / (||a|| × ||b||)

Similarity_aver = Similarity / n
```

### 3.3 実験結果

この実験中、物理変数の画像は、物理変数の再解析画像シーケンスの特徴を学習することによって予測された。これらは元の画像と比較してぼやけていたが、画像の類似度値は高く、平均類似度値は0.9927であった。図6は、2019年12月26日0時の台風PHANFONE（201929）の予測画像と元の画像の比較を示している。すべての画像は同じサイズである。

予測された台風中心の経度と緯度の座標と真の座標の間の球面距離の平均誤差は小さい。図7は、台風MITAG（201918）と台風VAMCO（202022）の予測経路と実際の経路の比較を示している。ここで、赤いシリーズは予測経路を示し、黄色のシリーズは実際の経路を示している。両方の台風について、予測経路と実際の経路の差は小さいことが明らかである。台風MITAGの予測誤差は50.03 kmであり、台風VAMCOでは49.15 kmである。

しかし、本論文の方法には、モデルが物理変数の変化に敏感であるという制限もある。例えば、台風HAGIBIS（201919）から取得された画像の時間範囲は、2019年10月5日18時から2019年10月14日18時までで、合計10日間である。図8は、2019年10月14日6時の再解析画像が2019年10月14日0時の再解析画像と大きく異なり、予測画像がより早い画像に似ていることを示している。これは、台風中心の現在の予測経度と緯度の座標の誤差が大きいことを意味する。

本論文は、その理由は、2つの連続する瞬間の画像間に大きな違いがある場合、訓練プロセス中にモデルがそのような特徴を学習することが困難であり、予測結果に関する誤差が大きくなることを仮定している。

さらに、1つの畳み込みConvLSTMユニット層のみを持つConvLSTMモデルの予測結果を比較するために、比較実験が実施された。他のすべての要因が等しい状態で、畳み込み層のみが変更された。1つの畳み込みConvLSTMユニット層のみを持つConvLSTMモデルの予測画像とグランドトゥルース画像の間の類似度値は0.9923であり、これは改善されたConvLSTMモデルの予測画像とグランドトゥルース画像の間の類似度値（0.9927）よりも小さい。

表3は、1つの畳み込みConvLSTMユニット層のみを持つConvLSTMモデルと改善されたConvLSTMモデルの間の比較結果を示している。比較結果は、畳み込みConvLSTMユニット層を追加することで、4つのパラメータ（MAE、RMSE、MAE_LAT、MAE_LON）すべての優位性を持つConvLSTMモデルの性能を向上させることができることを証明している。

**表3. 1つの畳み込みConvLSTMユニット層のみを持つConvLSTMモデルと改善されたConvLSTMモデルの間の結果の比較**

| モデル | MAE (km) | RMSE (km) | MAE_LAT | MAE_LON |
|--------|----------|-----------|---------|---------|
| 改善されたConvLSTM | 54.69 | 71.27 | 0.303 | 0.393 |
| 1つの畳み込みConvLSTMユニット層のみを持つConvLSTMモデル | 56.66 | 73.09 | 0.454 | 0.609 |

### 3.4 他の手法との比較

提案手法の予測誤差は、表4の他の手法と比較される。比較結果は、提案手法が機械学習モデルを使用する高精度の予測手法であることを示している。

**表4. 他の手法との結果の比較**

| 手法 | MAE (km) | RMSE (km) | MAE_LAT | MAE_LON |
|------|----------|-----------|---------|---------|
| 提案手法 | 54.69 | 71.27 | 0.303 | 0.393 |
| Sparse RNN | 72.11 | - | 0.549 | 0.299 |
| GAN | 69.1 | - | - | - |
| Deep-Hurricane-Tracker: ConvLSTM | - | 140.97 | - | - |
| SVM | 57.6 | - | - | - |
| NNA | 55 | - | - | - |
| TrajGRU | 66.6 | - | - | - |
| WCycleGAN + TCLNet | 61 | - | - | - |
| DeepTC: ConvLSTM | - | - | 1.8 | 2.12 |

## 4. 議論

実験結果は、台風の移動に関連する物理的要因の再解析画像とConvLSTMモデルを使用した予測が、物理的要因の比較的明確な予測再解析画像を達成でき、したがって正確な予測結果を提供できることを証明している。しかし、この提案手法によって生成された予測画像は、後続ではなく以前のグランドトゥルース結果により似ており、これは誤差を増加させる可能性がある。

したがって、将来の作業は、ネットワークがより多くの画像特徴を抽出でき、台風の移動の一般的な一貫した方向に従って予測して誤差を減らすことができるように、ネットワークの構造と入力の重みを調整することに焦点を当てるべきである。それにもかかわらず、台風経路を正確に予測することは将来困難であろう。

## 5. 結論

本論文は、ConvLSTMユニットの畳み込み層を追加して、より多くの再解析画像特徴を抽出し、台風中心の以前の位置をマークすることによって台風中心の後続位置を示す座標を達成することを提案する。次に、予測された台風中心の座標は、各物理変数に従って計算およびフィッティングされる。

本論文は、台風経路を予測するために、物理変数の再解析画像と、経度と緯度の座標で構成されるデータを使用する。台風の移動角度と移動距離を含む最も相関の高い物理変数グループは、CCAをGRAアルゴリズムと組み合わせて見つけられ、無関係な物理変数が予測結果に影響を与えて誤差を増加させることを避ける。

物理変数グループの再解析データは再解析画像に変換され、画像上に台風中心の以前の位置がマークされる。再解析画像の時間的および空間的特徴は、ConvLSTMモデルを使用して学習される。ネットワークの出力結果は経度と緯度の座標に変換され、最終的な予測結果はフィッティングを介して取得される。実験結果は、提案手法が台風経路を正確に予測できることを示している。

## 著者の貢献

データキュレーション：A.S.；方法論：M.X.；プロジェクト管理：P.L.；執筆-オリジナル草稿：M.X.；執筆-レビューと編集：Z.W.およびZ.Z.。すべての著者は原稿の公開版を読み、同意した。

## 資金提供

この研究は、Shanghai Science and Technology Innovation Plan Project（助成番号20dz1203800）とCapacity Development for Local College Project（助成番号19050502100）によって資金提供された。

## 利益相反

著者は利益相反を宣言しない。

## 主な発見と貢献

### 主な発見
1. **ConvLSTMの改善**: 畳み込み層を追加することで、画像からの特徴抽出能力が向上し、予測精度が改善された
2. **高精度な予測**: ERA5データセットを使用した場合、平均絶対誤差は54.69 kmを達成
3. **物理変数の選択**: CCAとGRAを組み合わせることで、台風経路に最も関連する物理変数グループを効果的に選択できた
4. **再解析データの活用**: 衛星画像のみに依存せず、ERA5再解析データを活用することで、物理的要因を考慮した予測が可能になった

### 技術的貢献
1. **ハイブリッドアプローチ**: 統計的相関分析（CCA + GRA）と深層学習（ConvLSTM）を組み合わせた新しいアプローチ
2. **マーキング手法**: 台風中心の以前の位置を画像上にマークすることで、モデルが軌跡パターンを学習しやすくした
3. **多変数フィッティング**: 複数の物理変数からの予測結果を6次多項式でフィッティングすることで、最終的な座標予測の精度を向上

### 制限事項
1. **急激な変化への感度**: 物理変数が急激に変化する場合、モデルの予測精度が低下する
2. **過去の類似性**: 予測画像が後続よりも以前の状態に似る傾向がある
3. **データ依存性**: 異なる年のデータで最適な物理変数グループが変わる可能性がある

### 今後の研究方向
1. ネットワーク構造と入力の重みの調整
2. 急激な変化に対するロバスト性の向上
3. より長期的な予測への拡張
4. リアルタイム予測システムへの応用
