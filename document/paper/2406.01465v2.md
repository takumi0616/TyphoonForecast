# AIFS - ECMWF のデータ駆動型予報システム

## 著者

Simon Lang*, Mihai Alexe*, Matthew Chantry, Jesper Dramsch, Florian Pinault, Baudouin Raoult, Mariana C. A. Clare, Christian Lessig, Michael Maier-Gerber, Linus Magnusson, Zied Ben Bouallègue, Ana Prieto Nemesio, Peter D. Dueben, Andrew Brown, Florian Pappenberger, Florence Rabier

\*equal contribution

2024 年 5 月

## 概要

機械学習ベースの気象予報モデルは、正確な中期グローバル気象予報のための有望な手法として急速に台頭してきた。本論文では、欧州中期予報センター（ECMWF）によって開発されたデータ駆動型予報モデルである AIFS（Artificial Intelligence Forecasting System）を紹介する。AIFS は、グラフニューラルネットワーク（GNN）エンコーダーとデコーダー、およびスライディングウィンドウトランスフォーマープロセッサーに基づいており、ECMWF の ERA5 再解析データと ECMWF の運用数値気象予報（NWP）解析データで訓練されている。柔軟でモジュラーな設計を持ち、高解像度入力データでの訓練を可能にする複数レベルの並列化をサポートしている。AIFS の予報スキルは、NWP 解析データと直接観測データとの比較によって評価される。AIFS が上層大気変数、地表気象パラメータ、熱帯低気圧の進路について高度に熟練した予報を生成することを示す。AIFS は ECMWF の物理ベース NWP モデルと並行して 1 日 4 回実行され、予報データは ECMWF のオープンデータポリシーのもとで一般に公開されている。

## 1. 導入

正確な気象予報は社会にとって非常に重要であり、命を救い財産を保護するのに役立つ。近年、データ駆動型気象予報の分野で大きな進歩が見られる。探索的研究（Dueben and Bauer [2018]）に続き、Google、Huawei、NVIDIA などの研究者や技術企業は、多くの標準的な予報スコア（例：500 hPa 高度の二乗平均平方根誤差（RMSE）やアノマリー相関係数（ACC））において、主要な物理ベースのグローバル数値気象予報（NWP）モデルを上回るデータ駆動型気象予報モデルを構築してきた（例：Pathak et al. [2022], Keisler [2022], Lam et al. [2023], Chen et al. [2023], Bi et al. [2023], Nguyen et al. [2023]、検証結果については Ben Bouallègue et al. [2024]も参照）。同時に、予報は単一の GPU（Graphics Processing Unit）で数分以内に生成できるのに対し、物理ベースの NWP 予報には O(1000)の CPU が必要である。

データ駆動型モデルは、通常、欧州中期予報センター（ECMWF）が EU コペルニクス計画の一環として作成した再解析データセット ERA5（Hersbach et al. [2020]）のサブセットである履歴気象データで訓練される。リアルタイム予報を生成する際、現在は、ECMWF の 4D-Var（Rabier et al. [2000]）解析などの運用 NWP 初期条件に依存している。

ECMWF では、運用使用に対応した実験的データ駆動型予報システムを実装する決定が下された。これには、データ駆動型予報モデルの実装と、データセット生成、再現可能な訓練、運用推論、運用検証ツールの使用、製品生成、予報データの配信をカバーするエンドツーエンドのパイプラインが含まれた。

ECMWF のデータ駆動型予報モデルは AIFS（Artificial Intelligence Forecasting System）と呼ばれ、ECMWF の IFS（Integrated Forecasting System）へのオマージュである。AIFS は Python で実装され、PyTorch（Paszke et al. [2019]）と PyTorch Geometric（Fey and Lenssen [2019]）機械学習フレームワークを利用している。AIFS とともに、データ駆動型気象予報モデルの構成要素を提供することを目的としたツールボックスである Anemoi（ギリシャ語：「風」）フレームワークを開発している。

## 2. モデル

データ駆動型気象予報の文脈では、多様な深層学習アーキテクチャが採用されている。例えば、ビジョントランスフォーマー（Bi et al. [2023], Nguyen et al. [2023]）、ニューラルオペレーター（Pathak et al. [2022]）、グラフニューラルネットワーク（GNN、Keisler [2022], Lam et al. [2023]）などである。

AIFS の最初のバージョンは 2023 年 10 月に実験的運用モードで導入された（Lang et al. [2024]）。そのアーキテクチャは Keisler [2022]と Lam et al. [2023]に触発された。具体的には、Battaglia et al. [2016]に記載されているものと同様のエンコーダー・プロセッサー・デコーダー設計で構成されていた。エンコーダーは入力データグリッドから低解像度のプロセッサーグリッドに情報を集約する（図 1）。ここでは、各プロセッサーグリッドポイントの周りの一定の距離でカットオフ半径が使用される。デコーダーは潜在状態を入力データグリッドに投影し直す。デコーダーでは、入力データグリッドの各グリッドポイントは、最も近い 3 つのプロセッサーグリッドポイントに接続される。エンコーダーとデコーダーグラフのエッジ特徴は、エッジの長さと方向である。

Lam et al. [2023]と同様に、隠れプロセッサーグリッドはイコスフェア（正 20 面体球）に基づいていたが、より低い細分化レベルで、約 10,000 ノードと 80,000 エッジを持っていた。最初の AIFS バージョンの空間解像度は約 1° であった。

AIFS は 2024 年 2 月に約 0.25° の空間解像度にアップデートされた。エンコーダーとデコーダーで使用される GNN の種類は、Shi et al. [2021]に従ったアテンション/トランスフォーマーベースの変種に変更された。プロセッサーは、シフトウィンドウアテンション（Child et al. [2019], Beltagy et al. [2020], Dao [2023], Jiang et al. [2023]）と GELU 活性化関数（Hendrycks and Gimpel [2023]）を持つプレノルムトランスフォーマーに基づいている。したがって、明示的なエッジ情報を考慮せず、代わりに緯度バンドに沿ってアテンションが計算される（図 2 参照）。アテンションウィンドウは、完全なグリッド近傍が常に含まれるように選択される。プロセッサーグリッドは、40,320 グリッドポイント（約 1 度の空間解像度、これは Lam et al. [2023]のプロセッサー解像度とほぼ同じ）を持つ O96 八面体縮小ガウスグリッド（Wedi [2014]）に基づいている。AIFS には合計 16 のプロセッサー層がある。AIFS エンコーダー・デコーダーとプロセッサーブロックの概略図を図 3 に示す。

エンコーダーとデコーダーは、ネイティブ ERA5 空間グリッド解像度である N320 縮小ガウスグリッド（約 31 km）のデータで動作する。これは他のデータ駆動型気象モデルとは対照的である。縮小ガウスグリッドの利点の 1 つは、極に近いところでグリッド間隔が崩れることなく、地球全体でより均一な解像度を持つことである。その結果、エンコーダーとデコーダーのグリッドポイントとエッジの総数は、同様の解像度の通常の経度-緯度グリッドと比較して削減される。N320 縮小ガウスグリッドには 542,080 グリッドポイントがあるのに対し、0.25° 経度-緯度グリッドには 1,038,240 グリッドポイントがある。

入力データとエッジ特徴は、エンコーダーが入力データを ERA5 グリッドからプロセッサーグリッドにマッピングする前に、線形層を介して埋め込まれる。デコーダーは潜在空間を ERA5 入力グリッドにマッピングし直し、線形層が物理空間に投影し直す。

AIFS のもう 1 つの特徴は、入力グリッドとプロセッサーグリッドの各ノード、およびエンコーダーとデコーダーグラフのエッジに 8 つの学習可能なパラメータ（特徴）を追加することである。これにより、ネットワークは入力データに直接存在しない、またはノードやエッジ特徴として事前定義されていない追加の有用な特徴を学習できる。

GPU メモリフットプリントを削減するために、AIFS は順伝播モデルパスの間、活性化チェックポイントを広範囲に使用する。中間活性化を GPU メモリに保存する代わりに、逆伝播パス中に再計算される（Chen et al. [2016]）。

データ並列化に加えて、バッチが小さなサブバッチに分割され、これらが複数の GPU 間で同時に処理される場合、AIFS はシーケンス/テンソル並列化を実装している。ここでは、ニューラルネットワークの 1 つのインスタンスが複数の GPU に分割される（例：Kurth et al. [2022]）。これにより、高解像度データと複数の自己回帰ステップでの訓練が可能になる。2 つのモードのシーケンス並列化をサポートしている。GNN アテンションエンコーダー、デコーダー、トランスフォーマープロセッサーでは、アテンションヘッドが GPU 間でシャード化され、同期は効率的な all-to-all 通信プリミティブに依存している（Jacobs et al. [2023]が提案）。GNN エンコーダーとデコーダーの代替オプションとして、1 ホップグラフ近傍に従ってノードとエッジのシャード化も実装している。ここでは、グラフノードの賢明な再順序付けにより、デバイス間通信が最小化され、モデルの順伝播と逆伝播パスでそれぞれ単一のギャザーと削減操作のみが必要になる。

テンソル並列化の利点は 2 つある。計算負荷を GPU 間で分散してランタイムを削減でき、活性化が GPU 間で分割され、1 つのモデルインスタンスで利用可能な GPU メモリの量が増加する。利用可能な GPU メモリの量が増加することで、高解像度データでの訓練が可能になる。弱並列スケーリングテストにより、AIFS が少なくとも 2048 GPU まで準線形にスケールできることが実証されている。

ECMWF の目標は、確率的予報システムを開発することである。この目的のため、AIFS は、確率的スコア（例：Gneiting and Raftery [2007]）、例えばフェアスコア（Ferro [2013]）に向けたアンサンブルベースの訓練を可能にするデバイス間通信パターンも実装している。上記のシーケンス並列化を補完して、アンサンブルメンバーを複数の GPU に分散できる。これにより、訓練中により大きなアンサンブルの直接的な確率的スコアベースの最適化が可能になる。

## 3. 訓練

AIFS は 6 時間予報を生成するように訓練される。時刻 t-6h、t0 の大気状態の表現（ERA5 または ECMWF の運用解析）を入力として受け取り、時刻 t+6h の状態を予報する。AIFS の入力および出力フィールドの完全なリストを表 1 に示す。

### 表 1：AIFS の入力および出力変数

| フィールド                                                                                       | レベルタイプ                                                                | 入力/出力 |
| ------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------- | --------- |
| ジオポテンシャル、水平・垂直風成分、比湿、気温                                                   | 気圧レベル：50, 100, 150, 200, 250, 300, 400, 500, 600, 700, 850, 925, 1000 | 両方      |
| 地表気圧、平均海面気圧、表皮温度、2m 気温、2m 露点温度、10m 水平風成分、全カラム水               | 地表                                                                        | 両方      |
| 全降水量、対流性降水量                                                                           | 地表                                                                        | 出力      |
| 陸海マスク、地形、サブグリッド地形の標準偏差、サブスケール地形の傾斜、日射、緯度/経度、時刻/日付 | 地表                                                                        | 入力      |

より長いリードタイムの予報は、モデルを自身の予測から初期化する自己回帰的な方法で計算される。いわゆるロールアウトである。予報スコアを改善するために、訓練中にもロールアウトが使用される（Keisler [2022]）。ここで、AIFS は Lam et al. [2023]によって確立された訓練原則に従う。モデルに 6 時間先の予報を行うタスクが与えられるプレトレーニングフェーズに続いて、モデルが最大 72 時間の予報を生成する第 2 フェーズが続く。逆伝播中、勾配は予報チェーン全体を流れる。

プレトレーニングは、1979 年から 2020 年までの ERA5 で実行され、コサイン学習率（LR）スケジュールと合計 260,000 ステップで行われた。LR は最初の 1000 ステップで 0 から 10^-4 に増加し、その後 3×10^-7 の最小値にアニーリングされる。次に、1979 年から 2018 年までの ERA5 でのロールアウトが続き、今回は 6×10^-7 の LR で行われる。Lam et al. [2023]と同様に、ロールアウトを 1000 訓練ステップごとに最大 72 時間（12 自己回帰ステップ）まで増加させる。最後に、予報性能をさらに改善するために、運用リアルタイム IFS NWP 解析でモデルをファインチューニングする。これは、2019 年と 2020 年の IFS 運用解析データを使用した別のラウンドのロールアウト訓練によって行われる。ファインチューニングと推論中のモデルの初期化のために、IFS フィールドはネイティブ O1280 解像度（約 0.1°）から N320（約 0.25°）にダウン補間される。オプティマイザーとして、β 係数を 0.9 と 0.95 に設定した AdamW（Loshchilov and Hutter [2019]）を使用する。

入力および出力状態は、各レベルについて単位分散とゼロ平均に正規化される。地形などの一部の強制変数は、最小-最大正規化される。損失（目的）関数は、ターゲット大気状態と予測との間の面積加重平均二乗誤差（MSE）である。各出力変数に損失スケーリングが適用される。スケーリングは経験的に選択され、すべての予報変数が損失にほぼ等しい寄与を持つようになっているが、垂直速度は例外であり、その重みは減少した。損失重みも高度とともに線形に減少するため、上層大気のレベル（例：50 hPa）は総損失値にほとんど寄与しない。

訓練にはデータ並列化が使用され、バッチサイズは 16 である。1 つのモデルインスタンスは、1 つのノード内の 4 つの 40GB A100 GPU 間で分割される。訓練は混合精度を使用して行われ（Micikevicius et al. [2018]）、全プロセスは合計 64 GPU で約 1 週間かかる。10 日間の予報の実行には、予報データの入出力を含めて、単一の A100 GPU で約 2 分 30 秒かかる。

## 4. 結果

一般に、AIFS は、IFS および ERA5 予報と比較した北半球の ACC から分かるように、高度に熟練した予報を生成する（図 4）。これは、より長いリードタイムで 12 時間以上の予報優位性に相当する。時系列は、IFS の予報スキルが年々どのように進化してきたかを示している。ここでは、予報モデル、データ同化システム、観測使用の改善、および大気予測可能性の固有の変動性が、スキルの変化を駆動する。比較すると、ERA5 は凍結されたシステムであり、予報スキルの変化は主に大気の変動性に関連している。AIFS が IFS と比較して予報スキルのステップ変化を表していることは明らかである。

図 5 は、さまざまな変数にわたって AIFS と IFS の異なる予報スキル測定を比較するスコアカードを示している。検証のため、各システムは予報が初期化された運用 ECMWF 解析と比較される。さらに、予報はジオポテンシャル、気温、風速のラジオゾンデ観測、および 2m 気温、10m 風、24 時間全降水量の SYNOP 観測と比較される。ACC（ccaf）、RMSE（rmsef）、予報活動（予報アノマリーの標準偏差、sdaf）などのメトリクスの定義は、例えば Ben Bouallègue et al. [2024]で見つけることができる。

AIFS は対流圏全体、100 hPa までより良いスコアを示す。予報改善は約 10%のオーダーで実質的である。IFS は 50 hPa でより良いスコアを示しており、これは訓練でこれらの気圧レベルに与えられた重みが減少していることと一致している。一般に、AIFS は予報の 1 日目以降、IFS よりも大幅に低い予報誤差を示す。予報データが NWP 解析に対して検証される場合、予報スコアは 1 日目で AIFS の方が IFS よりも悪く、例えば北部および南部の中緯度での 850 hPa 風速である。しかし、この劣化はラジオゾンデ観測に対する検証では存在しない。IFS 解析と予報は、予報にしばらく延びる相関を示す可能性があり、これが 1 日目での AIFS 予報の見かけ上大きい誤差の説明になるかもしれない。

同様に、AIFS の 100 hPa スコアも、解析に対して検証された場合、ジオポテンシャル（z）と気温で IFS より悪いように見えるが、ラジオゾンデと比較した場合、必ずしもそうではない。例えば、北半球中緯度の 100 hPa 気温について、RMSE と ACC は解析ベースの検証では AIFS が IFS と比較して劣化しているが、AIFS と IFS がラジオゾンデ観測に対して検証された場合、改善されているように見える。

上層大気スコアと一致して、AIFS の地表予報は、解析と観測に対して検証された場合、例えば図 6 に示されている 2m 気温と 10m 風のように、IFS よりも一貫してより良いスコアを示す。参考として、約 1° の空間解像度を持つ初期 AIFS バージョンも示す。初期の低解像度 AIFS バージョンは、上層大気スコアの点では実際には現在の AIFS に非常に近かったが（図示せず）、観測に対する地表スコアを比較すると大きな違いが明らかになる。地表フィールドについては、空間解像度が非常に重要である。

全降水量の結果はより混在している。中緯度では、AIFS は短い予報範囲で SEEPS（Rodwell et al. [2010]）の点で IFS よりも熟練度が低い。より長い予報範囲では、AIFS は IFS よりも熟練している。熱帯では、全降水量予報スキルは一般に IFS と比較して改善されている。

スコアカードはまた、全体的に AIFS の予報活動が IFS と比較してやや減少していることを示している。予報活動の減少は、リードタイムとともに予報フィールドの平滑化、または「ぼかし」を伴っており、これは Pathak et al. [2022]、Keisler [2022]、Lam et al. [2023]などによって記述されている動作であり、グローバルスペクトルにも見られる（図示せず）。それにもかかわらず、短期予報にはまだかなり多くの小スケール構造が含まれているが、これらは長期予報では洗い流される（図 7）。

しかし、予報活動は、IFS-ENS（ECMWF の NWP アンサンブル予報、Molteni et al. [1996]、最新構成については Lang et al. [2021]、Lang et al. [2023]を参照）のアンサンブル平均（図 8 の青、赤、灰色の曲線を比較）ほど強く減少していない。これはリードタイムとともに予測不可能な特徴をフィルタリングする。

参考として、GraphCast 予報（Lam et al. [2023]）の活動も含めており、これは AIFS と非常に似ている。ここに示されている GraphCast バージョンは、Lam et al. [2023]によって運用 IFS 解析から初期化されるようにファインチューニングされ、ECMWF で毎日実行されている。予報性能を見ると、AIFS と GraphCast の違いが AIFS と IFS の違いよりもはるかに小さいことも明らかである。これは、両方が同じデータ（ERA5 および IFS 解析）で訓練され、それぞれの訓練体制（ロールアウト訓練など）の類似性と一致している。

興味深いことに、年の間にはより長い期間があり、一方のモデルが他方よりも優れているように見える期間、つまり数週間にわたって一方の曲線が他方の下にある期間がある。これは、内在的な変動性またはモデルアーキテクチャあるいは訓練とファインチューニング戦略の違いによって引き起こされる可能性がある。また、長い検証統計の必要性も強調している。

データ駆動型モデルについて文献で報告されている結果と一致して（例：Bi et al. [2023]、Lam et al. [2023]を参照）、AIFS は IFS よりも大幅に低い熱帯低気圧（TC）位置予報誤差を示す（図 9 参照）。これは大部分、TC 伝播速度の遅いバイアスの減少によって説明でき、これがトラック方向の TC 予報誤差の低下につながる。一方、TC 強度誤差は IFS のものよりも大きい。これは中心気圧と最大風速（図示せず）の両方の場合である。ここで、AIFS は平均して IFS よりも弱い TC を生成し、これがより大きな TC 強度バイアスとして現れる。これは、ERA5 および IFS 解析における TC の平均的に低すぎる強度、および予報中に予報フィールドを平滑化する AIFS の傾向によって説明できるかもしれない。また、平均して、AIFS は IFS よりも少ない TC を生成する兆候もある（図示せず）。

## 5. 議論と結論

AIFS は、上層大気変数と地表変数の両方について、高度に競争力のある予報性能を実証している。これらの結果は、NWP 解析およびラジオゾンデと SYNOP 観測に対して検証された場合に成り立つ。さらに、AIFS は例えば正確な熱帯低気圧進路予報を生成する。

現在の AIFS の実装は、加重 MSE 損失で訓練された他のデータ駆動型気象予報モデルのいくつかと特定の制限を共有しており、より長いリードタイムでの予報フィールドのぼかしなどがある。ぼかしは、MSE 訓練目的にまで遡ることができ、ここでモデルは予報における誤配置された構造の二重ペナルティ（例：Hoffman et al. [1995]、Ebert et al. [2013]）を回避するために暗黙的な平滑化を学習する。平滑化は、訓練中に使用される最適化ウィンドウの長さに依存する。極端な場合、10 日目まで最適化されたモデルによって生成される予報は、活動と詳細が大幅に減少したアンサンブル平均に類似するだろう（Bouallègue et al. [2024]を参照）。予備的な結果は、確率的目的に向けた訓練が、Price et al. [2023]によって報告された結果と一致して、予報全体を通じて鮮明な予報フィールドを生成していることを示している。

さらなる制限には、運用 IFS 解析への比較的アドホックなファインチューニングアプローチが含まれる。異なるファインチューニング戦略のより詳細な探索が有益である可能性がある。

AIFS は現在、訓練損失で「完全な」正規化状態を使用している。これは、例えば Keisler [2022]や Lam et al. [2023]によって行われている正規化予報傾向を予測することとは対照的である。ここでの潜在的な欠点は、潜在空間変数を物理空間にマッピングする AIFS の最後の線形層の出力が適切に正規化されていない可能性があることである。これはおそらく将来の AIFS アップグレードで修正されるだろう。この修正により、現在、変数ごとに経験的に行われている損失スケーリングの改善戦略も促進される可能性がある。

現在、AIFS は高度での線形損失スケーリング（例：Lam et al. [2023]）のため、成層圏予報での予報スキルが低下している。つまり、成層圏の変数にはほとんど重点が置かれていない。高度での損失スケーリングを最適化することで、成層圏の予報スキルが改善されることが期待される。

さらなる改善の可能性がある分野は、熱帯低気圧などの高影響システムの現在低下している強度である。ここでは、高解像度再解析などの改善された入力データが潜在的に役立つ可能性がある。上記のように、リードタイムとともに平滑化することは、訓練損失を改善するか、確率的モデルを訓練することによって軽減される可能性がある。

データ駆動型予報モデルの強みと弱みは、Ben Bouallègue et al. [2024]と Charlton-Perez et al. [2024]で調査されており、理想化された文脈では Hakim and Masanam [2023]で調査されている。しかし、モデルが実際にどのように機能するか、物理ベースの NWP モデルとどのように比較されるかを評価するには、さらなる作業が必要である。

AIFS のモジュラーアーキテクチャは、高度に柔軟で、スケーラブルで、拡張可能である。現在進行中の研究作業は、CRPS ベースの訓練（例：Pacchiardi et al. [2024]、Kochkov et al. [2024]）または拡散ベースの生成モデル（Sohl-Dickstein et al. [2015]、Ho et al. [2020]、Karras et al. [2022]、Price et al. [2023]）を介して、AIFS を確率的アンサンブル予報に拡張することに焦点を当てている。単一のデータ駆動型予報に関連する比較的小さなコストのため、多数のメンバーから構成されるアンサンブル予報を実行することが可能になる。

他の重要な研究分野は、データ駆動型長期予報、例えば月次および季節予報、降水フィールドの表現の改善（Chantry et al. [2024]）、データ駆動型地域モデリング（Nipen et al. [2024]）である。さらなる探索分野は、SYNOP 観測や衛星観測などの観測による AIFS 訓練と初期化の強化であり、解析誤差を修正し、モデルが改善されたポイント予報を生成できるようにする。これらの開発により、完全に観測駆動型（McNally et al. [2024]）の予報を生成することも可能になる。

AIFS のソースコードとウェイトは、今年後半に Anemoi フレームワークとともにオープンソースライセンスの下でリリースする予定である。AIFS 予報は ECMWF で 1 日 4 回実行され、ECMWF のオープンデータポリシーの下で一般に公開されている。

## 謝辞

PRACE（Partnership for Advanced Computing in Europe）に、イタリアの CINECA の Leonardo へのアクセスを提供いただいたことに感謝する。

## 主要な技術的特徴のまとめ

### モデルアーキテクチャ

- **エンコーダー・プロセッサー・デコーダー設計**: GNN ベースのエンコーダーとデコーダー、トランスフォーマーベースのプロセッサー
- **空間解像度**: 約 0.25°（N320 縮小ガウスグリッド、542,080 グリッドポイント）
- **プロセッサーグリッド**: O96 八面体縮小ガウスグリッド（40,320 グリッドポイント）
- **プロセッサー層数**: 16 層
- **アテンション機構**: シフトウィンドウアテンションを持つプレノルムトランスフォーマー

### 訓練の詳細

- **訓練データ**: ERA5 再解析（1979-2020）および IFS 運用解析（2019-2020）
- **訓練方式**: プレトレーニング → ロールアウト訓練 → ファインチューニング
- **最適化**: AdamW（β=0.9, 0.95）
- **損失関数**: 面積加重平均二乗誤差（MSE）
- **バッチサイズ**: 16
- **訓練時間**: 約 1 週間（64 GPU）
- **予報時間**: 10 日予報で約 2 分 30 秒（単一 A100 GPU）

### 並列化戦略

- **データ並列化**: バッチを複数 GPU に分割
- **シーケンス/テンソル並列化**: モデルインスタンスを複数 GPU に分割
- **スケーラビリティ**: 最大 2048 GPU まで準線形スケーリング

### 予報性能

- **予報優位性**: IFS に対して長期予報で 12 時間以上の優位性
- **上層大気**: 対流圏全体で約 10%の改善
- **地表予報**: 2m 気温、10m 風速で一貫した改善
- **熱帯低気圧**: 進路予報で IFS より優れる、強度予報では IFS より劣る

### 制限事項

- 長期予報での予報フィールドのぼかし（平滑化）
- 成層圏予報スキルの低下
- 熱帯低気圧の強度予測の弱さ
- 短期予報（1 日目）での解析検証時の若干の劣化

### 今後の開発方向

- 確率的アンサンブル予報への拡張
- 降水フィールドの表現改善
- 地域モデリングへの適用
- 観測データの直接統合
- 長期予報（月次・季節予報）への拡張

### 運用とデータ公開

- **実行頻度**: 1 日 4 回
- **データ公開**: ECMWF オープンデータポリシーの下で公開
- **オープンソース化**: 2024 年後半予定（Anemoi フレームワークとともに）

## 結論

AIFS（Artificial Intelligence Forecasting System）は、ECMWF が開発したデータ駆動型気象予報システムであり、グラフニューラルネットワークとトランスフォーマーアーキテクチャを組み合わせた革新的なアプローチを採用している。ERA5 再解析データと IFS 運用解析データで訓練された AIFS は、多くの気象変数において従来の物理ベースの NWP モデルを上回る予報性能を示している。

特に、上層大気変数や地表気象パラメータ、熱帯低気圧の進路予報において高いスキルを発揮し、長期予報では 12 時間以上の予報優位性を持つ。また、単一 GPU で数分以内に予報を生成できる計算効率の高さも大きな利点である。

一方で、長期予報での予報フィールドの平滑化や、成層圏予報スキルの低下、熱帯低気圧の強度予測の弱さなど、いくつかの課題も存在する。これらの課題に対しては、確率的訓練手法の導入や損失関数の改善、より高解像度な訓練データの使用などによって、今後改善される可能性がある。

AIFS のモジュラーで柔軟なアーキテクチャは、確率的アンサンブル予報への拡張や、長期予報、地域モデリングなど、さまざまな方向への発展を可能にする。ECMWF は、AIFS のソースコードとウェイトをオープンソース化する予定であり、これによりデータ駆動型気象予報の研究と開発がさらに加速されることが期待される。

AIFS は、機械学習と数値気象予報の融合による新しい気象予報パラダイムの可能性を示す重要なマイルストーンとなっている。今後の研究開発により、予報精度のさらなる向上と、実用的な運用システムとしての成熟が期待される。
