# Vision Transformer を用いた台風強度予測

## 著者情報

- **Huanxin Chen** - South China University of Technology, Guangzhou, China
- **Pengshuai Yin** - Guangdong Laboratory of Artificial Intelligence and Digital Economy, Shenzhen, China
- **Huichou Huang** - City University of Hong Kong, Hong Kong, China
- **Qingyao Wu** - South China University of Technology, Guangzhou, China
- **Ruirui Liu** - Brunel University London, London, United Kingdom
- **Xiatian Zhu**（連絡著者）- CVSSP, University of Surrey, Guildford, United Kingdom

**掲載：** NeurIPS 2023 Workshop - Tackling Climate Change with Machine Learning

## 概要

時空間を越えて台風強度を正確に予測することは、タイムリーな災害警報の発令と緊急対応の促進にとって極めて重要です。これは、人命の損失や財産の損害を最小限に抑えるとともに、経済的・環境的影響を軽減する大きな可能性を持っています。シナリオ分析のための衛星画像の活用は効果的ですが、雲の間の複雑な関係と高度に動的な文脈のため、追加的な課題も導入されます。

この分野における既存の深層学習手法は、畳み込みニューラルネットワーク（CNN）に依存しており、レイヤーごとの受容野が制限されています。この制限は、推論中に長距離依存関係とグローバルな文脈知識を捉える能力を妨げます。

これに対応して、本研究では「Typhoon Intensity Transformer（Tint）」という新しいアプローチを導入します。Tint は、各レイヤーでグローバルな受容野を持つ自己注意メカニズムを活用します。Tint はシーケンス・ツー・シーケンスの特徴表現学習の観点を採用しています。まず、与えられた衛星画像をパッチのシーケンスに分割し、すべてのパッチペア間のローカルおよびグローバルな文脈関係を同時に抽出するために自己注意操作を再帰的に使用し、それによってパッチごとの特徴表現学習を強化します。

公開されている台風ベンチマークでの広範な実験により、最先端の深層学習手法および従来の気象学的手法の両方と比較して、Tint の有効性が検証されました。

**コード：** https://github.com/chen-huanxin/Tint

## 1. はじめに

### 1.1 背景と動機

近年、地球温暖化により台風の強度と拡大の両方が進んでいます。台風は、暖かい熱帯海洋から発生し、近隣の陸地に接近する際に徐々に力を蓄積する深刻または極端な気象システムです。上陸すると、その周辺の生命と財産に重大な脅威をもたらします。

**台風強度の重要性：**

- 異なる台風強度は、異なるレベルの経済的損失と環境破壊に対応
- 台風の強度は、中心付近の最大持続地表風速と密接に関連
- 災害管理における重要な要因

### 1.2 衛星画像の役割

台風衛星画像は、豊富でタイムリーなリアルタイムデータにより、台風強度予測において極めて重要な役割を果たします。これにより、台風の構造、雲のパターン、環境条件を動的に監視することができます。多くの研究が、これらのリモートセンシング画像から抽出された情報、特徴、パラメータを使用した予測回帰に焦点を当てています。

### 1.3 既存手法の課題

近年、回帰ベースの手法の限界を克服するために、研究者は衛星画像を使用した台風強度推定のために深層学習手法に頼っています。

**畳み込みニューラルネットワーク（CNN）の制限：**

- この分野で最も普及している手法の一つは CNN に大きく依存
- CNN は局所的な画像特徴と複雑な画像構造を捉える能力で知られる
- **しかし：** 局所情報への過度の集中は、予測精度を向上させるために不可欠なグローバルコンテキストを無視するため、モデルの全体的なパフォーマンスを悪化させる可能性

### 1.4 本研究の貢献

上記の重大な制限に対処するため、本研究では**Typhoon Intensity Transformer（Tint）**という新しい手法を提案します。

**Tint の主な特徴：**

1. **各レイヤーで広大なグローバルフィールドを持つ自己注意メカニズム**

   - 入力画像を固定サイズのパッチに分割
   - それらを 1 次元の特徴ベクトルシーケンスに変換
   - これらのパッチ間の接続を確立するために自己注意メカニズムを使用
   - 画像全体にわたる包括的なグローバル特徴と文脈情報を抽出

2. **複数の Transformer レイヤーによる特徴の洗練と統合**

   - これらの特徴を台風強度予測のための出力レイヤーに転送

3. **シーケンシャルな視点からのアプローチ**
   - 画像をテキストデータと同様にシーケンシャルな観点から扱う
   - CNN によって捉えられる局所的特徴を超えた広範なグローバル関係と文脈手がかりを抽出

## 2. 方法論

### 2.1 全体アーキテクチャ

Tint は Vision Transformers と同じ入力-出力構成を採用していますが、重要な違いとして、台風強度推定として連続整数を出力します。Tint の概要を図 1 に示します。

### 2.2 画像からシーケンスへ

本手法は、1 次元の特徴埋め込みシーケンス **Z ∈ R^(L×C)** を入力として受け取ります。

- **L:** 事前設定されたシーケンス長
- **C:** 隠れチャネルサイズ

**実装プロセス：**

1. **パッチ分割：** 与えられた入力画像をパッチのグリッドに分割
2. **埋め込みエンコーディング：** 埋め込みブロックを使用して各個別パッチを特徴埋め込みにエンコード
3. **位置埋め込み：** 各コンテンツ埋め込みの上に位置埋め込みをさらに追加

### 2.3 モデルアーキテクチャ

**Tiny-ViT アーキテクチャの採用理由：**

- 計算効率とモデル性能のバランスを取るため

**モデル構成：**

1. **4 段階の構成：**

   - 解像度が徐々に減少する 4 つの段階
   - パッチ埋め込みブロック：
     - 2 つの畳み込み層
     - カーネルサイズ：3
     - ストライド：2
     - パディングサイズ：1

2. **初期段階（第 1 段階）：**

   - 軽量で効率的な MBConv を使用
   - ダウンサンプリングブロックと併用
   - **理由：** 初期の畳み込み層が低レベル特徴の学習に効率的

3. **後続の 3 段階（第 2〜4 段階）：**

   - ウィンドウ注意メカニズムを使用する Transformer ブロックで構築
   - **目的：** 計算オーバーヘッドを削減
   - 注意バイアスを組み込む
   - 注意と MLP 成分の間に 3×3 深度の分離可能な畳み込みを適用
   - **効果：** 局所情報を捉えつつ、グローバルコンテキスト情報を学習する固有の能力を強調

4. **追加の設計要素：**
   - 第 1 段階の各ブロックで残差接続を使用
   - 注意および MLP ブロック内でも残差接続を使用
   - 活性化関数：GELU
   - 正規化：
     - 畳み込み層の正規化層に BatchNorm を適用
     - 線形層に LayerNorm を使用

### 2.4 自己注意メカニズム

埋め込みシーケンス **Z** を入力として、M 層の多頭自己注意（MSA）と Multilayer Perceptron（MLP）ブロックを持つ Transformer を使用して特徴表現を学習します。

**各レイヤー l での処理：**

1. **自己注意への入力：**

   - トリプレット（query, key, value）を入力 Z^(l-1) ∈ R^(L×C) から計算
   - Z^(l-1)W_q, Z^(l-1)W_k, Z^(l-1)W_v として計算
   - W_q/W_k/W_v ∈ R^(C×d) は学習可能な線形射影のパラメータ
   - d は（query, key, value）の次元

2. **自己注意（SA）の定式化：**

   ```
   SA(Z^(l-1)) = Z^(l-1) + softmax((Z^(l-1)W_q)(Z^(l-1)W_k)^T / √d)(Z^(l-1)W_v)
   ```

3. **多頭自己注意（MSA）：**

   - m 個の独立した SA 操作を含む
   - 連結された出力を射影：
     ```
     MSA(Z^(l-1)) = [SA_1(Z^(l-1)); SA_2(Z^(l-1)); ...; SA_m(Z^(l-1))]W_O
     ```
   - W_O ∈ R^(md×C)、d = C/m

4. **レイヤー出力：**
   - MSA の出力を MLP ブロックで変換し、残差スキップを使用：
     ```
     Z^l = MSA(Z^(l-1)) + MLP(MSA(Z^(l-1))) ∈ R^(L×C)
     ```
   - （簡潔にするため、MSA と MLP ブロックの前に適用されるレイヤー正規化は省略）

### 2.5 ヘッド設計

**最終出力の生成：**

1. **特徴集約：**

   - 最終レイヤーの特徴出力：Z^m ∈ R^(L×C)
   - 平均プーリング操作を実行：v = avg(Z^m)

2. **予測：**
   - 全結合層を使用して最終予測を導出：
     ```
     y = vw + b
     ```
   - w と b は訓練可能なパラメータ

## 3. 実験

### 3.1 実験設定

#### データセット

**Tropical Cyclone for Image-to-Intensity Regression (TCIR) データセット**を使用：

- 台風強度推定モデルを公正な評価設定で評価するための重要なオープンベンチマーク

**データ仕様：**

1. **チャンネル：**

   - 赤外線（IR）
   - 水蒸気（WV）
   - 受動マイクロ波（PMW）
   - 可視光（VIS）

2. **フレームサイズ：** 各フレームは 201×201 データポイント、対応する風速情報付き

3. **データ分割：**
   - **訓練セット：** 2003-2014 年
     - 40,348 フレーム、730 台風
   - **検証セット：** 2015-2016 年
     - 7,569 フレーム、131 台風
   - **テストセット：** 2017 年
     - 4,580 フレーム、94 台風

#### 性能メトリック

台風強度推定は回帰問題として定式化されるため、**二乗平均平方根誤差（RMSE）**を使用してモデルの性能を評価します。単位はノット（knots）。

#### 訓練戦略

**前処理：**

- 画像を 224×224 ピクセルにリサイズ
- [0, 20°]の範囲内でランダム回転
- 50%の確率でランダムに水平または垂直反転

**過学習への対処：**

- Tint モデルのバックボーンを ImageNet で事前訓練

**訓練設定：**

- 損失関数：平均二乗誤差（MSE）
- バッチサイズ：32
- 初期学習率：0.00001
- 学習率スケジュール：
  - 50 エポック目と 75 エポック目で 10 分の 1 に減衰
- 総エポック数：100

#### 競合手法

**従来の気象学的モデル：**

1. **ADT (Advanced Dvorak Technique)** - 線形回帰ベース
2. **AMSU (Advanced Microwave Sounding Unit)** - 近地球軌道衛星に依存、台風通過時のみ動作
3. **SATCON (SATellite CONsensus)** - ADT と AMSU のヒューリスティック組み合わせ、予測実践で広く使用
4. **KT (Kossin Technique)** - 既存データから台風/ハリケーン強度のグローバル記録を構築
5. **FASI (Feature Analogs in Satellite Imagery)** - k 近傍法アルゴリズムを使用
6. **Improved DAVT** - IR 輝度温度の勾配の統計分析を通じて予測
7. **TI index** - 画像エッジ処理技術を活用し、輝度温度勾配を計算

**最近の深層学習手法：**

1. **MLRM (Multiple Linear Regression Model)** - 複数の特徴を設計し、異なる特徴を使用する複数の回帰モデルを集約
2. **TDCNN (Transferring Deep CNN)** - シンプルな CNN を導入
3. **Deep CNN** - 正則化技術を持つ深層ニューラルネットワーク
4. **CNN-TC** - IR と PMW 入力の両方を取り込み、回転ブレンディングとシーケンススムージング技術を組み込んだマルチモダリティ深層ネットワーク
5. **GAN-CNN** - 高品質画像を生成するために GAN を使用し、PMW データへの依存を減らす
6. **ResNet32** - 様々なドメインで多数の成功した応用を持つ広く採用された CNN アーキテクチャ

### 3.2 評価結果

#### 検証セットでの結果（表 1a）

**従来の気象学的モデリング：**

- 驚くべきことに、単純な線形回帰がかなりの性能を示す
- より複雑な検索ベースの手法（例：KT、FASI）を上回る
- 輝度温度勾配ベースのアプローチ（例：Improved DAV-T）も上回る
- TI index は価値ある増分情報を提供するが、複数のモデルと気象専門知識を活用する複合アプローチにわずかに劣る

**深層学習：**

- ほとんどの深層学習手法が競争力のある性能を示し、従来の対応手法を上回ることさえある
- データ駆動手法の有望な可能性を強調
- **ResNet：** 最も広く使用される CNN アーキテクチャの一つとして、従来の線形回帰に匹敵する顕著な性能を示す
- 特定のタスク指向設計を持つ CNN モデル（正則化、マルチモダリティ活用など）は性能向上を示す
- **しかし：** これらの開発は制限された受容野によって課される制限を克服できない

**Tint の性能：**

- レイヤーごとのグローバル受容野を特徴とする Tint モデルが大幅に優れた性能
- モデルの仮定と構造設計を検証する支持的証拠

#### 検証セット結果の詳細（RMSE、ノット単位）

| モデル         | モダリティ | RMSE     |
| -------------- | ---------- | -------- |
| ADT            | IR         | 11.79    |
| AMSU           | IR         | 14.10    |
| SATCON         | IR+PMW     | 9.21     |
| KT             | IR+PMW     | 13.20    |
| FASI           | IR         | 12.70    |
| Improved DAV-T | IR         | 12.69    |
| TI index       | IR         | 9.34     |
| MLRM           | IR         | 12.01    |
| TDCNN          | IR         | 10.00    |
| Deep CNN       | IR         | 10.18    |
| CNN-TC         | IR         | 10.59    |
| GAN-CNN        | IR         | 10.45    |
| ResNet32       | IR         | 11.63    |
| **Tint**       | **IR**     | **9.63** |
| **Tint**       | **IR+PMW** | **9.54** |

#### テストセットでの結果（表 1b）

テストセットでの結果は検証セットと一貫しており、提案されたモデルの安定性と一般性を確認しています。

\*\*テストセット結果の詳細（RMSE、ノット単位）

| モデル   | モダリティ | RMSE     |
| -------- | ---------- | -------- |
| ADT      | IR         | 12.19    |
| SATCON   | IR+PMW     | 9.21     |
| CNN-TC   | IR+PMW     | 10.13    |
| GAN-CNN  | IR+WV      | 10.45    |
| ResNet32 | IR         | 10.42    |
| ResNet32 | IR+WV      | 10.39    |
| ResNet32 | IR+PMW     | 10.32    |
| **Tint** | **IR**     | **9.35** |
| **Tint** | **IR+WV**  | **9.33** |
| **Tint** | **IR+PMW** | **9.00** |

**主要な発見：**

1. **結果の一貫性：** テストセットでの発見は一貫しており、質的に変化なし
2. **モデルの安定性と一般性：** 提案されたモデルの安定性と一般性を確認
3. **マルチモダリティの効果：** より多くのセンサーデータを組み込むことで予測性能が向上する傾向
4. **最先端の達成：**
   - WV 情報を追加後、テストセットで最先端を達成
   - PMW 情報を追加することでさらに性能向上（RMSE 9.00 ノット）

### 3.3 定性的評価

**注意可視化（Grad-CAM）：**

補足資料の図 2 に、ResNet32 と Tint モデルの注意可視化を提供しています。可視化は以下を明確に示しています：

1. **Tint の優位性：**

   - より広い空間コンテキストを捉える
   - より包括的な特徴表現学習を可能にする
   - 予測精度の大幅な向上をもたらす

2. **ResNet32 との比較：**
   - ResNet32 は局所的な特徴に焦点を当てる傾向
   - Tint は画像全体にわたるグローバルな関係を捉える

## 4. 結論

### 4.1 主な貢献

「Typhoon Intensity Transformer（Tint）」モデルは、台風強度の予測精度を大幅に向上させ、実世界の災害管理にとって大きな価値があります。

### 4.2 技術的優位性

Tint の優れた性能は、自己注意メカニズムの革新的な使用に起因しています：

1. **レイヤーごとのグローバル受容野：**

   - 各レイヤーでグローバル受容野を特徴付けることに成功
   - センサー観測における長距離依存関係を捉える能力を大幅に向上

2. **適応性：**
   - 動的な高次元データを持つ多様なドメインに適応可能

### 4.3 実験結果の意義

ベンチマークデータセットで実施された実験結果は以下を実証しています：

1. **深層学習手法との比較：**

   - 最先端の深層学習手法を上回る性能

2. **気象学的手法との比較：**

   - 従来の気象学的手法よりも優れた性能

3. **災害管理への応用：**
   - 台風などの気象災害に対応する災害管理の革新における Tint の可能性を強調

### 4.4 今後の展望

Tint の成功は、以下の分野での応用の可能性を示唆しています：

1. **他の気象現象への適用：**

   - ハリケーン、サイクロンなど他の熱帯低気圧への適用

2. **マルチモダリティデータの統合：**

   - より多くのセンサーデータソースの統合による性能向上

3. **リアルタイム予測システム：**

   - 実運用環境でのリアルタイム予測システムの開発

4. **気候変動研究への貢献：**
   - 地球温暖化が台風強度に与える影響の理解向上

### 4.5 実用的インパクト

本研究の成果は、以下の実用的な利点をもたらします：

1. **早期警報システムの改善：**

   - より正確な強度予測によるタイムリーな警報発令

2. **災害対応の最適化：**

   - 効果的なリソース配分と避難計画

3. **経済的損失の軽減：**

   - より良い予測による財産損害の最小化

4. **人命保護：**
   - 正確な予測による人命損失の削減

## 参考文献

本論文では、台風研究、深層学習、Vision Transformer に関する 26 の参考文献が引用されています。主要な参考文献には以下が含まれます：

- 地球温暖化と台風強度に関する研究
- 台風による経済的損失と環境への影響
- 衛星画像を用いた台風強度推定技術
- 深層学習と CNN アーキテクチャ
- Vision Transformer と Transformer アーキテクチャ
- TCIR ベンチマークデータセット

完全な参考文献リストは原論文を参照してください。
