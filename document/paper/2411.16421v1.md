# Digital Typhoon データセットの機械学習：複数海盆への拡張と表現・タスクの新展開

## 論文情報

- **タイトル**: Machine Learning for the Digital Typhoon Dataset: Extensions to Multiple Basins and New Developments in Representations and Tasks
- **著者**: Asanobu Kitamoto, Erwan Dzik, Gaspar Faure
- **所属**: 国立情報学研究所、横浜国立大学台風科学技術研究センター、他
- **発表日**: 2024 年 11 月 25 日
- **arXiv ID**: 2411.16421v1

## 概要

本論文は、機械学習モデルの長期時空間データのベンチマークを目的とした、40 年以上にわたる最長の台風衛星画像データセットの新バージョン「Digital Typhoon Dataset V2」を発表している。

### Dataset V2 の主要な追加内容

- **Dataset V1**: 北半球データのみ
- **Dataset V2**: 北半球データに加えて南半球の熱帯低気圧データを追加

### 新たな研究の可能性

2 つの半球からのデータを持つことで、海盆と半球間の地域差に関する新しい研究課題に取り組むことができる。

### データセット公開

- http://agora.ex.nii.ac.jp/digital-typhoon/dataset/
- https://github.com/kitamoto-lab/digital-typhoon/

## 1. イントロダクション

### 1.1 背景

**熱帯低気圧の重要性**:

- 特定地域では台風やハリケーンとして知られる
- 大きな社会的影響により、重要な研究対象
- 従来: 大気シミュレーションモデルなどの数値的アプローチ
- 新興: 機械学習などのデータ駆動型アプローチが有望

### 1.2 Digital Typhoon Dataset の誕生

**Dataset V1 のリリース** (2023 年 11 月):

- 気象学と機械学習コミュニティ間のギャップを橋渡し
- 熱帯低気圧の標準データセットを提供

**データセットの特徴**:

- **最長の衛星台風画像データセット**
- **期間**: 1978 年から 2022 年まで 40 年以上
- **構成**:
  - 気象衛星シリーズ「ひまわり」からの台風画像
  - 気象庁のベストトラックデータ

### 1.3 Dataset V2 への進化

**定期更新の開始**:

- 前年のデータを追加する年次定期更新
- データ処理パイプラインの見直し
- ユーザーのニーズへの対応

**Dataset V2 の革新的な追加**:

- 南半球データの追加
- 新しい研究課題の可能性:
  - 一つの海盆で学習したモデルを別の地域や半球に転移できるか？
  - 半球と海盆間の比較による熱帯低気圧の地域特性の新しいデータ駆動型発見

## 2. Digital Typhoon Dataset V2

### 2.1 時間的・空間的次元の更新

#### 時間的次元の拡張（定期年次更新）

**更新プロセス**:

1. 気象庁から前台風シーズンのベストトラックデータがリリース
2. 台風シーズン: 1 月開始、12 月終了
3. ベストトラックデータ: 通常 2 月にリリース
4. 更新されたベストトラックデータに基づいて 2023 年台風シーズンのデータを追加

**データ増加**:

- 熱帯低気圧（TC）数: 1,099 → 1,116
- 画像数: 189,364 → 192,956

#### 空間的次元の拡張（南半球データ）

**新規追加**:

- オーストラリア気象局（BoM）のベストトラックデータに基づく南半球データ
- ひまわり衛星は一つのディスク画像で北半球と南半球の両方を観測
- 両半球に同じデータ処理パイプラインを適用可能

**データセットの命名**:

- **WP (Western Pacific)**: 北半球データセット
- **AU (Around Australia)**: 南半球データセット

**注意**: この定義は典型的な熱帯低気圧海盆の定義とは異なる

- IBTrACS [13]は南太平洋（SP）と南インド洋（SI）を分離
- AU データセットは、SP と 90E と 160E の間の赤道の南の SI の東部を結合

### 2.2 WP と AU データセットの特性

**表 1: WP と AU データセットの特性**

| 特性           | WP データセット       | AU データセット             |
| -------------- | --------------------- | --------------------------- |
| 時間カバレッジ | 1978-2023             | 1979-2024                   |
| 空間カバレッジ | 北半球の 100E ～ 180E | 南半球の 90E ～ 160E        |
| シーズン       | 1 月～ 12 月          | 7 月（前年）～ 6 月         |
| ベストトラック | 気象庁（JMA）         | オーストラリア気象局（BoM） |
| TC 数          | 1,116                 | 480                         |
| 画像数         | 192,956               | 70,087                      |

### 2.3 2 つの半球間の重要な違い

#### 1. 用語の違い

- **WP**: 熱帯低気圧は「台風（typhoon）」
- **AU**: 熱帯低気圧は「サイクロン（cyclone）」
- 一般用語として「熱帯低気圧（tropical cyclone）」を使用すべき
- 本論文では「台風」を両方を意味する用語として使用することがある

#### 2. TC シーズンの違い

- **WP**: 1 月～ 12 月
- **AU**: 7 月（前年）～ 6 月
- 南半球では年と TC シーズンが異なる
- したがって、12 ヶ月間隔を意味するには「年」ではなく「シーズン」を使用する方が正確

#### 3. 循環方向の違い

- 地球表面のコリオリ効果により循環方向が反対
- この違いは半球間の一部の機械学習タスクに大きな影響を与える可能性
- 典型的な解決策: 一方の半球の画像を水平反転し、両半球で循環方向を同じにする

#### 4. 強度推定方法の違い

- JMA と BoM は両方ともドボラック法を使用
- しかし、方法の詳細は多くの点で異なる
- 海盆と半球間の比較は機関間の違いを考慮すべき
- 強度スケール（階級）の定義も機関間で異なる可能性

### 2.4 BoM ベストトラックデータの変更

2 つのデータセット間で値の均一な定義を持つため、BoM のベストトラックデータを以下の点で変更：

#### 1. 風速の変換

- メートル毎秒（m/s）からノット（kt）に変換
- 変換式: `kt = m/s / 0.5144`

#### 2. 階級の割り当て

- JMA の最大風速の閾値を BoM ベストトラックの最大風速に適用
- BoM によって割り当てられたタイプは使用しない

### 2.5 データセット形式とソフトウェア

**形式の継続性**:

- Dataset V1 から V2 への形式変更なし
- Python ベースのソフトウェアライブラリ`pyphoon2`が Dataset V2 でも動作

**`pyphoon2`の機能**:

- データローダー
- 機械学習パイプラインを構築するためのコンポーネント

**ダウンロード**: https://github.com/kitamoto-lab/digital-typhoon/

### 2.6 データ処理パイプラインの更新

**地図投影法の変更**:

- **旧**: Lambert azimuthal equal-area projection（正距方位図法）
- **新**: Azimuthal equidistant projection（正距方位図法）

**変更の理由**:
気象学コミュニティの典型的な使用法への対応、例えば台風の目の直径の測定

**距離測定の要件**:

- ピクセル差のユークリッド距離を使用して台風中心と対象ピクセル間の距離を測定
- 理想的な地図投影は中心からピクセルまでの距離を保存すべき（等距離）
- 中心周辺の面積を保存する（等面積）のではない

**影響**:

- この変更により、データセット全体が更新された
- **Dataset V1 は Dataset V2 の一部として再利用できない**

**機械学習タスクへの影響**（予想）:

- 大きな影響はないと予想
- **理由 1**: データセットのスコープ（中心から 1250km のクロップエリア）内では、2 つの地図投影法に大きな違いはない
- **理由 2**: 機械学習モデルは訓練中にデータセットの小さな違いに適応できる
- 性能はほぼ同じと予想

### 2.7 WP と AU データセットの処理

**同じパイプライン**:

- WP と AU データセットは同じデータ処理パイプラインを使用
- 唯一の違い: ベストトラックデータのソース（WP: JMA、AU: BoM）

**衛星データ**:

- 同じため、時間的・空間的解像度も同じ

**注意点**:
南半球では、破損または欠損データの頻度が高い

- 理由: センサー問題により南半球の観測が少なかった
- 特に問題だった衛星: Himawari-3、Himawari-4、Himawari-5、GOES-9

### 2.8 ベストトラックの補間方法

**両データセットで同じ補間方法**:

#### 風速

- **パーシステンス法**を使用
- 最後に既知の風速値を次の真値まで各画像に保持

#### 中心気圧

- **線形補間**を使用
- 2 つの真値間の欠損データを埋める

**補間されたメタデータ**:

- 合計 152,034 画像（データセット全体の 78.8%）が補間されたメタデータを持つ
- 以下の機械学習タスクでは真値として扱われる

### 2.9 データ拡張に関する注意

**一般的な画像のデータ拡張**:

- 画像を反転させてデータセットのバリエーションを増やす
- 例: 反転させた犬は依然として犬
- 拡張が画像の意味論的意味に影響しないため可能

**台風画像でのデータ拡張の問題**:

- 循環方向は自然の物理法則によって決定される
- 台風画像の反転は**物理的に不可能な画像**を生成
- データセットに追加する価値がない

**気象学者の観点**:

- わずかな回転でさえ物理的に非現実的な画像を引き起こす可能性
- 大気は北（上）と南（下）の間の微妙なバランスを反映

**結論**:
Digital Typhoon データセットのデータ拡張は、画像の物理的意味を壊さないように設計されるべき

**注意**:

- セクション 5 では海盆間で循環方向を揃えるために意図的に画像反転を使用
- ここでの目的はデータ拡張ではなく**データ前処理**
- 画像反転はすべてのデータセットに適用される

### 2.10 データセットの入手可能性

**公式ページ**: http://agora.ex.nii.ac.jp/digital-typhoon/dataset/

**ライセンス**: Creative Commons Attribution 4.0 International (CC BY 4.0) License

**Dataset V1**:

- 廃止として保存
- 将来の更新で削除される可能性

**推奨されるデータ引用** [10]:

```
Digital Typhoon Dataset V2 (National Institute of Informatics)
doi:https://doi.org/10.20783/DIAS.664
```

**DOI（Digital Object Identifier）の注意**:

- バージョン管理なし
- 同じ DOI（10.20783/DIAS.664）が将来のリリースにも使用される

**利点**: 異なるバージョンのデータセットの使用状況を追跡可能

**注意点**: DOI のみではデータセットのバージョンを特定できない

- データ引用にデータセットバージョンを追加する必要がある
- 研究で使用された正確なデータセットを特定するため

## 3. SSL フレームワークを使用した表現学習

### 3.1 表現学習の背景

**自己教師あり学習（SSL）の進歩**:
ニューラルネットワークは、ラベル付きデータを使用せずに価値のある画像表現を学習できることを実証

### 3.2 MoCo v2 フレームワーク

**基盤**: MoCo v2 フレームワーク [2]を使用して特徴抽出器を訓練

**対照学習**:

- MoCo v2 は対照学習に基づく
- infoNCE 損失関数 [18]を使用
- 目的: 画像のポジティブペアを引き寄せ、ネガティブペアを遠ざけることで表現空間を構築

**ポジティブペアの作成**:

- 通常: 同じ画像の 2 つの異なるクロップに強い拡張を適用
- これらの拡張画像を特徴抽出器またはモメンタムエンコーダーで処理

**モメンタムエンコーダー**:

- 特徴抽出器と同じアーキテクチャを使用
- 重みは各訓練ステップで特徴抽出器のパラメータの移動平均として更新

**infoNCE 損失**:

- 同じ画像の 2 つの異なるエンコーディングをポジティブペアとして使用
- バッチの残りと過去のエンコードされたバッチのキューを組み合わせたものをネガティブペアとして使用

### 3.3 対照学習の重要な要素

対照学習フレームワークには、2 つの重要な要素を定義する必要がある:

#### 1. ポジティブ画像ペアの識別方法

**一般的な自己教師あり対照学習**:

- ポジティブペアは通常、同じ画像の 2 つのランダムなクロップとして定義
- バッチ内の他のすべての画像はネガティブペアを作成するのに十分異なると仮定

**台風画像の場合**:

- 台風画像と、より重要なことに台風画像のシーケンスを扱う
- 台風のライフサイクルの時間的側面をポジティブペアの選択パイプラインに含めることができる

**ポジティブペアの定義**:
同じシーケンスの 6 時間ウィンドウ内で撮影された任意の異なる画像のペア

#### 2. 適用するデータ拡張

**一般的な SSL**:
攻撃的なデータ拡張が SSL フレームワークの性能を向上させることが示されている [1]

**Digital Typhoon データセットへの適用**:
セクション 2.3 で説明した理由により、データ拡張は慎重に設計されるべき

**使用した拡張**:

1. ランダムソラリゼーション
2. ランダムガウシアンブラー
3. 288x288 中心クロップ内の 224x224 ランダムクロップ
   - 目が常に中心に落ちることを防ぐため

### 3.4 訓練の詳細

**訓練設定**:

- **訓練ステップ数**: 10,000
- **バッチサイズ**: 768
- **アーキテクチャ**: ResNet34
- **学習率スケジューラ**: コサイン学習率スケジューラ
- **開始学習率**: 0.001
- **プロジェクターヘッド**: 3 層 MLP プロジェクターヘッド（訓練中に追加）

**プロジェクターヘッドの扱い**:

- 後続の実験のために削除
- ResNet34 アーキテクチャのみを保持（出力次元 512）

**計算リソース**:

- 単一の Nvidia RTX A6000
- 訓練時間: 約 3 日間

### 3.5 予測のための LSTM モデル

#### 目的

MoCo v2 で構築された表現空間を評価する

#### 評価方法

画像エンコーダーによって抽出された特徴が予測タスクに有用な信号を提供できるかをテスト

#### 2 つの予測タスク

1. **強度予測**: 次の 24 時間の台風中心気圧（hPa）
2. **温帯暴風雨（ETS）移行予測**

### 3.6 LSTM モデルのアーキテクチャ

**共通アーキテクチャ**（両タスクで同じ）:

- 3 層 LSTM（隠れ次元 1024）
- その後に 2 層 MLP
- 予測の前

**入力**:

- 3 つの画像のシーケンス
- すべて凍結された画像エンコーダーを通して投影
- 3 つの画像は台風の最後に既知の 3 つの画像とみなされる
- 3 時間間隔で撮影（I*{t-6}, I*{t-3}, I_t）

**出力**:
t+24 での予測

**訓練**:

- **エポック数**: 500
- **バッチサイズ**: 128
- バッチ構築: 128 のシーケンスをランダムに選択し、各シーケンスから 1 サンプルをランダムに選択

**注意**:

- このタスクに LSTM モデルを使用することは必須ではない
- LSTM は既知の時系列モデリング能力のために選ばれた
- 台風画像の学習された表現空間の可能性を評価する目的で、他のモデルに置き換えることができる

![図1: 予測モデルの簡略化された概要]

### 3.7 データセット分割

#### 強度予測タスク

- **使用画像**: 階級 2-5（熱帯低気圧）の画像のみ
- **分割比**: 訓練/検証/テスト = 0.7/0.15/0.15
- **結果**: 652/139/139 シーケンス

#### ETS 移行予測タスク

- **使用画像**: 階級 6 暴風雨（ETS）への移行を含むシーケンスのみ
- **分割比**: 訓練/検証/テスト = 0.7/0.15/0.15
- **結果**: 378/79/78 シーケンス

### 3.8 結果

#### 3.8.1 台風強度予測タスク

**評価方法**:
学習された表現の強度予測の可能性を評価するため、異なる実験で同じモデルアーキテクチャを維持

**実験内容**:
LSTM モデルの 3 つの入力タイムステップそれぞれについて渡される信号を変更

**表 2: 異なる入力構成の比較**

| 予測時間                            | t+12  | t+18   | t+24   |
| ----------------------------------- | ----- | ------ | ------ |
| ベースライン（パーシステンス予測）  | 9.788 | 13.312 | 16.249 |
| ベースライン（TIFS）                | ±9.20 | ±10.80 | ±12.00 |
| Time+Position+Pressure              | 5.696 | 7.998  | 10.043 |
| Images only                         | 8.576 | 9.073  | 9.982  |
| Images + Pressure                   | 5.073 | 6.908  | 8.658  |
| Images + Time + Position + Pressure | 5.240 | 7.006  | 8.671  |

**評価指標**: 中心気圧の RMSE（hPa）

**ベースライン 1: パーシステンス予測**:

- 中心気圧の最後に既知の値を単純に繰り返す

**ベースライン 2: TIFS**:

- 値は[14]から取得
- SHIPS 法に基づく台風強度予測（TIFS）
- 2017 年と 2018 年の北西太平洋のすべての熱帯低気圧の予測性能
- 統計的、回帰ベースの予測方法
- 複数の台風パラメータを予測することを目的（我々の方法は中心気圧予測に特化）

**注意**:
TIFS の行は直接比較できない

- テストシーケンスが異なる（我々: 40 年間で 139、TIFS: 2 年間で 57）
- しかし、以前の方法と現在の方法と比較した我々の方法の可能性の良いアイデアを与えるため保持

#### 3.8.2 温帯暴風雨移行予測タスク

**タスクの説明**:
熱帯低気圧（階級 2-5）が温帯暴風雨または ETS（階級 6）に変換されるときに発生

**表 3: 異なる ETS 移行予測モデルの評価（66 テストシーケンス）**

| モデル                   | RMSE  | Accuracy | F1    |
| ------------------------ | ----- | -------- | ----- |
| Images only              | 0.177 | 0.942    | 0.904 |
| Images + Time + Position | 0.180 | 0.937    | 0.895 |
| Time + Position          | 0.261 | 0.901    | 0.862 |

**入力**: 画像表現および/またはメタデータ
**出力**: t+24 でのバイナリ予測（1: ETS に移行、0: 熱帯低気圧のまま）

**評価指標**:

1. **RMSE**: モデルの生出力とベストトラックデータからの専門家アノテーションを比較
2. **Balanced Accuracy**: 生出力を丸めてバイナリ出力を得た後
3. **F1 Score**: 生出力を丸めてバイナリ出力を得た後

### 3.9 議論

#### 強度予測タスク（表 2）

**主要な発見**:

1. **学習された表現の有効性**:

   - 画像のみを入力として使用するモデルは両方のベースラインより優れている
   - 学習された表現は中心気圧予測に有効

2. **画像のみ vs メタデータのみ**:

   - t+12 と t+18: メタデータのみのモデルが優れている
   - t+24: 画像のみのモデルが優れている
   - より長い予測時間で画像の利点が増加

3. **最良のモデル**:

   - 画像表現と対応する中心気圧の組み合わせ
   - モデルは提供された中心気圧をベースライン予測として使用
   - 画像表現によって提供される信号を使用して最終出力を調整すると解釈

4. **追加メタデータの効果**:

   - 位置（緯度・経度）と時間（月、日、時）を追加してもモデルの性能は向上しない

5. **予測時間の影響**:
   - 画像を使用することによる性能向上は、予測時間が増加するにつれて拡大するように見える
   - より長い予測時間でのさらなる実験とテストを実施すべき

**結論**:
MoCo を使用して学習された台風画像の表現には、この特定の予測タスクに意味のある情報が含まれている

#### ETS 移行予測タスク（表 3）

**タスクの特徴**:
Digital Typhoon データセットで評価するには非常に不均衡なタスク

**観察**:

1. **時間と位置のみの使用**:

   - Balanced accuracy: 0.901
   - しかし、この高い精度値は実際の性能を代表していない
   - 定性的結果: このモデルは予測性能が非常に悪い
   - 理由: データの不均衡（データセット内の台風は、ETS に変わる前にライフサイクルの大部分を熱帯低気圧として過ごす）

2. **画像表現の追加**:

   - モデルの入力に画像表現を追加すると、予測性能が大幅に向上
   - 定性的結果でも改善が確認可能

3. **追加メタデータの効果**:
   - モデルの入力にさらにメタデータを追加しても予測性能は向上しない

### 3.10 今後の課題

**成果**:
2 つの異なる予測タスク（強度予測と ETS 移行予測）に台風画像の SSL 表現を使用する可能性を示した

**改善の余地**:
この研究は、新しいコンピュータビジョンアルゴリズムを気象学モデルに組み込むことによってできることの表面をかすめたに過ぎない

**MoCo v2 の有効性**:
台風画像について、MoCo v2 のような自己教師あり学習フレームワークは、台風画像から意味のある特徴を抽出するのに十分であることを示した

**今後のプロジェクト**:

1. 可視画像データの組み込み
2. 異なる画像エンコーダーアーキテクチャのテスト
3. 異なる時系列モデリングパイプラインの評価
4. 画像エンコーダーによって作成された潜在空間の分析
   - 潜在空間に投影された台風シーケンスのパターンを認識
   - 最終的に気象学者の台風とそのライフサイクルに関する知識を向上させる可能性

**コード公開**:

- LSTM の実験と画像エンコーダーの訓練のコード
- https://github.com/gafaua/typhoon-latent-forecast

## 4. 台風中心推定タスク

### 4.1 タスクの重要性

台風画像は他の挑戦的なタスクの完了も可能にする。その一つが**台風中心の推定**である。

**タスクの特徴**:

- 台風が弱く、目がはっきり見えない場合は特に挑戦的
- この場合、雲のパターンは特徴的な兆候を示さない
- ドメインの専門家でさえ台風中心の識別に失敗する

**目的**:
台風中心を自動的に推定する機械学習モデルの開発

### 4.2 方法

#### 物体検出タスクとしての定式化

**利用可能な物体検出手法**:

- R-CNN [6]（Region-based Convolutional Neural Networks）
- YOLO [15]（You Only Look Once）
- SAM [9]（Segment Anything Model）など

**既存手法の課題**:

- ほとんどすべてが訓練フェーズでバウンディングボックスに依存
- 我々の場合、台風中心の位置のみが必要で、サイズは不要
- 訓練に不必要な情報の使用を避けるため、バウンディングボックスを必要としないモデルに焦点

#### 採用した手法

**Javier Ribera et al. [16]のモデル**:

- 重み付きハウスドルフ距離を損失関数として導入
- U-Net [17]アーキテクチャ用

**アーキテクチャ**:

- エンコーダー-デコーダーモデル
- 特徴抽出器として機能
- 上記の損失関数と結合

**損失関数の選択理由**:

- 小さいオブジェクトでも把握する能力

**入力と出力**:

- **入力**: 衛星画像のみ
- **出力**: ヒートマップ（確率マップとして見ることができる）

**中心推定の決定方法**:

- 確率マップに決定論的決定方法を適用
- Javier Ribera et al.では複数の点を検出するためにガウス混合を使用
- 我々の場合: 画像に 1 つの点（台風中心）のみが含まれることを知っている
- したがって、ヒートマップの最大値を台風の推定中心として選択

![図2: 中心推定パイプラインの簡略化された概要]

### 4.3 台風中心推定のためのデータセット

**元の Digital Typhoon データセットからの新しいデータセット作成**:

#### ステップ 1: フィルタリング

階級 2 から 5 のデータを選択

#### ステップ 2: ランダム性の導入

- 各画像は台風の目を中心にしていることを知っている
- 台風中心を含む画像の一部をランダムにクロップ
- この部分は 256×256 ピクセル、約 1250km 幅

#### ステップ 3: ε パラメータの導入

- **ε**: 目と任意のエッジ間の最小距離（ピクセル単位）
- 目的: モデル訓練に十分な情報を提供するため、目の周囲のコンテキストを保存
- 目が画像のエッジの近くに位置する可能性があるため重要

**データセットの構成**:

- クロップされた画像
- クロップ変換後の目の座標
- 座標は 0 と 1 の間に正規化された浮動小数点値

### 4.4 データ拡張

セクション 2.3 で述べたように、実験でデータ拡張技術を慎重に選択する必要がある。

**画像回転拡張の効果チェック**:
クロップ操作に別のステップを実装

**回転拡張の詳細**:

- 確率 p で、台風画像を目の周りに角度 θ で回転
- 角度 θ は間隔[θ_min; θ_max]の間でランダムに選択（訓練フェーズ前に固定）
- この間隔は小さくなければならない
  - 理由: 台風の空間的変形が画像の意味を歪めないようにするため

### 4.5 データセット分割

**分割比**: 訓練/検証/テスト = 0.7/0.15/0.15

**注意点**:

- データセットはシャッフルされる
- 時間依存性は破棄される
- 台風のシーケンス構造は保存されない

### 4.6 結果

**訓練した 2 つのモデル**:

1. クロップ操作のみ
2. クロップ操作 + 回転拡張

**共通設定**:

- ε = 30 ピクセル（任意に設定）
- 訓練エポック数: 140

**回転拡張の設定**（モデル 2 のみ）:

- 確率 p = 0.5
- θ は-5 度から 5 度の間でランダムに設定

**図 3: 2 つの実験の台風階級に関する平均距離誤差**

**結果の表示**:

- 平均距離誤差（キロメートル単位）を各階級についてプロット
- 距離: 推定中心と真値間のユークリッド距離
- 画像の解像度により、1 ピクセルは約 5km

**曲線の説明**:

- 青い曲線: 回転拡張ありの実験
- 赤い曲線: 回転拡張なしの実験
- 両曲線とも標準偏差を示す垂直線と結合

### 4.7 議論

#### 全般的な性能

図 3 は、すべての階級で比較的効果的であることを示している

#### 台風強度と誤差の関係

- **線形関係を観察**: 強い台風ほど小さい誤差
- **理由**: 強い台風は中心周辺により明確な目を持つ
- **弱い台風の課題**: 雲のパターンが不明確な場合、依然として挑戦的なタスク

#### 回転拡張の効果

- 回転拡張は性能を向上させないように見える
- **気象学者の指摘**: 小さな回転角度でさえ風と雲の方向に影響を与える可能性
- これによりデータセットにバイアスが生じる

#### 定性的観察

**ヒートマップスポットのサイズ**:

- 弱い台風の方が強い台風よりも大きい
- 不確実性が弱い台風で増加することを示唆

**標準偏差**:
図 3 の標準偏差もこの点を証明

**複数の最大値**:

- 2 つの最大値が分離されているケースを発見
- この場合、我々の方法は絶対最大値を持つピークのみを選択
- 実際の中心に対応する可能性のある他のピークを見逃す可能性
- したがって、このタイプの不確実性を処理するために人間の介入が必要な可能性を示唆

#### 重要なパラメータと改善の余地

**ε パラメータの重要性**:

- ε は重要なパラメータ
- 中心推定に有用な可能性のある画像の一部を破棄して画像を縮小するため

**入力画像サイズ**:

- より大きいサイズの画像でモデルの性能が悪化

**今後の改善**:

1. 衛星画像全体を扱うには機械学習モデルのスケーラビリティの向上が必要
2. 上記の条件を満たす別のデータ拡張を見つけることは興味深い
   - 台風画像に基づく幅広いタスクに使用できる
3. CenterNet [4]アーキテクチャなどの別のモデルの使用も研究トピックになり得る

## 5. 海盆と半球間のモデルの一般性

### 5.1 研究の目的

**焦点**:
機械学習モデルが台風の異なる海盆に適用された場合の挙動を研究

**目標**:
機械学習モデルがすべての海盆で普遍的に機能できるかをチェック

**対象タスク**:
2 つの異なる海盆（WP データセットと AU データセット）に適用された 3 つのタスク:

1. 中心推定タスク
2. 強度分類タスク
3. 強度回帰タスク

### 5.2 方法

**すべてのタスクの訓練**:
新しいデータセットで訓練

**データ分割**:
WP データセットの分割を使用してすべてのモデルを訓練

**目的**:
WP データセットで訓練されたすべてのモデルをテストし、AU データセットでの挙動を研究

**重要な前処理**:
2 つのデータセット間で循環方向を揃えるために水平反転を導入

### 5.3 タスク別の方法

#### 5.3.1 中心推定タスク

**設定**:

- セクション 4 で提示したタスクと同じ
- 回転拡張なしの同じモデルを使用
- WP 画像のみで訓練

**実験**:
水平反転の必要性を実証するため、水平反転されていない AU 画像でモデルをテスト

#### 5.3.2 強度分類タスク

**タスクの目的**:
時刻 t での画像のみを使用して台風の階級を予測

**使用データ**:

- 階級 2 から 5 の台風のみ
- 画像サイズ: 384×384 ピクセル
  - 我々のハードウェアで効率的な訓練を可能にする最大サイズ

**データ分割**:
セクション 4 と同様の分割を使用

**アーキテクチャ**:
特徴抽出のために 2 つの異なるアーキテクチャを使用:

1. **ResNet** [7]
2. **Vision Transformer (ViT)** [3]

**実装**:

- Pytorch の実装を使用
- ResNet: `resnet34`
- ViT: `vit_b_16`サイズのモデル（torch ライブラリから）

**訓練設定**:

- **損失**: クロスエントロピー損失
- **エポック数**: 60
- **学習率**: 5×10^-3

#### 5.3.3 強度回帰タスク

**タスクの目的**:
前のタスクよりも一歩進んで、台風画像のみを使用して中心気圧を推定

**データ分割の違い**:

- データはシーケンスでソート
- 理由: モデルが回帰タスクではなく補間タスクを実行することを防ぐため

**アーキテクチャ**:
このセクションでは ViT [3]のみを使用

**訓練設定**:

- モデルは同じ
- **損失**: L1 損失に変更
- **エポック数**: 200
- **学習率**: 5×10^-3

### 5.4 結果

#### 5.4.1 中心推定タスク

**図 4: 2 つのテスト海盆での中心推定の平均距離誤差**

**表示内容**:

- 図 3 と同様の中心推定の平均距離誤差
- WP と AU テストセットの性能を表示
- 水平反転なしの AU テストセットでのテスト性能も表示

**単位**:
距離はキロメートルではなくピクセル単位

#### 5.4.2 強度分類タスク

**評価指標**: 精度（Precision）メトリック

**精度の定義**:

```
precision = TP / (TP + FP)
```

- TP: True positive（真陽性）
- FP: False positive（偽陽性）

**精度の意味**:
陽性予測の割合を示す

**表 4: 台風階級に関する 2 つの海盆でのモデル精度**

| 階級 | ViT (WP) | ViT (AU) | ResNet (WP) | ResNet (AU) |
| ---- | -------- | -------- | ----------- | ----------- |
| 2    | 0.856    | 0.670    | 0.912       | 0.738       |
| 3    | 0.773    | 0.310    | 0.837       | 0.343       |
| 4    | 0.744    | 0.280    | 0.825       | 0.305       |
| 5    | 0.927    | 0.785    | 0.923       | 0.698       |

**色分け**:

- 青: 最低値
- 赤: 最高値

#### 5.4.3 強度回帰タスク

**図 5: ViT を使用した 2 つのテスト海盆の回帰誤差**

**表示内容**:

- 階級 2 から 5 の気圧の推定誤差
- 気圧誤差（hPa 単位）: 推定と真値の絶対差
- 2 つの海盆の結果を表示

### 5.5 議論

#### 水平反転の必要性（図 4）

**観察**:
すべての階級を通じて赤い曲線と緑の曲線の間のギャップ

**示唆**:
水平反転が必要であることを示す

**理由**:
反転により訓練データとテストデータ間の均質性（したがって比較可能性）が増加

- つまり、2 つの海盆間での比較可能性が向上

#### 2 つのテスト海盆間の性能ギャップ

**図 4、図 5、表 4 の共通観察**:
3 つのすべてのタスクで 2 つのテスト海盆間の性能にギャップが存在

**示唆**:
画像を反転させるだけでは、2 つの海盆からの画像を均質化するのに十分ではない可能性

#### 機関間の違いの影響（表 4）

**階級 3 と 4 での大きなギャップ**:
値のギャップには別の解釈がある可能性

**分類タスクの特徴**:
ラベルに大きく依存

**問題点**:

- ラベルは 2 つの異なる機関によって与えられた
- Knapp and Kruk [12]は機関間の違いが存在する可能性を指摘

**階級 3 と 4 の性能ギャップの可能性のある理由**:
階級間の異なる移行ルール

**混同行列による確認**:
この観察は混同行列を使用しても行われる

**人的要因の考慮**:

- 人的要因を考慮すると、性能はアーキテクチャ問題ではなくデータ問題を示している可能性
- これは 2 つのモデルが同様の挙動を持つ理由も説明できる

## 6. 結論

### 6.1 主要な貢献

**Digital Typhoon Dataset V2 の紹介**:
機械学習と気象学コミュニティに、熱帯低気圧に関するデータ駆動型研究を促進するために導入

**初回更新の意義**:
2023 年 11 月以来のデータセットの最初の更新

**重要な更新**:
空間次元への大幅な更新により、南半球からのデータを追加

### 6.2 今後のバージョンの計画

**さらなる次元の追加計画**:

#### 方向性 1: チャンネルの追加

- 赤外線（Infrared）
- 水蒸気（Water Vapor）
- 可視光（Visible）

#### 方向性 2: 時間頻度の増加

- 30 分
- 10 分
- さらには 2.5 分

### 6.3 新しいデータセットの制約と可能性

**期間の短縮が必要**:
他のチャンネルとより高い頻度のデータは、新しい衛星でのみ利用可能なため

**新しい可能性**:
これらの新しいデータセットは以下を可能にする:

1. 新しいタスクの可能性を開く
2. 新しい研究課題を問うことを可能にする
3. 新しい科学的発見につながる
4. 社会的および持続可能性の問題に対する効果的な解決策につながる

### 6.4 本研究で実施した新しい展開

#### 1. 表現学習（セクション 3）

- 自己教師あり学習（SSL）フレームワークの使用
- MoCo v2 による台風画像の特徴抽出
- 強度予測と ETS 移行予測での有効性を実証

#### 2. 台風中心推定タスク（セクション 4）

- U-Net ベースの物体検出手法の提案
- 強い台風でより良い性能
- 弱い台風での挑戦と改善の余地

#### 3. 海盆間・半球間の一般化（セクション 5）

- モデルが異なる海盆間で一般化できるかを検証
- 水平反転の重要性を確認
- 機関間のデータの違いの影響を発見

## 謝辞

著者のうち 2 名、Erwan Dzik と Gaspar Faure は、国立情報学研究所の国際インターンシッププログラムによってサポートされた。

## データセットとコードの利用可能性

**Digital Typhoon Dataset V2**:

- http://agora.ex.nii.ac.jp/digital-typhoon/dataset/
- ライセンス: Creative Commons Attribution 4.0 International (CC BY 4.0) License

**pyphoon2 ライブラリ**:

- https://github.com/kitamoto-lab/digital-typhoon/

**LSTM 実験と画像エンコーダー訓練のコード**:

- https://github.com/gafaua/typhoon-latent-forecast

## 研究の意義

本研究は、Digital Typhoon Dataset V2 という包括的なデータセットの提供を通じて、以下の貢献をしている:

1. **データの民主化**: 40 年以上の長期台風データを機械学習コミュニティに提供
2. **新しい研究方向**: 半球間比較など、新しい研究課題の可能性を開く
3. **実用的な応用**: 強度予測、中心推定など、運用上重要なタスクでの機械学習の有効性を実証
4. **課題の明確化**: 機関間の違い、データ品質の問題など、今後取り組むべき課題を明確化

これらの貢献により、本研究は熱帯低気圧研究におけるデータ駆動型アプローチのさらなる発展に寄与することが期待される。
