# Hurricane Forecasting: A Novel Multimodal Machine Learning Framework
## ハリケーン予測：新しいマルチモーダル機械学習フレームワーク

**著者:**
- Léonard Boussioux (MIT Operations Research Center)
- Cynthia Zeng (MIT Operations Research Center)
- Théo Guénais (Harvard University School of Engineering and Applied Sciences)
- Dimitris Bertsimas (MIT Sloan School of Management and Operations Research Center)

**出典:** arXiv:2011.06125v4 [cs.LG] 24 Sep 2022

---

## 概要（Abstract）

本論文は、複数の機械学習技術を組み合わせ、多様なデータソースを活用した熱帯低気圧の強度と進路予測のための新しい機械学習（ML）フレームワークについて説明しています。我々のマルチモーダルフレームワーク「Hurricast」と呼ばれるものは、深層学習のエンコーダー・デコーダーアーキテクチャで特徴を抽出し、勾配ブースティング木で予測することで、時空間データと統計データを効率的に組み合わせています。

2016年から2019年の北大西洋および東太平洋海域における24時間リードタイムの進路と強度予測でモデルを評価し、現在の運用予測モデルと同等の平均絶対誤差とスキルを達成しながら、数秒で計算できることを示しています。さらに、Hurricastを運用予測コンセンサスモデルに組み込むことで、国立ハリケーンセンターの公式予測を改善できる可能性があり、既存のアプローチとの補完的な特性を強調しています。

要約すると、本研究は、機械学習技術を使用して異なるデータソースを組み合わせることが、熱帯低気圧予測における新しい機会につながることを実証しています。

## 重要性の声明（Significance Statement）

機械学習技術は、熱帯低気圧の移動と強度予測の改善のために十分に探求されていません。本研究は、高度な機械学習技術と日常的に利用可能な情報を組み合わせて、24時間の熱帯低気圧予測を効率的に改善できることを示しています。実証された成功は、より長いリードタイムの予測を改善し、予測の不確実性をさらに減らし、社会に利益をもたらすためのレシピを提供します。

---

## 1. 序論（Introduction）

熱帯低気圧（TC）は、熱帯または亜熱帯の海域から発生する低気圧システムで、海から引き出すエネルギーによって発達します。明確に定義された中心の周りの暖気核、組織化された深い対流、および閉じた地上風循環によって特徴付けられます。毎年、熱帯低気圧は数百人の死者と、家庭や企業に数十億ドルの損害をもたらしています（Grinsted et al. 2019）。したがって、十分なリードタイムでTCの進路と強度の正確な予測を作成することは、命を救う措置を講じるために不可欠です。

予測タスクには、TCの進路、強度、サイズ、構造、および関連する高潮、降雨、竜巻が含まれます。ほとんどの予測モデルは、進路（軌道）予測と強度予測、すなわち特定の時間間隔での最大持続風速などの強度測定値を作成することに焦点を当てています。

現在の運用TC予測は、力学モデル、統計モデル、統計力学モデルに分類できます（Cangialosi 2020）。力学モデルは数値モデルとも呼ばれ、強力なスーパーコンピューターを利用して、力学および熱力学方程式を使用して大気場の進化をシミュレートします（Biswas et al. 2018; ECWMF 2019）。統計モデルは、ストームの挙動とストーム固有の特徴との間の過去の関係を近似し、一般的に物理プロセスを明示的に考慮しません（Aberson 1998; Knaff et al. 2003）。統計力学モデルは統計技術を使用しますが、さらに力学モデルによって提供される大気変数を含みます（DeMaria et al. 2005）。最後に、アンサンブルモデルは単一モデルの複数回の実行によって行われた予測を組み合わせます（Cangialosi 2020）。さらに、コンセンサスモデルは通常、個別の運用予測を単純または重み付き平均で組み合わせます（Sampson et al. 2008; Simon et al. 2018; Cangialosi 2020; Cangialosi et al. 2020）。

さらに、深層学習（DL）における最近の発展により、機械学習（ML）モデルは、幅広いソースからの情報を処理および組み合わせ、時空間関係をモデル化するための洗練されたアーキテクチャを作成するための複数のデータ処理技術を採用できるようになりました。

いくつかの研究は、過去のデータに基づいてTC軌道を予測するためにリカレントニューラルネットワーク（RNN）の使用を実証しています（Moradi Kordmahalleh et al. 2016; Gao et al. 2018; Alemany et al. 2019）。畳み込みニューラルネットワーク（CNN）も、進路予測のための再解析データと衛星データの処理（Mudigonda et al. 2017; Lian et al. 2020; Giard-Roisin et al. 2020）、およびストームの強化予測（Chen et al. 2019; Su et al. 2020）に適用されています。

本論文では、深層学習アーキテクチャと勾配ブースティング木を組み合わせることにより、複数のデータソースを組み合わせて強度と進路予測の両方を行うHuricast（HUML）と呼ばれる機械学習フレームワークを紹介します。

### 本研究の貢献

1. **複数のデータソースを活用する新しいマルチモーダル機械学習技術**：TC強度と進路予測のために、異なる予測方法論を組み合わせて複数の個別データソースを利用する新しいマルチモーダル機械学習技術を提示します。Hurricastフレームワークは、過去のデータに基づく統計的特徴と、大気再解析マップから深層学習エンコーダー・デコーダーアーキテクチャで抽出された時空間特徴を使用してXGBoostモデルで予測を行います。

2. **運用モデルとの比較可能な結果**：北大西洋および東太平洋海域で評価し、我々の機械学習モデルが24時間リードタイムの強度と進路予測タスクの両方で、現在運用中のモデルと比較可能な結果を生み出すことを実証します。

3. **コンセンサスモデルへの貢献**：テストに基づいて、コンセンサスモデルへの入力として機械学習モデルを1つ追加することでパフォーマンスが向上する可能性があり、ハリケーン予測に機械学習アプローチを組み込む可能性を示唆しています。

### 論文の構成

- セクション2：本研究の範囲で使用されるデータについて説明
- セクション3：機械学習モデルの基本原理を説明
- セクション4：実施された実験について説明
- セクション5：結果からの結論とフレームワークの有効性を検証
- セクション6：潜在的な運用展開のための制限事項と今後の作業について議論

---

## 2. データ（Data）

本研究では、1980年以降の3種類のデータを使用しています：過去のストームデータ、再解析マップ、および運用予測データ。1980年以降の7つのTC海域からのすべてのストームを使用し、最大強度が34kt以上に達する（少なくとも熱帯低気圧として分類される）もので、初めて34ktに達した後、60時間以上のデータが利用可能なものを対象としています。

表1は、データに含まれる各海域のTC分布をまとめています。

### a. 過去のストームデータセット

国立海洋大気庁（NOAA）のシーズン後ストーム分析データセットIBTrACS（Knapp et al. 2010）から過去のストームデータを取得しました。利用可能な特徴の中から、以下を選択しました：
- 時刻
- 緯度、経度
- TC中心の最低気圧
- 陸地までの距離
- TCの移動速度
- TCの方向
- TCタイプ（擾乱、熱帯、温帯低気圧など）
- 海域（北大西洋、東太平洋、西太平洋など）
- WMO機関からの最大持続風速（利用できない場合は地域機関から）

全体的な特徴の選択は、以前の統計予測アプローチと一致しています（DeMaria and Kaplan 1994; DeMaria et al. 2005; Giard-Roisin et al. 2020）。本論文では、このデータを**統計データ**と呼びます（表2を参照）。

IBTrACSデータセットは、元の6時間記録頻度から3時間頻度にいくつかの特徴を補間します。位置特徴（例：緯度と経度）のスプライン補間と、位置に関連しない特徴（風速、地域機関によって報告された気圧）の線形補間を提供します。ただし、WMOの風速と気圧はIBTrACSによって補間されず、3時間頻度に一致するように線形補間しました。

機械学習モデルに入力する前に、いくつかのステップで統計データを処理しました：

1. **カテゴリカル特徴の処理**：ワンホットエンコーディング技術を使用して、各可能なカテゴリを追加のバイナリ特徴に変換（1はサンプルがこのカテゴリに属することを示し、0はそれ以外を示す）

2. **周期的特徴のエンコーディング**：コサインとサイン変換を使用して、エンドポイントでの特異点を回避。日付、緯度、経度、ストーム方向に適用

3. **追加特徴の工学**：2つの連続ステップ間の緯度と経度の変位（度単位）を、一次の動的効果を捉えるために各タイムステップごとに追加

4. **風速の標準化**：報告される最大持続風速は、特定の報告機関によって異なる平均化ポリシーを持つ可能性があります（米国海域は1分、他のWMO地域専門気象センターは10分）。Harper et al. (2010)の推奨に従って、10分値を0.93で割って、すべての平均化期間を1分に調整しました。

### b. 再解析マップ

欧州中期気象予報センター（ECWMF）によって開発された広範なERA5再解析データセット（Hersbach et al. 2020）を使用しました。ERA5は、大気、陸地、海洋気候変数の時間ごとの推定値を提供します。データは30kmグリッドで地球をカバーし、表面から80kmの高さまでの137レベルを使用して大気を解決します。

IBTrACSデータセットによって与えられたストーム位置を中心とする、解像度1°×1°の25°×25°のマップを時間全体で抽出しました（各セルは緯度と経度の1度に対応し、ストーム全体を捉えるのに十分なフレームサイズを提供します）。

各TCタイムステップに対して9つの再解析マップを取得しました：
- 3つの異なる特徴（ジオポテンシャル高度z、風の東西成分u、風の南北成分v）
- 3つの気圧レベル（225、500、700 hPa）

図1に示すように、これらの3つの特徴を選択したのは、TCの進化に影響を与える物理情報を組み込むためで、この選択は再解析マップの処理にML技術を適用する以前の文献によって動機付けられています（Shimada et al. 2018; Chen et al. 2019; Giard-Roisin et al. 2020）。

**注意点**：再解析マップをTC予測に使用することには2つの主な制限があります：
1. 再解析製品であるため、リアルタイムでは利用できず、運用使用を大幅に妨げます
2. 熱帯低気圧の表現に欠陥があります（Schenkel and Hart 2012; Hodges et al. 2017; Bian et al. 2021）。特に、大きなTCサイズが過小評価されています（Bian et al. 2021）

### c. 運用予測モデル

自動化熱帯低気圧予測（ATCF）データセット（Sampson and Schrader 2000; National Hurricane Center 2021）から運用予測データを取得しました。ATCFデータには、北大西洋および東太平洋海域の熱帯低気圧と亜熱帯低気圧に対するNHCの公式予測に使用される運用モデルによる過去の予測が含まれています。

ベンチマークとしてモデルのパフォーマンスを比較するために、十分な数のケースで同時に利用可能な最強の運用予測を選択しました：
- **強度予測**：DSHP、GFSO、HWRF、FSSE、OFCL
- **進路予測**：CLP5、HWRF、GFSO、AEMN、FSSE、OFCL

詳細なリストは表3を参照してください。Tropycalパイソンパッケージ（Burg and Lillo 2020）を使用して予測データを抽出しました。

---

## 3. 方法論（Methodology）

Hurricastフレームワークは、異なる形式の時系列データに基づいて予測を行います：
- 3次元ビジョンベースの再解析マップ
- 数値および分類特徴からなる1次元の過去のストームデータ

異なるタイプのデータを同時に使用する問題は、機械学習の分野では広くマルチモーダル学習として知られています。

### 全体的なアプローチ

複数のデータソースを組み合わせるために、3ステップのアプローチを採用しています：

1. **特徴抽出**：各再解析マップシーケンスから1次元特徴表現（埋め込み）を抽出
2. **結合**：この1次元埋め込みを統計データと連結して1次元ベクトルを形成
3. **予測**：選択された特徴で訓練された勾配ブースティング木XGBoostモデル（Chen and Guestrin 2016）を使用して予測を実行

与えられたタイムステップ（予測ケース）で、24時間リードタイムの2つの予測タスクを実行します：
- **強度予測**：24時間リードタイムでの最大持続風速の予測
- **変位予測**：与えられた時刻と24時間後の時刻の間の緯度と経度のストーム変位（度単位）

図2は3ステップパイプラインを示しています。

### a. 特徴抽出

ステップ1で特徴抽出を実行するために、再解析マップの埋め込みを取得するための2つのコンピュータビジョン技術を実験しました：

#### 1) エンコーダー・デコーダーアーキテクチャ

エンコーダー・デコーダーニューラルネットワークアーキテクチャは、2つのコンポーネントで構成される一般的なタイプの深層学習アーキテクチャを指します：
- **エンコーダー**：入力データを潜在空間にマッピング
- **デコーダー**：潜在空間の埋め込みを予測にマッピング

マルチモーダルデータを扱うのに適しており、異なるタイプのニューラルネットワーク層を異なるモダリティに適合させることができます。

**CNN-エンコーダー**：各タイムステップで、9つの再解析マップをCNN-エンコーダーに供給し、1次元埋め込みを生成します。CNN-エンコーダーは、間にReLU活性化とMaxPool層を持つ3つの畳み込み層と、その後の2つの全結合層で構成されています。

**デコーダーのバリエーション**：

1. **GRU-デコーダー**：ゲート付き回帰ユニット（GRU）（Chung et al. 2014）に依存し、シーケンシャルデータにおける時間的動的挙動をモデル化するのに適したリカレントニューラルネットワーク。

2. **Transformer-デコーダー**：Transformers（Vaswani et al. 2017）を使用し、シーケンシャルデータの最先端アーキテクチャ。GRUモデルが再帰メカニズムを通じて時間的側面をモデル化するのに対し、Transformersは注意メカニズムと位置エンコーディング（Bahdanau et al. 2015; Vaswani et al. 2017）を利用して長距離依存性をモデル化します。

**訓練プロセス**：
- 標準的な誤差逆伝播を使用してエンコーダー・デコーダーアーキテクチャを訓練
- 強度または進路目標を持つ平均二乗誤差損失を使用
- ネットワークの重みにL2正則化ペナルティを追加
- 訓練完了後、エンコーダー・デコーダーの重みを凍結

**特徴抽出**：
与えられた入力シーケンスの再解析マップと統計データから特徴を抽出するために、最後の全結合層を除いて、凍結されたエンコーダー・デコーダー全体を通過させます。GRUの後の2番目の全結合層またはTransformer出力の後のプーリング層は、例えば128特徴の比較的小さいサイズのベクトルを出力し、情報を圧縮して予測特徴を提供します。このベクトルは、初期の45,000（8×9×25×25）特徴を形成する時空間入力から抽出された1次元再解析マップ埋め込みを構成します。

この方法は転移学習と蒸留に触発され、視覚画像で一般的に効率的です（Yosinski et al. 2014; Kiela and Bottou 2014; Hinton et al. 2015; Tan et al. 2018）。

図3と図4はエンコーダー・デコーダーアーキテクチャを示しています。

#### 2) テンソル分解

特徴抽出の手段としてテンソル分解法も探求しました。テンソル分解を使用する動機は、低次元特徴を使用して高次元データを表現することです。本研究では、高次特異値分解としても知られるTucker分解定義を使用します。前述のニューラルネットワークベースの特徴処理技術とは対照的に、テンソル分解は教師なし抽出技術であり、特定の予測ターゲットに関して特徴が学習されないことを意味します。

**プロセス**：
- 各タイムステップで、過去のタイムステップにわたる過去の再解析マップを、サイズ8×9×25×25の4次元テンソルとして扱います
- Tucker分解から得られたコアテンソルを平坦化した後、抽出された特徴として使用
- 多重線形特異値分解（SVD）法を使用してテンソルを分解（De Lathauwer et al. 2000）

コアテンソルのサイズ（Tucker分解のランク）は調整すべきハイパーパラメータです。検証に基づいて、Tuckerランクはサイズ3×5×3×3に調整されました。

### b. 予測モデル

**ステップ2**：関連するデータソースからの特徴を連結して、各予測ケースに対応する1次元入力ベクトルを形成します。

- まず、過去の観測の固定ウィンドウサイズに対応する統計データシーケンスを1次元ベクトルに再形成
- 次に、特徴抽出技術の1つで得られた1次元再解析マップ埋め込みと連結

**ステップ3**：進路と強度予測にXGBoostモデルを使用しました。XGBoostは勾配ブースティング木ベースのモデルで、優れたモデリングスキルと効率的な計算時間のために機械学習コミュニティで広く使用されています。実験段階で線形モデル、サポートベクターマシン、決定木、ランダムフォレスト、フィードフォワードニューラルネットワークを含むいくつかの他の機械学習モデルを比較し、XGBoostが一般的に最も高性能であることを発見しました。

### c. モデルの要約

テストおよび保持されたすべての予測モデルをリストし、表4で採用された方法論を要約します。

**モデル1-4**：図2に記述された3ステップフレームワークのバリエーション
- **モデル1 HUML-(stat, xgb)**：統計データのみを利用する最もシンプルな形式
- **モデル2 HUML-(stat/viz, xgb/td)**：テンソル分解技術で抽出されたビジョン特徴を使用
- **モデル3 HUML-(stat/viz, xgb/cnn/gru)**：GRUデコーダーを持つエンコーダー・デコーダーで抽出されたビジョン特徴を使用
- **モデル4 HUML-(stat/viz, xgb/cnn/transfo)**：Transformerデコーダーを持つエンコーダー・デコーダーで抽出されたビジョン特徴を使用

**モデル5 HUML-ensemble**：モデル1-4の重み付きコンセンサスモデル。各モデルに与えられる重みはElasticNetを使用して最適化

**モデル6 HUML/OP-average**：NHCが使用するいくつかの運用予測モデルと我々のモデル4の単純平均コンセンサス

---

## 4. 実験（Experiments）

### a. 評価指標

**強度予測の評価**：24時間後の予測された1分最大持続風速の平均絶対誤差（MAE）を計算：

MAE := (1/N) Σ|y_true_i - y_pred_i|

ここで、Nは予測数、y_pred_iは24時間リードタイムでの予測強度、y_true_iはWMO機関によって与えられた実際の1分最大持続風速値です。

**進路予測の評価**：ハバーサイン公式を使用して、24時間後の実際の位置と予測位置の間の平均地理的距離誤差（キロメートル単位）を計算しました。ハバーサイン指標は、2つの点間の大圏距離、すなわち地球表面上のこれら2つの点間の最短距離を計算します。

また、MAE誤差の標準偏差と予測スキルも報告しています。強度にはDecay-SHIPS、進路にはCLP5をベースラインとして使用しています。

### b. 訓練、検証、テストプロトコル

データセットを訓練（データの80％）、検証（データの10％）、テスト（データの10％）に分割しました：
- **訓練セット**：1980年から2011年
- **検証セット**：2012年から2015年
- **テストセット**：2016年から2019年

各セット内で、すべてのサンプルを独立して扱いました。

テストセットは、2016年から2019年のNAおよびEP海域からのすべてのTCケースで構成され、ベンチマークとして運用予測が同時に利用可能です。同じケースですべてのモデルを比較します。

訓練と検証中はすべての海域のデータを使用しますが、運用予測データが利用可能な北大西洋および東太平洋海域のパフォーマンスのみを報告します。

### c. 計算リソース

コードはhttps://github.com/leobix/hurricastで利用可能です。Python 3.6（Van Rossum and Drake Jr 1995）を使用し、Pytorch（Paszke et al. 2019）を使用してニューラルネットワークをコーディングしました。

1つのTesla V100 GPUと6つのCPUコアを使用してすべてのモデルを訓練しました。通常、エンコーダー・デコーダーは1時間以内に訓練され、30エポック後に最良の検証パフォーマンスに到達しました。XGBoostモデルは2分以内に訓練されました。

テスト時に新しい予測を行う場合、モデル全体（特徴抽出 + XGBoost）は数秒以内に実行され、展開の実用的な関心を示しています。ボトルネックは再解析マップの取得のみにあります。この点についてはセクション6.aでさらに議論します。

---

## 5. 結果（Results）

### (i) スタンドアロン機械学習モデルは運用モデルと同等のパフォーマンスを生成

24時間リードタイムの進路予測について、表5に示すように、最良のHuricastモデルHUML-(stat/viz, xgb/cnn/transfo)は、EP海域でCLP5に対して40%のスキルを持っています。比較として、HWRFは45%、GFSOは46%のスキルを持っています。NA海域では、HUML-(stat/viz, xgb/cnn/transfo)は46%のスキルを持ち、HWRFは63%、GFSOは65%です。

24時間リードタイムの強度予測について、表6に示すように、マルチモーダルHuricastモデルは、EP海域でDecay-SHIPS、HWRF、GFSOよりも優れたMAEと低い誤差の標準偏差を持っています。特に、我々の最良モデルHUML-(stat/viz, xgb/cnn/transfo)は、MAEでDecay-SHIPSを12%、HWRFを3%上回っています。NA海域では、HUML-(stat/viz, xgb/cnn/transfo)はDecay-SHIPSに2%、HWRFに7%劣りますが、誤差の標準偏差は低くなっています。

これらの結果は、機械学習アプローチがこの分野で現在存在する予測方法論に対する新しい方法論として出現できることを強調しています。さらに、より多くの利用可能なデータソースが与えられれば、改善の可能性があると考えています。

### (ii) 機械学習モデルはコンセンサスモデルに追加の洞察をもたらす

コンセンサスモデルは、誤差とバイアスを平均化することにより、個別のモデルよりも優れたパフォーマンスを生み出すことがよくあります。したがって、2つのコンセンサスモデルのテストを実施しました：HUML-ensembleはすべての個別Huricast変種の重み付き平均です。HUML/OP-consensusは、HUML-(stat/viz, xgb/cnn/transfo)と我々のベンチマークに含まれる他のスタンドアロン運用モデルの単純平均です。

表7と表8に示すように、HUML-ensembleは、MAEの観点から最良のHuricast変種を一貫して改善しており、機械学習モデルから実用的なアンサンブルを構築する可能性を示しています。

さらに、OP-averageコンセンサスは、利用可能な運用予測の等重み平均です。HUML-(stat/viz, xgb/cnn/transfo)モデルを追加して含めることにより、HUML/OP-averageコンセンサスを構築しました。結果は、我々の機械学習モデルを含めることが、進路と強度の両タスクのコンセンサスに価値をもたらすことを示しています。さらに、HUML/OP-averageは、24時間リードタイムの我々のテスト範囲において、NHCの公式予測OFCLよりも低いMAEと標準偏差を生み出します。

特に、我々の24時間リードタイムテスト範囲において、強度MAEの観点から、HUML/OP-averageはEP海域でOFCLを8%、NA海域で2%上回っています。進路MAEでは、HUML/OP-averageはEP海域でOFCLを7%、NA海域で14%上回っています。

注記として、我々の実験では運用モデル予測の計算時間遅延を考慮していません。計算時間は変動し、力学モデルでは数時間かかる場合があります。それにもかかわらず、これらの結果は、機械学習モデルの運用モデルに対する補完的な利点を強調しています。

### (iii) マルチモーダルアプローチは、単一のデータソースを使用するよりも正確な予測につながる

表5と表6に示すように、進路と強度の両予測において、マルチモーダルモデルは統計データのみを使用するモデルよりも高い精度と低い標準偏差を達成しています。

深層学習特徴抽出法は、テンソル分解ベースのアプローチを上回っています。これは、我々のエンコーダー・デコーダーが教師あり学習目標で訓練されたため、抽出された特徴が特定の下流予測タスクに合わせて調整されているため、驚くことではありません。一方、テンソル分解は有利にラベル非依存ですが、予測に十分な情報を持つ特徴を抽出できませんでした。

---

## 6. 制限事項と拡張（Limitations and Extensions）

### a. 再解析マップの使用

再解析マップの重要な制限は、観測データに基づいて同化されるため、構築のための計算時間です。したがって、我々のモデルは数秒で予測を計算できますが、再解析マップへの依存がリアルタイム予測のボトルネックとなっています。したがって、効果的な展開のための自然な拡張は、リアルタイム観測データまたはHWRFなどの強力な力学モデルからのフィールド予測を使用してモデルを訓練することです。力学モデルは改善された物理学、高解像度、および修正されたバグで常に更新されているため、再予測製品（例：Hamill et al. (2013)）は訓練に適しているはずです。それにもかかわらず、我々のフレームワークが将来運用機械学習モデルを構築するための指針と参考を提供できることを期待しています。

### b. 追加データの組み込み

本研究の範囲内で、タイムステップごとに9つの再解析マップを使用しました。これは、3つの気圧レベルからのジオポテンシャル高度（z）、風の東西成分（u）、風の南北成分（v）のフィールドに対応しています。自然な拡張の1つは、海面温度、温度、相対湿度などの追加特徴を含め、より多くの垂直レベルからの情報を含めることで、モデルのパフォーマンスを向上させる可能性があります。

さらに、衛星データやレーダーデータなど、より多くのデータソースを含めることができます。特に、我々のフレームワークの柔軟性を強調します。これは、新しいデータを簡単に組み込むことができます：異なる特徴抽出アーキテクチャを採用し、抽出された特徴をXGBoost予測モデルに追加または置換できます。

### c. より長期の予測

我々は、ハリケーン予測タスクにおけるML技術の可能性を実証するために、24時間リードタイム予測の実験を実施しました。しかし、そのようなアプローチを展開する前に、より長期の予測に関する実験が必要です。例えば、公式NHC予測は最大5日間のガイダンスを提供します。それにもかかわらず、我々のフレームワークは、より長いリードタイム予測に拡張できます。特に、我々のモデルは任意の長さの入力シーケンスを処理できるため、入力ウィンドウサイズ（現在の24時間から）を拡張することをお勧めします。

---

## 7. 結論（Conclusion）

本研究は、過去のストームデータと気象再解析データを利用した熱帯低気圧の強度と進路予測のための新しいマルチモーダル機械学習フレームワークを実証しています。我々は、複数の機械学習アプローチを組み合わせる3ステップパイプラインを提示します：(1) 深層特徴抽出、(2) すべての処理された特徴の連結、(3) 予測。深層学習技術と勾配ブースティング木の成功的な組み合わせが、進路と強度予測の両方で強力な予測を達成でき、特に強度タスクにおいて現在の運用予測モデルと同等の結果を生み出すことができることを実証しています。リアルタイム再解析データの利用不可能性が運用使用に課題をもたらすことを認識しており、他の運用データソースでフレームワークを拡張する今後の作業を提案します。

我々は、マルチモーダルエンコーダー・デコーダーアーキテクチャが、下流予測タスクのための時空間特徴抽出器として成功裏に機能できることを実証しています。特に、これは熱帯低気圧予測におけるTransformer-デコーダーアーキテクチャの初めての成功的な適用でもあります。

さらに、我々の機械学習モデルを含むコンセンサスモデルが、強度と進路の両方でNHCの公式予測に利益をもたらす可能性があることを示し、熱帯低気圧予測の新しい分野方法論として機械学習アプローチを開発する潜在的な価値を実証しています。

さらに、一度訓練されると、我々のモデルは数秒で実行され、リアルタイム予測の実用的な関心を示しています。ボトルネックはデータ取得のみにあります。我々は、効果的な実世界展開のための拡張とガイダンスを提案します。

結論として、我々の研究は、機械学習が熱帯低気圧予測の分野に貴重な追加を提供できることを実証しています。この研究が気象予測における機械学習のさらなる使用への扉を開くことを期待しています。

---

## 謝辞（Acknowledgments）

Weather and Forecasting誌のレビューチームに、論文を大幅に改善する洞察に満ちたコメントに感謝します。Louis Maestrati、Sophie Giard-Roisin、Charles Guille-Escuret、Baptiste Goujaud、David Yu-Tung Hui、Ding Wang、Tianxing Heとの有益な議論に感謝します。校正についてNicolò Forcellini、Miya Wangに感謝します。この研究は、OCP GroupからMITへの助成金により部分的に支援されました。著者は、本論文で報告された研究結果に貢献した高性能計算リソースを提供してくれたMIT SuperCloudおよびLincoln Laboratory Supercomputing Centerに感謝します。

---

## データ利用可能性声明（Data Availability Statement）

我々が使用したすべてのデータはオープンソースであり、IBTrACSからのTC特徴、Tropycalからの運用予測、ERA-5からのビジョンデータとして、インターネットから直接アクセスできます。我々のコードは https://github.com/leobix/hurricast で利用可能です。

---

## 付録（Appendix）

### 技術的コンポーネント

#### A1. エンコーダー・デコーダーアーキテクチャ

##### a. 全体的なアーキテクチャとメカニズム

**CNN-エンコーダー**：各タイムステップで、9つの再解析マップをCNN-エンコーダーに供給し、1次元埋め込みを生成します。CNN-エンコーダーは、間にReLU活性化とMaxPool層を持つ3つの畳み込み層と、その後の2つの全結合層で構成されています。

次に、再解析マップ埋め込みを同じタイムステップに対応する処理された統計データと連結します。この時点で、データはまだ8つのタイムステップとしてシーケンシャルに構造化されており、デコーダーに渡されます。

**GRU-デコーダー**：我々のGRU-デコーダーは2つの単方向層で構成されています。エンコーダーによって埋め込まれたデータシーケンスは、時系列順にGRU-デコーダーに順次供給されます。各タイムステップで、GRU-デコーダーは前のタイムステップの記憶を表す隠れ状態を出力します。最後に、これらの隠れ状態をすべて連結し、全結合層への入力として与えることにより、進路または強度予測を行います（図3参照）。

**Transformer-デコーダー**：GRU-デコーダーとは対照的に、シーケンス全体をTransformer-デコーダーに供給します。注意メカニズムにより、各隠れ表現が他の隠れ表現に全体的に注意を払うことができるため、時間-シーケンシャルな側面が失われます。したがって、標準的な慣行に従って、各タイムステップ入力に位置エンコーディングトークンを追加します（Vaswani et al. 2017）。このトークンは、シーケンス内のタイムステップの相対位置を表し、データの本質的なシーケンシャルな側面に関する情報を再導入し、実験的にパフォーマンスを改善します。

次に、8つのタイムステップ（サイズ142）を類似の次元を持つ8タイムステップシーケンスに変換する2つのTransformer層を使用します。シーケンスの一意な表現を得るために、標準的な慣行に従って、出力シーケンスを特徴ごとに平均化して1次元ベクトルにします。最後に、この平均化されたベクトルを1つの全結合層に入力することにより、進路または強度予測を行います（図4参照）。

**損失関数**：ネットワークは、関心のある変数（最大持続風速またはTC変位）の平均二乗誤差損失に基づく目的関数Lを使用して訓練され、ネットワークの重みにL2正則化項が追加されます：

L := (1/N) Σ(y_true_i - y_pred_i)² + λΣΣW[l]²_kj

ここで、Nは予測数、y_pred_iは24時間リードタイムでの予測強度または緯度-経度変位、y_true_iは真値、λは検証によって選択される正則化パラメータ、W[l]はネットワークのl番目の層の重みです。Adam最適化器（Kingma and Ba 2014）を使用してこの損失関数を最小化します。

##### b. CNN-エンコーダー GRU-デコーダーネットワークの技術的詳細

我々のエンコーダー・デコーダーアーキテクチャのより正式で正確な説明を提供します。

**(i) CNN-エンコーダー GRU-デコーダーアーキテクチャの詳細**

tを24時間リードタイム予測を行いたい瞬間とします。x^viz_t ∈ R^(8×9×25×25)をCNNの対応する時空間入力とし、8は シーケンス内の過去のタイムステップ数、9は気圧レベル数×特徴マップ数、25×25は各再解析マップのピクセルサイズです。x^stat_t ∈ R^(8×31)を対応する統計データとし、8はシーケンス内のタイムステップ数、31は各タイムステップで利用可能な特徴数です。

まず、x^viz_tはCNNによってx^emb_t ∈ R^(8×128)に埋め込まれます。ここで、8はシーケンス内のタイムステップ数、128は埋め込み空間の次元です。図A1は、CNN-エンコーダーによるこの埋め込みプロセスの図を提供します。

iを{0,...,7}のシーケンス内のタイムステップの対応するインデックスとします。シーケンスの各タイムステップt_iで、CNN埋め込みx^emb_{t_i}は統計データx^stat_{t_i}と連結され、次のように処理されます：

h_{t_i} := GRU(h_{t_{i-1}}, [x^emb_{t_i}, x^stat_{t_i}])

h_{t_0} = 0、h_{t_i} ∈ R^128、∀i。[·]は列軸に沿った2つのベクトルの連結を意味し、1次元ベクトルを保持します。

最後に、h_{t_0},...,h_{t_7}を連結してサイズ8×128=1024の1次元ベクトルx^hidden_tを得て、このベクトルを入力-出力サイズ(1024, 512)、(512, 128)、(128, c)の3つの全結合線形層のシリーズに通します。ここで、c=2は進路予測タスク、c=1は強度タスクです。最終層が予測を行います。

時空間埋め込み特徴を抽出するために、次元128の2番目の全結合層の出力を使用します。したがって、この技術により、8×9×25×25=45,000特徴を、XGBoostモデルに入力できる128の予測特徴に削減できます。

CNNの各畳み込み層には、次のパラメータを使用します：カーネルサイズ=3、ストライド=1、パディング=0。各MaxPool層には、次のパラメータを使用します：カーネルサイズ=2、ストライド=2、パディング=0。

CNN-エンコーダーアーキテクチャはGiard-Roisin et al. (2020)に触発されています。GRU-デコーダーまたはTransformer-デコーダーとの組み合わせと特徴抽出は、我々の研究の貢献です。

##### c. Transformer-デコーダーアーキテクチャの技術的詳細

CNN-エンコーダー GRU-デコーダーネットワークと同様に、時空間入力は処理され、統計データと連結されて入力シーケンス[x^emb_{t_i}, x^stat_{t_i}]_{i∈{0,...,7}}を得ます。Vaswani et al. (2017)によって提案されたように、シーケンス内の相対位置iに関する情報を提供するために、各[x^emb_{t_i}, x^stat_{t_i}]入力に位置エンコーディングP_iトークンを追加します。最終的にx = [x^emb_{t_i}, x^stat_{t_i}] + P_iを得て、Transformerの層で処理されます。本研究では、P_{i,2j} = sin(i/10000^(2j/d))およびP_{i,2j+1} = cos(i/10000^(2j/d))を使用します。ここで、iはシーケンス内の位置、jは次元、dはモデルの次元で、我々の場合は142です。層は、Vaswani et al. (2017)で提示されたTransformerのエンコーダーと同様に、マルチヘッド注意変換とそれに続く全結合層で構成されています。

我々は自己注意層（すなわち、Q=K=V）、具体的には2つのヘッドを持つ2つの層を使用し、モデルの次元d_kは142に固定され、フィードフォワード次元は128に設定されています。

次に、Transformerの出力h_{t_0},...,h_{t_7}を特徴ごとに平均化して、シーケンスの最終表現を得ます。

#### A2. テンソルのTucker分解

多重線形特異値分解（SVD）は、テンソルAを小さなコアテンソルSと一組のユニタリ行列の積として表現します。コアテンソルのサイズ[k_1,...,k_N]で示されるものが、テンソルのランクを定義します。

正式には、多重線形分解は次のように表現できます：

A = S ×_1 U^(1) ×_2 ... ×_N U^(N)

ここで、A ∈ R^(I_1×...×I_N)、S ∈ R^(k_1×...×k_N)、U^(i) ∈ R^(I_i×k_i)

各U^(i)はユニタリ行列、すなわち、その共役転置がその逆であるU^(i)†U^(i) = U^(i)U^(i)† = Iで、モードnの積×_n Uは、テンソルA ∈ R^(I_1×...×I_N)と行列U ∈ R^(I_n×J_n)の乗算演算を示します。図A2は、3次元テンソルAに適用されたTucker分解の幾何学的表現を示しており、小さなコアテンソルSと投影マップU_i（i=1,2,3）に分解されます。

切り捨てられたSVDに類似して、コアテンソルSと対応するU^(i)を人為的に切り捨てることにより、テンソルAの次元性を削減できます。例えば、TCマップの4次元テンソルが与えられた場合、コアテンソルSの希望サイズのみを保持することにより、任意の希望ランクにテンソルを削減できます。例えば、TCテンソルデータをランク3×5×3×3に削減するために、まず特異値の降順を反映するようにSを多重線形SVDを実行し、次に最初の3×5×3×3エントリのみを保持することによりSを切り捨て、S'で示し、各U^(i)の最初の3列のみ保持し、U'^(i)で示します。

最後に、切り捨てられたコアテンソルS'をベクトルに平坦化し、XGBoostモデルを訓練するための抽出されたビジョン特徴として扱います。

#### A3. 実験の詳細

##### a. テスト方法論

我々は検証セットを使用してハイパーパラメータ調整を実行しました。次に、見つかったハイパーパラメータの最良の組み合わせを使用して、訓練セットと検証セットを組み合わせたものでモデルを再訓練しました。次に、テストセットでモデルのパフォーマンスを評価しました。

我々は、進路と強度予測の両方について、24時間リードタイムでNAおよびEPテストセットで得られたパフォーマンスを各方法で報告します。注記として、実際には、運用モデルが利用可能になるときにしばしば時間遅延があります。このような遅延は、統計モデルでは短いですが、高価な計算時間のため、力学モデルでは長くなります（最大数時間）。遅延時間の変動性のため、運用モデルとの比較ではこのような遅延を考慮していません。言い換えれば、すべてのモデルの時間遅延を無視し、すべての予測が瞬時に計算されると仮定してモデル結果を比較します。再解析マップデータの使用がリアルタイムでは不可能であることを認識していますが、我々の方法論の予測力の全体的な感覚を提供したいと考えています。セクション6でこのボトルネックについて議論しました。

##### b. HUML-ensembleの特定プロトコル

HUML-ensembleモデルについては、訓練セットのみ（すなわち、2011年までのデータ）で訓練されたHUMLモデル1-4を使用しました。次に、未見の検証セット（2012年から2015年）での予測と未見のテストセット（2016年から2019年）での予測を、アンサンブルの訓練データとテストデータとして使用しました。目標は、各モデルが未見のデータに関して他のモデルとどのように振る舞うかを理解することです。2012-2015年のHUML予測でElasticNetパラメータを交差検証し、見つかった最良のハイパーパラメータの組み合わせを使用して、以前と同じケースで最終的にテストしました。

##### c. ハイパーパラメータ調整

我々は、調整すべき5つのカテゴリのハイパーパラメータを区別します：(1) データ関連特徴、(2) ニューラルネットワーク関連特徴、(3) テンソル分解関連特徴、(4) 木ベースの方法関連特徴、(5) コンセンサスモデル関連特徴。

**1) データ関連特徴**

データ関連特徴には、再解析マップがカバーする領域（グリッドサイズ）と各予測に使用する過去のデータの時間ステップ数が含まれます。エンコーダー・デコーダーの24時間リードタイム予測パフォーマンスを各異なるハイパーパラメータ構成で比較することにより、これらの特徴を調整します。

我々は、8つの過去のタイムステップ（すなわち、過去21時間まで）を使用し、再解析マップのグリッドサイズを25×25度とすることが最良の組み合わせであることを発見しました。また、ビジョンデータと統計データを標準化すること、すなわち各特徴を平均0、標準偏差1に再スケーリングすることが、正規化すること、すなわち各特徴を[0,1]範囲に再スケーリングすることよりも良い結果をもたらすことを発見しました。

**2) ニューラルネットワーク関連特徴**

ニューラルネットワーク関連特徴には、最適化器、アーキテクチャ自体、訓練中のバッチサイズ、損失関数の正則化器が含まれます。

最良の結果は、バッチサイズ64、λ正則化項0.01、および前述のエンコーダー・デコーダーアーキテクチャを使用して得られました。最適化器については、強度予測には学習率10^-3、進路予測には学習率4×10^-4でAdam（Kingma and Ba 2014）を使用します。

**3) テンソル分解特徴**

テンソル分解アルゴリズムには、コアテンソルサイズの選択、すなわち元のテンソルの圧縮サイズが含まれます。元のテンソルサイズは8×9×25×25であることを思い出してください。経験的テストに基づいて、圧縮された再解析マップがXGBoostモデルの特徴として含まれる場合、3×5×3×3の小さなテンソルサイズを使用することで最良のパフォーマンスが得られることを発見しました。

**4) 木ベースの方法特徴**

経験的テストに基づいて、XGBoostモデルが決定木やランダムフォレスト、またはサポートベクターマシン、正則化線形回帰、多層パーセプトロンなどの他のML手法を一貫して上回ることを発見しました。XGBoostは訓練も高速で、これは大規模なハイパーパラメータ検索にとってかなりの利点です。したがって、予測のコアモデルとしてXGBoostを選択しました。

次に、各タスク（進路または強度）、海域（NAまたはEP）、または使用するデータソース（統計、さまざまな再解析マップ埋め込み）によって、ハイパーパラメータの最良の組み合わせに変動があります。しかし、これらの特定の特徴は通常重要であり、次の範囲で最良でした：木の最大深度（6から9の間）、推定器の数（100から300の間）、学習率（0.03から0.15の間）、サブサンプル（0.6から0.9の間）、木ごとの列サンプリング（0.7から1の間）、木ごとの最小子（1から5の間）。

**5) コンセンサスモデル関連特徴**

我々は、ElasticNet（Zou and Hastie 2005）、木ベースのモデル、多層パーセプトロン（MLP）をメタ学習器として含む、HUML予測に対するさまざまな種類のコンセンサスモデルをテストしました。MLPはElasticNetと同様のパフォーマンスを持っていましたが、解釈可能性と安定性が低いため、ElasticNetがHUML-ensembleの最強のアンサンブラー候補であり、我々の最終的な選択です。L1/L2比を0から1の間で調整し、正則化ペナルティを10^-4から10の間で調整します。

##### d. 指標

**1) ハバーサイン公式**

正式には、予測点と実際の点の1組の間のハバーサイン距離dは次のように計算されます：

d = 2R arcsin(√α)

ここで

α = sin²((φ̂ - φ)/2) + cos(φ̂)cos(φ)sin²((λ̂ - λ)/2)

ここで(φ, λ)は1つのデータポイントの実際の緯度と経度、(φ̂, λ̂)は予測された緯度と経度、Rは地球の半径で、平均半径6,371 kmと近似されます。

**2) スキル**

スキルは、標準またはベースラインに対する予測誤差の正規化を表します。我々は、（Cangialosi 2020）に従って予測fのスキルs_fを計算しました：

s_f(%) = 100 × (e_b - e_f) / e_b

ここで、e_bはベースラインモデルの誤差、e_fは評価される予測の誤差です。予測誤差がベースラインからの誤差よりも小さい場合、スキルは正です。

---

## 参考文献（References）

本論文で引用されたすべての文献は、元の論文に記載されています。主な参考文献には以下が含まれます：

- Aberson, S. D., 1998: Five-day tropical cyclone track forecasts in the north atlantic basin. Weather and Forecasting, 13 (4), 1005-1015.
- Alemany, S., J. Beltran, A. Perez, and S. Ganzfried, 2019: Predicting hurricane trajectories using a recurrent neural network. Proceedings of the AAAI Conference on Artificial Intelligence, Vol. 33, 468-475.
- Bahdanau, D., K. Cho, and Y. Bengio, 2015: Neural machine translation by jointly learning to align and translate. CoRR, abs/1409.0473.
- Bian, G.-F., G.-Z. Nie, and X. Qiu, 2021: How well is outer tropical cyclone size represented in the era5 reanalysis dataset? Atmospheric Research, 249, 105339.
- Biswas, M. K., and Coauthors, 2018: Hurricane weather research and forecasting (hwrf) model: 2018 scientific documentation. Developmental Testbed Center.
- Cangialosi, J. P., 2020: National hurricane center forecast verification report. National Hurricane Center.
- Chen, R., X. Wang, W. Zhang, X. Zhu, A. Li, and C. Yang, 2019: A hybrid cnn-lstm model for typhoon formation forecasting. GeoInformatica.
- Chen, T., and C. Guestrin, 2016: Xgboost: A scalable tree boosting system. Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining.
- Chung, J., Ç. Gülçehre, K. Cho, and Y. Bengio, 2014: Empirical evaluation of gated recurrent neural networks on sequence modeling. CoRR, abs/1412.3555.
- DeMaria, M., and J. Kaplan, 1994: A statistical hurricane intensity prediction scheme (ships) for the atlantic basin. Weather and Forecasting, 9 (2), 209-220.
- Gao, S., P. Zhao, B. Pan, Y. Li, M. Zhou, J. Xu, S. Zhong, and Z. Shi, 2018: A nowcasting model for the prediction of typhoon tracks based on a long short term memory neural network. Acta Oceanologica Sinica, 37, 8-12.
- Giard-Roisin, S., M. Yang, G. Charpiat, C. Kumler Bonfanti, B. Kégl, and C. Monteleoni, 2020: Tropical cyclone track forecasting using fused deep learning from aligned reanalysis data. Frontiers in Big Data, 3, 1.
- Goodfellow, I., Y. Bengio, and A. Courville, 2016: Deep Learning. The MIT Press.
- Grinsted, A., P. Ditlevsen, and J. H. Christensen, 2019: Normalized us hurricane damage estimates using area of total destruction, 1900-2018. Proceedings of the National Academy of Sciences, 116 (48), 23942-23946.
- Harper, B., J. Kepert, and J. Ginger, 2010: Guidelines for converting between various wind averaging periods in tropical cyclone conditions. WMO.
- Hersbach, H., and Coauthors, 2020: The era5 global reanalysis. Quarterly Journal of the Royal Meteorological Society, 146 (730), 1999-2049.
- Hinton, G., O. Vinyals, and J. Dean, 2015: Distilling the knowledge in a neural network. NIPS Deep Learning and Representation Learning Workshop.
- Kingma, D., and J. Ba, 2014: Adam: A method for stochastic optimization. International Conference on Learning Representations.
- Knapp, K. R., M. C. Kruk, D. H. Levinson, H. J. Diamond, and C. J. Neumann, 2010: The international best track archive for climate stewardship (ibtracs): Unifying tropical cyclone best track data. Bulletin of the American Meteorological Society, 91, 363-376.
- Vaswani, A., N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, L. u. Kaiser, and I. Polosukhin, 2017: Attention is all you need. Advances in Neural Information Processing Systems 30, 5998-6008.
- Yosinski, J., J. Clune, Y. Bengio, and H. Lipson, 2014: How transferable are features in deep neural networks? CoRR, abs/1411.1792.
- Zou, H., and T. Hastie, 2005: Regularization and variable selection via the elastic net. Journal of the Royal Statistical Society, Series B, 67, 301-320.

（その他の参考文献は省略されています。完全なリストについては元の論文を参照してください。）

---

**論文の要約**

本論文は、熱帯低気圧の強度と進路予測のための包括的な機械学習フレームワークHuricastを提示しています。深層学習エンコーダー・デコーダーアーキテクチャと勾配ブースティング木を組み合わせることで、複数のデータソース（統計データと再解析マップ）を効果的に統合しています。24時間リードタイムの予測において、現在の運用モデルと同等のパフォーマンスを達成し、数秒での高速計算を実現しています。この研究は、機械学習が熱帯低気圧予測の分野に重要な貢献をもたらす可能性を示しています。
