# 機械学習/物理ベースハイブリッドモデリングフレームワークによる熱帯低気圧の2週間予測

## 論文情報
- **著者**: Hao-Yan Liu, Zhe-Min Tan, Yuqing Wang, Jianping Tang, Masaki Satoh, Lili Lei, Jian-Feng Gu, Yi Zhang, Gao-Zhen Nie, Qi-Zhi Chen
- **所属**: 
  - 河海大学（中国）
  - 南京大学（中国）
  - ハワイ大学（米国）
  - 東京大学（日本）
  - その他複数の研究機関
- **ジャーナル**: Journal of Geophysical Research: Machine Learning and Computation
- **巻・号**: Volume 1, Issue 3, 2024
- **DOI**: 10.1029/2024JH000207
- **受理日**: 2024年7月8日
- **受領日**: 2024年3月20日

## 概要

本研究は、機械学習（ML）ベースのグローバル気象予測モデル（Pangu-Weather）と高解像度物理ベースの地域気象予測モデル（WRF）を統合した、熱帯低気圧（TC）の2週間予測のためのハイブリッドフレームワークを提案しています。

### 主要な成果
1. **2週間TC予測の実現**：従来の5日間予測を大幅に延長
2. **精度の向上**：
   - 進路誤差：グローバルNWPモデルと比較して59%削減
   - 強度誤差：グローバルNWPモデルと比較して32%削減
3. **実用性**：リアルタイム予測に適した設計

## 1. 研究背景

### 1.1 熱帯低気圧予測の重要性

**現状の課題**：
- ほとんどの業務予報機関は形成後5日以内の予測のみ
- 2週間先の予測は災害防止・軽減に極めて重要
- 週を超える予測は大きな不確実性を伴う

**サブシーズナル予測**：
- 2週間を超える予測はTC活動に焦点
- 個別TCの詳細な進路・強度・構造予測は含まれない

### 1.2 従来の予測手法の限界

#### グローバルNWPモデル
**過去数十年の進歩**：
- 5日間の進路予測誤差が大幅に削減
- 観測、データ同化、高解像度化、初期化技術の向上

**残された課題**：
- 強度予測の改善が困難
- 複雑な内部・外部プロセス
- 解像度不足によるTC内部構造の表現不足

#### 地域モデル
- グローバルモデルの出力を初期値・境界条件として使用
- 力学的ダウンスケーリング
- 大規模循環予測の質に強く依存
- スペクトラルナッジング（SN）技術で大規模流れを調整

### 1.3 機械学習の登場

**最近の機械学習ベース気象予測モデル**：
1. **Pangu-Weather** (Bi et al., 2023)
2. **Fuxi** (Chen et al., 2023)
3. **GraphCast** (Lam et al., 2023)
4. **FourCastNet** (Pathak et al., 2022)

**Panguモデルの特徴**：
- 中期気象予測で高い精度と効率
- 2018年の88個のTCで優れた進路予測
- 水平解像度25km → 小規模変動・内部構造の表現に限界

**本研究の着想**：
Panguモデルが大規模循環とTC進路予測に優れているなら、その利点を活かしつつ高解像度WRFモデルで強度・構造予測を強化できるのでは？

## 2. ハイブリッドML/物理ベースモデリングフレームワーク

### 2.1 フレームワークの概要

**3つの主要コンポーネント**：

#### 1. Panguモデルのダウンスケーリング
- **目的**：高解像度でのTC再現
- **方法**：WRFモデルでPangu予測結果をダウンスケール
- **プロセス**：
  - グローバルデータ（GFS/ERA5）→ Panguモデルで2週間予測
  - Pangu出力 → WRFモデルの側方境界条件
  - WRFモデルで高解像度2週間シミュレーション

#### 2. 大規模循環の調整
- **目的**：Panguモデルの優れた大規模循環予測を保持
- **方法**：スペクトラルナッジング（SN）
- **詳細**：
  - Pangu予測結果で大規模流れを調整
  - 1,000 km以上の波長の水平風のみを制約
  - ナッジング係数：0.0003
  - 6時間ごとに駆動場を更新

#### 3. 海面水温の更新
- **目的**：大気海洋相互作用の反映
- **方法**：海洋混合層（OML）モデル
- **設定**：
  - 初期OML深度：50 m
  - 水温減率：0.14 K/m
  - WRFモデルと統合

### 2.2 フレームワークの特徴

**計算効率**：
- Panguモデル予測：2時間未満（10 CPUコア）
- WRF予測：約15時間（192 CPUコア）
- 合計：約16時間で2週間予測完了

**実用性**：
- リアルタイム予測に適している
- 単一時点のグローバル解析/再解析データのみで動作可能

## 3. データ、TC、モデル、実験

### 3.1 使用データ

#### IBTrACS-WMO v4データセット
- **ソース**：国際ベストトラックアーカイブ
- **内容**：
  - TC中心の緯度・経度
  - 最大持続風速
  - 中心気圧
  - 最大風速半径（RMW）
- **時間間隔**：6時間ごと

#### TIGGEデータセット
- **評価用**：4つのグローバルNWPモデル
  - CMA（中国気象局）
  - CMC（カナダ気象センター）
  - NCEP（米国環境予測センター）
  - ECMWF（欧州中期予報センター）
- **解像度**：0.5°（最高解像度）
- **鉛直レベル**：1000, 925, 850, 700, 500, 300, 250, 200 hPa

#### ERA5再解析データとGFS解析データ
- **解像度**：0.25°
- **用途**：PanguモデルとWRFモデルの駆動

#### 衛星画像
- **ソース**：米国海軍研究所（NRL）
- **用途**：TC降水予測の比較

### 3.2 対象TC

**選定基準**（2018-2023年）：
- 2週間以上持続
- 熱帯低気圧レベルを一貫して維持（最大風速 > 17 m/s）
- 訓練期間（1979-2017年）外のケース

**選定されたTC（5個）**：
1. **Hector (2018)** - 東太平洋
2. **Florence (2018)** - 北大西洋
3. **Sam (2021)** - 北大西洋
4. **Surigae (2021)** - 西太平洋
5. **Freddy (2023)** - 南インド洋

**除外されたTC**：
- Dorian (2019) - 予測が困難すぎたため

### 3.3 Panguモデル

**出力変数**：
- ジオポテンシャル高度
- 比湿
- 気温
- u・v風成分（13レベル：1000-50 hPa）
- 2m気温、10m風、平均海面気圧

**ネットワーク構成**：
- **NW6**：6時間リードタイムネットワーク
  - 各24時間サイクル内の最初の6、12、18時間予測用
- **NW24**：24時間リードタイムネットワーク
  - 24時間ごとの予測用

**予測手順**（例：0000 UTC初期化）：
- 0600, 1200, 1800 UTC：NW6を使用
- 翌日0000 UTC：NW24を使用
- ネットワーク使用を最小化して予測誤差を削減

### 3.4 WRFモデル

**バージョン**：4.2

**ネスティング設定**：
| メッシュ | 格子間隔 | 格子点数 | 対象 |
|---------|---------|---------|------|
| D01 | 18 km | 可変 | 大規模環境循環 |
| D02 | 6 km | 271×271 | TC主循環 |
| D03 | 2 km | 271×271 | TC内部コア |

**鉛直レベル**：60層、50 hPaまで

**物理スキーム**：
- 微物理：WRF single-moment 6-class
- 放射：RRTMG短波・長波
- 境界層：YSU
- 陸面：Noah
- 積雲：Kain-Fritsch（D01のみ）

**その他の設定**：
- 海面上の運動量・熱フラックスパラメータ化
- 散逸加熱スキーム
- 強風に適用可能

### 3.5 実験設計

#### Panguモデル実験（2実験）
1. **Pangu**：ERA5データで初期化
2. **Pangu***：GFSデータで初期化

#### WRFモデル実験（4実験）

| 実験名 | 側方境界条件 | SST | スペクトラルナッジング |
|--------|------------|-----|---------------------|
| WRF-ERA5 | 6時間ERA5 | 6時間ERA5 | なし |
| WRF-ERA5-OML | 6時間ERA5 | OML | なし |
| WRF-Pangu-OML | 6時間Pangu結果 | OML | なし |
| WRF-Pangu-OML-SN | 6時間Pangu結果 | OML | 6時間Pangu結果 |

**初期化時刻**：
- 各TCが熱帯低気圧レベルに達した後の最初の0000または1200 UTC
- Freddyのみ例外（比較のため別の時刻）

## 4. TC予測の検証

### 4.1 Panguモデルの評価

#### 4.1.1 TCステアリングフローの予測

**計算方法**：
- 250-850 hPa間
- TC中心から3度（333 km）半径内
- ベストトラックTC中心に従って計算（公平な比較のため）

**結果（図2）**：
- **Pangu（ERA5初期化）**：
  - 最小のバイアスとRMSE
  - 速度、u成分、v成分すべてで最良
- **Pangu*（GFS初期化）**：
  - より大きな誤差
- **グローバルNWPモデル**：
  - CMA、CMC：u成分で正のバイアス
  - ECMWF、NCEP：異なるバイアスパターン

**結論**：
- PanguモデルはERA5初期化で最も優れたステアリングフロー予測
- TC進路予測の向上に寄与

#### 4.1.2 グローバルモデルでのTC予測

**進路予測（図3a）**：
- グローバルNWPモデル：リードタイムとともに誤差増加
- **Pangu & Pangu***：グローバルNWPより優れた性能
- **Pangu**：Pangu*よりわずかに良好（最後の2日間を除く）
- 結論：週を超える予測でPanguモデルが優位

**強度予測（図3c）**：
- すべてのグローバルモデルが強度を過小評価
- 強度誤差が非常に大きい（現行の5日間予測より悪い）
- Panguモデルの性能はグローバルNWPと同程度
- 結論：Panguモデルは強度予測で優位性なし

**RMW予測（図3e）**：
- すべてのグローバル予測で大きな誤差（>100 km）
- 11日以降：Panguモデルが若干小さい誤差
- 解像度0.25°ではRMWの正確な表現が困難

**まとめ**：
- Panguモデル：進路予測で優位
- 強度・構造予測：高解像度ダウンスケーリングが必要

### 4.2 フレームワークの評価

#### 4.2.1 全体的な性能

**WRF-ERA5とWRF-ERA5-OML**：
- 進路誤差：グローバルNWP・Panguよりわずかに減少
- 強度・RMW誤差：大幅に改善

**WRF-Pangu-OML**：
- 直接ダウンスケーリング
- 強度・構造予測は改善
- 進路予測への影響は限定的

**WRF-Pangu-OML-SN（提案フレームワーク）**：
- **最小誤差を実現**（図3）
- 2週間平均削減率：
  - 進路誤差：グローバルNWPより59%、Panguより2%、WRF-ERA5より32%削減
  - 強度誤差：グローバルNWPより32%、Panguより59%、WRF-ERA5より23%削減
- **7日間予測**：現行の5日間予測の335 km目標を達成
- 2週間全期間でTCを一貫して予測可能

#### 4.2.2 各コンポーネントの役割

**1. Panguモデルのダウンスケーリング**
- 比較：WRF-Pangu-OML vs. WRF-ERA5-OML
- 結果：同程度の性能
- 結論：Panguダウンスケーリングは効果的

**2. SST更新**
- 比較：WRF-ERA5 vs. WRF-ERA5-OML
- 結果：OMLモデルがわずかに良好
- 結論：OMLモデルは2週間TC予測に有効

**3. 大規模循環の調整**
- 比較：WRF-Pangu-OML vs. WRF-Pangu-OML-SN
- 結果：SNありで進路誤差が大幅に減少
- 機構：
  - PanguとWRF-Pangu-OML-SNの進路誤差が一致
  - TCステアリングフローの偏差を最小化
- 結論：Panguモデルの進路予測の強みを保持

**SNの効果に関する補足**：
- ERA5/GFS解析データ駆動SN：観測と一致した進路
- GFS予測場駆動SN：大規模循環の不正確さで進路誤差増加
- Pangu予測場：グローバルNWPより優れた大規模循環予測
- 結論：Panguモデル予測はSN駆動に最適

## 5. TC Freddy (2023)のケーススタディ

### 5.1 選定理由

**TC Freddyの特徴**：
- 史上最長寿命のTC
- 複雑な相互作用：
  - マスカレーン高気圧
  - TC Dingani
  - 渦サイズの変化
- 予測が困難

### 5.2 進路と強度

#### グローバルNWPモデルの予測（図4a, 4b）
- 4モデルで進路予測が大きく異なる
- 強度を一貫して過小評価
- 粗い解像度が原因

#### Panguモデルの予測（図4c, 4d）
- **進路予測**：
  - 14日間予測がベストトラックと密接に一致
  - 7日目：193 km、14日目：607 km
  - グローバルNWP平均：7日目665 km、14日目6,837 km
- **強度予測**：
  - 約20 m/s程度で推移
  - 初期渦の強度に関わらず一定
  - 過小評価は継続

#### WRF実験の予測（図4e, 4f）
**WRF-ERA5、WRF-ERA5-OML、WRF-Pangu-OML**：
- 顕著な南方移動と早期の弱化
- 最初の週：強度予測が大幅に改善
- 7日以降：大きな進路誤差に伴い強度誤差も増加
- 原因：誤った進路により強い鉛直シアと低SST域に曝露

**WRF-Pangu-OML-SN（提案フレームワーク）**：
- 進路予測が大幅に改善
- 観測進路と2週間にわたって密接に一致
- 強度予測もベストトラックに追従
- 結論：正確な進路予測がTC強度予測をさらに向上

### 5.3 環境循環

**9日予測時の850 hPaジオポテンシャル高度分析（図5）**：

#### ERA5データ（図5a）
- Freddy：中央インド洋上
- Dingani：Freddyの南西約2,000 km
- マスカレーン高気圧：南側、東風のステアリングフロー提供

#### グローバルNWP予測（図5b-5e）
- マスカレーン高気圧の分布・強度が大きく異なる
- Dinganiの位置・強度も異なる
- ERA5との大きな乖離

#### Pangu予測（図5f, 5g）
- 差異が大幅に軽減
- **Pangu（ERA5初期化）**：ERA5に最も近い
- Dinganiの強度：両方とも弱い

#### WRF実験（図5h-5j）
**WRF-ERA5、WRF-ERA5-OML、WRF-Pangu-OML**：
- マスカレーン高気圧：Freddyの東側で過度に強い
- Dingani：観測より北で、Freddyに近い
- 予期しないTC出現：ERA5/ベストトラックと不一致
- 結果：Freddyの遅い移動速度と南方移動

**時間スケール**：
- 1週間を超える
- 初期条件の記憶が失われる時期
- 大規模場の正確な表現が重要

#### WRF-Pangu-OML-SN（図5k）
- Pangu予測と同様のパターン
- フレームワークのSNコンポーネントが大規模流れの偏差を最小化
- Freddy、Dingani両方の進路がPangu予測と一致

### 5.4 渦構造

**軸対称半径・接線風（図6）**：

#### ERA5（図6a）
- 典型的な接線風プロファイル
- RMW：約60 km
- 境界層流入・上層流出を特徴

#### ECMWF予測（図6b）
- ERA5に類似
- ただし他の3つのグローバルNWP・2つのPangu予測では：

#### グローバルNWP・Pangu予測（図6c-6g）
- 接線風・半径風が著しく弱い
- 緩く組織化された内部コア構造
- 粗い解像度がTC構造を十分に解像できない

#### WRF実験（図6h-6k）
**すべてのWRF実験**：
- 接線風が強化
- RMW：約40 km（ベストトラックの10 kmに近い）
- 境界層流入・上層流出が強化
- 外側に傾いたアイウォール構造

**WRF-Pangu-OML-SN（図6k）**：
- 最も良好に構築されたTC渦
- Freddyがカテゴリー5ハリケーン状態に接近時
- 正確な進路予測により正しい環境流の中で発達
- コアプロセスの効果的な捕捉にも起因

### 5.5 雲分布

**黒体輝度温度の比較（図7）**：

#### 観測（図7a）
- 雲特徴の直径：約600 km

#### WRF-ERA5（図7b）
- 雲特徴のサイズ：観測より大幅に小さい

#### WRF-ERA5-OML、WRF-Pangu-OML（図7c, 7d）
- 雲分布に明確な違い
- 不正確な進路・強度予測に起因

#### WRF-Pangu-OML-SN（図7e）
- サイズ・パターンが観測と同等
- TC降水分布予測の改善を示唆

### 5.6 三角関係パラダイム

**TC進路・強度・構造の関係**（Tan et al., 2022）：

1. **進路 → 環境条件**：
   - 鉛直シア、SST決定
   - 多スケールシステム・下層面との相互作用・エネルギー交換を通じて強度・構造に影響

2. **強度・構造 → 進路**：
   - 転向タイミング・消散に影響

3. **強度 ⇄ 構造**：
   - 強度が循環パターンを形成
   - 構造が強度変化率に影響

**本研究での実証**：
- 正確な進路予測が強度・構造予測を向上
- 相関、相互作用、誤差伝播の理解に重要

## 6. 結論

### 6.1 主要な成果

1. **ハイブリッドフレームワークの提案**：
   - ML（Pangu）+ 物理ベース（WRF）の統合
   - 2週間TC予測の実現

2. **優れた予測性能**：
   - グローバルNWPモデルを大幅に上回る
   - 7日間予測：現行5日間予測の目標達成
   - 2週間全期間で一貫したTC予測

3. **計算効率**：
   - 約16時間で2週間予測完了（192 CPUコア）
   - 中程度の計算資源で実現可能

4. **構造・降水予測の改善**：
   - TC内部構造の表現向上
   - 雲分布・降水予測の改善

### 6.2 フレームワークの優位性の要因

**Panguモデルの強み**：
- 大規模循環の正確な予測
- TC進路予測の優位性

**スペクトラルナッジング**：
- Panguモデルの利点を高解像度WRFシミュレーションに活用
- 大規模ステアリングフローの保持

**WRFモデル**：
- 高解像度でTC内部過程を解像
- 強度・構造予測の向上

**OMLモデル**：
- 大気海洋相互作用の反映
- SSTの現実的な更新

**三角関係の活用**：
- 進路・強度・構造の相関理解
- 誤差伝播の理解と制御

### 6.3 限界と今後の展望

#### 限界
1. **限られたケース数**：
   - 5個のTCのみで評価
   - より多くのケースでの検証が必要

2. **初期条件への感度**：
   - Pangu予測は初期条件に敏感
   - 改善の余地あり

#### 今後の研究方向

1. **ケース数の拡大**：
   - より多くのTCで予測
   - 様々な初期時刻での予測
   - 2週間に限定しない予測期間

2. **初期条件の改善**：
   - TC力学的初期化スキームの導入
   - 初期条件の質の向上

3. **アンサンブル予測**：
   - Panguモデルのアンサンブル予測
   - 予測可能性の向上

4. **継続的な改善**：
   - より長期・多様なデータでPangu訓練
   - フレームワークの性能向上

5. **他のモデルへの拡張**：
   - 他のMLベースモデル（Fuxi、GraphCast等）
   - 他の物理ベースモデルとの統合

6. **多様な気象現象への応用**：
   - 多スケールプロセスの表現改善
   - 他の極端気象イベントへの適用
   - 水文気象災害への応用

### 6.4 意義と影響

**科学的意義**：
- ML/物理ベースハイブリッドアプローチの有効性実証
- TC予測可能性の理解向上
- 三角関係パラダイムの実証

**実用的意義**：
- 現行5日間予測から2週間への延長
- 災害準備時間の大幅な延長
- 資源配分・事前対策の改善
- TC影響地域での防災・減災への貢献

**技術的貢献**：
- ML/物理モデル統合の成功例
- リアルタイム予測可能なフレームワーク
- 中程度の計算資源で実現可能

## 7. データとコードの公開

### データ
1. **IBTrACS-WMO v4**：
   - https://www.ncei.noaa.gov/data/international-best-track-archive-for-climate-stewardship-ibtracs/

2. **TIGGEデータセット**：
   - https://apps.ecmwf.int/datasets/data/tigge/

3. **NCEP GFS解析**：
   - National Centers for Environmental Prediction (2015
