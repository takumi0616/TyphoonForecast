# 深層学習モデルに基づく北西太平洋における熱帯低気圧進路予測

## 論文情報
- **著者**: Liang Wang, Bingcheng Wan, Shaohui Zhou, Haofei Sun, Zhiqiu Gao
- **所属**: 
  - 中国科学院大気物理研究所
  - 南京信息工程大学
- **ジャーナル**: Geoscientific Model Development (GMD), Vol. 16, 2167-2179, 2023
- **DOI**: 10.5194/gmd-16-2167-2023
- **受理日**: 2023年3月27日
- **出版日**: 2023年4月20日

## 概要

本研究は、深層学習技術に基づいて北西太平洋における熱帯低気圧（TC）の進路を予測する新しい手法を提案しています。過去24時間の軌跡データのみを入力として使用し、6～72時間先の進路を予測します。

### 主要な成果
1. **GRU_CNNモデル**の開発：GRU（Gated Recurrent Unit）とCNN（Convolutional Neural Network）を組み合わせた新しいモデル
2. **高精度な短期予測**：6時間予測の平均距離誤差17.22 km、12時間予測で43.90 km
3. **環境要因の統合**：ステアリングフロー、海面水温、ジオポテンシャル高度を追加入力として使用

## 1. 研究背景

### 1.1 熱帯低気圧の重要性
- 北西太平洋は世界で最もTCが活発な海域（全世界の1/3以上を生成）
- 中国は18,000 km以上の海岸線を持ち、TCの影響を最も受ける国の一つ
- 強風、豪雨、高潮による深刻な災害
- 地球温暖化により今後さらにTC強度が増加する見込み

### 1.2 従来の予測手法

#### 数値気象予測（NWP）
- **主要モデル**：
  - GRAPES-TYM（中国気象局）
  - GFS（NCEP）
  - IFS（ECMWF）
- **利点**：精度の高い予測が可能
- **欠点**：
  - 高性能コンピュータが必要
  - 精密な初期条件が必要

#### 統計モデル
- **主要モデル**：
  - NHC64, NHC67, CLIPER（気候持続性因子）
  - NHC72（NHC67とCLIPERの組み合わせ）
- **欠点**：
  - 線形回帰モデルが主流
  - 非線形問題への対応が困難
  - 手動の特徴量選択では精度向上が限定的

### 1.3 深層学習の応用

#### 従来の深層学習アプローチ
1. **RNN系モデル**：
   - Moradi Kordmahalleh et al. (2015): スパースRNN
   - Gao et al. (2018): LSTM（24時間予測誤差105 km）
   - Alemany et al. (2018): グリッドベースRNN

2. **CNN系モデル**：
   - Kim et al. (2018): ConvLSTM（精度78.99%改善）
   - Giffard-Roisin et al. (2020): CNN+風場データ（6時間予測誤差32.9 km）

3. **マルチモーダルアプローチ**：
   - Zhang et al. (2018): MNN（Matrix Neural Network）
   - Ruttgers et al. (2019): GAN+衛星画像
   - Liu et al. (2022): DBFNet（双分岐時空間融合ネットワーク）

## 2. データと前処理

### 2.1 データソース

#### 2.1.1 IBTrACS軌跡データ
- **データセット**: International Best Track Archive for Climate Stewardship
- **期間**: 1979-2021年
- **対象海域**: 北西太平洋のみ
- **時間間隔**: 3時間ごと
- **記録項目**：
  - 緯度、経度
  - 中心気圧
  - 最大風速
  - 移動方向と速度

#### 19個の移動特性
1. 過去24時間の経度・緯度
2. 中心気圧
3. 最大風速
4. 子午線方向の移動速度
5. 東西方向の移動速度
6. 移動方向と速度
7. 現在時刻との差分値
8. 過去24時間と現在時刻間で形成される角度
9. 東西方向の距離
10. 子午線方向の距離
11. 緯度に対応するコリオリパラメータ

#### 2.1.2 ERA5再解析データ
- **提供元**: 欧州中期予報センター（ECMWF）
- **空間解像度**: 1° × 1°
- **時間解像度**: 過去24時間のデータ

**風場データ（u, v成分）**：
- 気圧面：300, 500, 700, 850 hPa
- TC中心から東西・南北方向に各10°拡張
- グリッドサイズ：21×21

**海面水温（SST）**：
- TC中心から東西・南北方向に各10°拡張
- グリッドサイズ：21×21

**ジオポテンシャル高度**：
- 気圧面：300, 500, 700 hPa
- TC中心から：北+35°、南-10°、西-40°、東+40°
- グリッドサイズ：46×81

### 2.2 データ前処理

#### 2.2.1 渦除去（Devortexing）
TC自体の循環と周囲の気流を分離してステアリングフローを取得する必要があります。

**方法**：
1. 渦度と発散を修正してベロシティストリーム関数とポテンシャル関数を解く
2. 修正後の速度場を無回転風と無発散風に分解

**数式**：
```
∇²ψ = ζ           (流線関数)
v_ψ = k̂ × ∇ψ    (非発散風)

∇²χ = δ           (速度ポテンシャル)
v_χ = ∇χ          (非渦度風)

v_env(x,y,p) = V(x,y,p) - v_χ(x,y,p) - v_ψ(x,y,p)
```

**処理手順**：
- 渦半径外の渦度をゼロに設定
- 水平境界でψ=0を指定
- 反復緩和法で流線関数を解く

#### 2.2.2 ランダムフォレストによる特徴選択
- **目的**：特徴量の重要度を評価し、最適な特徴量の組み合わせを選択
- **手法**：OOB（Out-of-Bag）サンプルを用いた精度評価
- **結果**：重要度順に最初の11個の特徴量が最適

**OOBスコアによる特徴選択**：
- 決定木の数N = 100
- ブートストラップサンプリングを使用
- 重要度順に11個の特徴量を選択することでOOBスコアが最大化

## 3. 実験設計

### 3.1 実験設定

#### データセット分割
- **訓練セット**: 1979-2014年（90%訓練、10%検証）
- **検証セット**: 2015-2018年
- **テストセット**: 2019-2021年（49個のTC、2,095サンプル）

#### 予測目標
- 現在のTC中心を基準点として、6～72時間先の経度・緯度の変化を予測
- 最大予測時間が72時間、入力シーケンス長が24時間
- 96時間以上持続するTCを抽出

#### ハイパーパラメータ
- **バッチサイズ**: 64
- **エポック数**: 100
- **隠れ層のニューロン数**: 128（実験により決定）
- **早期停止**: 過学習防止のため実装

### 3.2 モデルアーキテクチャ

#### 3.2.1 リカレントニューラルネットワーク（RNN）

**標準RNN**：
- 自己フィードバックを持つニューロンで任意長のシーケンスを処理
- **問題点**：長期依存性の処理が困難、勾配消失問題

**LSTM（Long Short-Term Memory）**：
- Hochreiter & Schmidhuber (1997)により提案
- 勾配消失・爆発問題を回避
- ゲート機構により長期記憶を保持

**GRU（Gated Recurrent Unit）**：
- Cho et al. (2014)により提案
- LSTMの改良版
- より高速な収束速度
- LSTMと同等の精度を維持

#### 3.2.2 畳み込みニューラルネットワーク（CNN）

**基本構造**：
- 畳み込みカーネルを平行移動して特徴を自動抽出
- 局所接続と重み共有でパラメータ数を削減

**発展**：
1. **LeNet** (Lecun et al., 1998): 手書き文字認識
   - 平均プーリング、tanh活性化関数
   
2. **AlexNet** (Krizhevsky et al., 2012): ImageNet優勝
   - ReLU活性化関数（勾配消失問題を解決）
   - 最大プーリング（平均プーリングのぼかし効果を回避）
   
3. **バッチ正規化** (Ioffe & Szegedy, 2015)
   - 深層ネットワークの訓練を加速
   - 勾配爆発・消失問題を緩和

#### 3.2.3 GRU_CNNモデル

**モデル構造**：
4つの情報源を統合した新しいモデル（Kerasフレームワークを使用）

**1. 風場処理ブランチ（u, v成分）**：
```
入力: 21×21×4層（300, 500, 700, 850 hPa）
Conv層: カーネルサイズ7×7, ストライド2, チャンネル8
MaxPool層: サイズ4×4, ストライド4
Flatten層: 3D→1Dベクトル変換
Dense層: 64→128→32ニューロン
```

**2. SST処理ブランチ**：
```
入力: 21×21
Conv層: カーネルサイズ7×7, ストライド2, チャンネル1
MaxPool層: サイズ4×4, ストライド4
Flatten層: 3D→1Dベクトル変換
Dense層: 32→128→32ニューロン
```

**3. ジオポテンシャル高度処理ブランチ**：
```
入力: 46×81×3層（300, 500, 700 hPa）
Conv層: カーネルサイズ14×25, ストライド4, チャンネル3
MaxPool層: サイズ5×11, ストライド4
Flatten層: 3D→1Dベクトル変換
Dense層: 64→128→32ニューロン
```

**4. 軌跡データ処理ブランチ（GRU）**：
```
入力: 8タイムステップ×11特徴量
GRU層1: 8×11→8×128
GRU層2: 8×128→128
Dense層: 128→32ニューロン
```

**統合部**：
```
Concat層: 全ブランチの出力を結合（128次元）
最終Dense層: 出力座標（経度・緯度の変化）
```

**その他の設定**：
- **活性化関数**: ReLU
- **正規化**: バッチ正規化（全隠れ層）
- **最適化**: Adamオプティマイザ
- **損失関数**: RMSE（予測値と実際値の二乗平均平方根誤差）

## 4. 結果

### 4.1 RNN系モデルの性能比較

#### テストセットでのRMSE値（表2より）

**緯度予測**：
| 予測時間 | RNN | LSTM | GRU |
|---------|-----|------|-----|
| 6時間 | 0.166 | 0.149 | **0.149** |
| 12時間 | 0.411 | 0.389 | **0.387** |
| 18時間 | 0.685 | 0.661 | **0.653** |
| 24時間 | 0.988 | 0.965 | **0.951** |
| 48時間 | 2.481 | 2.473 | **2.446** |
| 72時間 | 4.207 | 4.154 | **4.143** |

**経度予測**：
| 予測時間 | RNN | LSTM | GRU |
|---------|-----|------|-----|
| 6時間 | 0.176 | 0.169 | **0.167** |
| 12時間 | 0.461 | 0.456 | **0.457** |
| 24時間 | 1.178 | 1.215 | **1.185** |
| 48時間 | 3.534 | 3.346 | **3.325** |
| 72時間 | 6.157 | 5.989 | **5.969** |

**結論**：
- GRUとLSTMは標準RNNを大幅に上回る
- GRUが全予測時間で最良の性能
- GRUはLSTMより訓練速度が速く、同等以上の精度

### 4.2 複数モデルとの性能比較

#### 平均絶対距離誤差（km）の比較

| モデル | 6h | 12h | 18h | 24h | 48h | 72h |
|--------|-----|-----|-----|-----|-----|-----|
| CLIPER | - | - | - | 213 | 442 | 659 |
| BP | 23.86 | 59.58 | 101.01 | 146.91 | 377.64 | 634.42 |
| RNN | 21.43 | 55.46 | 94.59 | 138.09 | 373.12 | 625.17 |
| LSTM | 19.65 | 52.38 | 91.76 | 136.05 | 360.32 | 614.76 |
| GRU | 19.51 | 52.6 | 91.25 | 134.73 | 357.25 | 607.44 |
| NMSTN | 27.52 | 59.09 | - | 139.18 | 336.16 | 544.16 |
| **GRU_CNN** | **17.22** | **43.9** | **72.74** | **106.16** | **281.52** | **502.71** |

**主要な発見**：
1. **短期予測の優位性**：
   - 6時間予測：17.22 km（中国気象局CMOの27.57 kmより優れる）
   - 12時間予測：43.9 km（CMOの59.09 kmより優れる）

2. **長期予測の改善**：
   - CNNなしのモデルと比較して大幅な精度向上
   - 48時間で281.52 km、72時間で502.71 km

3. **誤差の傾向**：
   - 最大距離誤差：48時間で500 km以上、72時間で1000 km以上（RNN系のみ）
   - GRU_CNNは最大誤差と平均誤差の両方を大幅に削減

### 4.3 予測結果の分析

#### 散布図分析（図4）
- **風速と精度の関係**：風速が高い（TC強度が強い）ほど予測精度が向上
- **方向バイアス**：
  - 高緯度・高経度（北西方向）への移動時
  - 予測値が実際値より低くなる傾向

#### 誤差分布
- 予測値と実際値の対角線からの距離が予測誤差を表す
- 予測時間の増加とともに誤差が拡大
- TC強度が強いほど予測精度が向上

### 4.4 環境要因の影響分析

#### 異なる環境入力の比較（表4）

| モデル | 6h | 12h | 18h | 24h | 48h | 72h |
|--------|-----|-----|-----|-----|-----|-----|
| GRU+SST | 19.35 | 52.37 | 92.25 | 137.78 | 358.25 | 588.08 |
| GRU+pressure | 16.15 | 44.22 | 76.16 | 112.93 | 306.03 | 577.86 |
| **GRU+UV** | **16.94** | **43.74** | **72.81** | **106.63** | **302.76** | **524.88** |
| GRU_CNN | 17.22 | 43.9 | 72.74 | 106.16 | 281.52 | 502.71 |

**主要な結論**：

1. **ステアリングフロー（UV）の重要性**：
   - 最も効果的な単一環境要因
   - 特に24時間以内の短期予測で顕著
   - GRU+UVだけでGRU_CNNに近い精度

2. **ジオポテンシャル高度（pressure）**：
   - 2番目に効果的
   - 中期予測（12-24時間）で有効

3. **海面水温（SST）**：
   - 単独では効果が限定的
   - 長期予測（48-72時間）で徐々に影響が増加

4. **統合効果**：
   - 3つの環境要因を統合することで最良の結果
   - 特に48-72時間の長期予測で改善が顕著

### 4.5 ケーススタディ

#### TC FAXAI (2019年)
- 北西方向への突然のターン
- 平均距離誤差：91.35 km（ターン付近）
- 6時間予測は実際の経路とほぼ一致
- 24時間予測で若干の偏差

#### TC MITAG (2019年)
- 2回の進路変更（北方向、次に北西方向）
- 1回目のターン：平均誤差127.02 km
- 2回目のターン：平均誤差121.91 km
- ターン付近での予測に大きな偏差なし

#### TC IN-FA (2021年)
- 2つの主要な経路変更
- 平均誤差：84.27 kmと82.37 km
- 異常な経路変化（同じ場所を横切る）で大きな誤差が発生

**全体的な観察**：
- 突然の北方向・北西方向への転換を正確に予測可能
- 異常な軌道変化では誤差が増大
- 総合平均絶対距離誤差を低下させる要因

## 5. 結論と考察

### 5.1 主要な成果

1. **特徴量選択**：
   - ランダムフォレストにより19個中11個の重要特徴量を選択
   - データ冗長性を削減し、モデルの複雑さを軽減

2. **モデル比較**：
   - 3種類のRNN（RNN、LSTM、GRU）を評価
   - GRUが軌道予測において最良の性能

3. **GRU_CNNモデル**：
   - GRUとCNNを組み合わせた新しいアーキテクチャ
   - 前処理された気象環境データ（渦除去後のステアリングフロー）を統合
   - 従来の単一深層学習手法より優れた予測結果

4. **実用性**：
   - 新しいTCが海上で発生した際、数秒以内に予測軌道を提供
   - 12時間以内の短期予測でCMOより良好な結果
   - 6時間予測：17.22 km、12時間予測：43.9 km

### 5.2 限界と課題

1. **長期予測の精度低下**：
   - 24時間を超えると精度が低下
   - 48時間以降は大きな誤差が発生する可能性

2. **異常軌道への対応**：
   - 予測不可能な急激な方向転換には対応困難
   - 同じ場所を横切るような異常な軌道で大きな誤差

3. **総観解析の欠如**：
   - 本研究では総観解析を考慮していない
   - これが異常軌道での大きな誤差の原因の可能性

### 5.3 今後の展望

1. **データ統合の拡張**：
   - より多くの気象データの統合
   - データベースの継続的な拡張
   - より価値のある特徴量の抽出

2. **予測変数の追加**：
   - TC強度（中心気圧、最大風速）
   - 降水量
   - 風速分布
   - その他の有用な情報の予測

3. **モデルの柔軟性**：
   - 深層学習モデルは柔軟で拡張が容易
   - 将来的により多くのデータを統合可能
   - 予測精度のさらなる向上が期待

4. **リアルタイム運用**：
   - 計算速度の高速化
   - オペレーショナル予測システムへの統合
   - より長時間の予測精度向上

### 5.4 技術的貢献

1. **ハイブリッドアーキテクチャ**：
   - GRUによる時系列処理
   - CNNによる空間特徴抽出
   - 複数データソースの効果的な統合

2. **環境要因の定量的評価**：
   - ステアリングフローの重要性を実証
   - SST、ジオポテンシャル高度の寄与を分析
   - 予測時間帯による環境要因の影響変化を明確化

3. **実用的な予測精度**：
   - 短期予測で業務予測（CMO）を上回る精度
   - 計算時間が数秒と高速
   - 災害対策に有用な情報提供

## 6. データとコードの公開

### コード
- **リポジトリ**: Zenodo
- **DOI**: 10.5281/zenodo.7454324
- **URL**: https://doi.org/10.5281/zenodo.7454324

### データソース
1. **IBTrACSデータ**：
   - https://www.ncei.noaa.gov/data/international-best-track-archive-for-climate-stewardship-ibtracs/

2. **ERA5再解析データ**：
   - Copernicus Climate Data Store
   - https://cds.climate.copernicus.eu

## 7. 謝辞

本研究は以下の支援を受けています：
- 中国科学技術部国家重点研究開発プログラム（助成番号：2018YFC1506405）
- 中国国家自然科学基金（助成番号：42175082、42222503）

## まとめ

本論文は、深層学習技術を用いた北西太平洋における熱帯低気圧進路予測の新しいアプローチを提示しました。GRUとCNNを組み合わせたハイブリッドモデル（GRU_CNN）により、従来の手法を上回る予測精度を実現しました。特に、6時間予測で17.22 km、12時間予測で43.90 kmという高精度を達成し、中国気象局の業務予測を上回りました。

ステアリングフローが短期予測に最も重要であり、海面水温とジオポテンシャル高度は長期予測で徐々に影響を増すことが明らかになりました。本モデルは新しいTCの発生時に数秒以内に予測を提供でき、実用的な災害対策ツールとしての可能性を示しています。

今後、より多くの気象データの統合、TC強度や降水量などの追加予測変数の実装により、さらなる精度向上が期待されます。
