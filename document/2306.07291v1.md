# ERA5再解析データを用いた機械学習アンサンブルアプローチによる熱帯低気圧検出

## 論文情報
- **著者**: Gabriele Accarino, Davide Donno, Francesco Immorlano, Donatello Elia, Giovanni Aloisio
- **所属**: Centro Euro-Mediterraneo sui Cambiamenti Climatici (CMCC), University of Salento
- **ジャーナル**: Journal of Advances in Modeling Earth Systems
- **arXiv**: 2306.07291v1 [physics.ao-ph]
- **日付**: 2023年6月7日

## 概要

本研究は、ERA5再解析データとIBTrACS（International Best Track Archive for Climate Stewardship）記録を用いた機械学習（ML）ベースの熱帯低気圧（TC）検出アプローチを提案しています。

### 主要なポイント
1. ERA5再解析データとIBTrACS記録を使用したML基盤のTC検出手法
2. 訓練に使用したカテゴリより低いTCカテゴリも正確に検出可能
3. アンサンブルアプローチにより、単一モデルよりもTC位置特定精度が向上

## 1. 研究背景

### 熱帯低気圧の重要性
- 毎年平均90個の熱帯低気圧が世界中で発生
- 地球温暖化により、より強力で大規模かつ破壊的になっている
- 過去50年間で：
  - 1,942件の災害
  - 約1.4兆米ドルの経済損失
  - 約800万人の死者

### 従来の検出手法の課題
- **決定論的トラッキングスキーム**：主観的な閾値に依存
  - 物理ベース手法
  - 動力学ベース手法（TRACK、OWZ等）
- **問題点**：
  - 人間の専門知識に依存した主観的閾値
  - 地理的領域やTCカテゴリへの依存性
  - 他の状況への汎化の困難さ

### 機械学習の利点
- 主観的な閾値を必要としない
- 気候ドライバーとTC中心位置間のマッピングを学習
- 決定論的手法を補完できる

## 2. 研究手法

### 2.1 データソース

#### IBTrACS（熱帯低気圧最良経路データ）
- **期間**: 1980-2019年（現代時代として選択）
- **時間解像度**: 6時間ごと
- **空間解像度**: 0.1° (~10km)
- **対象領域**: 北太平洋と北大西洋の統合領域（100-320°E, 0-70°N）
- **選択基準**：
  - トラックタイプが「main」のみ
  - 性質が熱帯性低気圧（TS）、温帯低気圧（ET）、亜熱帯低気圧（SS）のもの

#### ERA5再解析データ
- **空間解像度**: 0.25° × 0.25° (~27km × 27km)
- **時間解像度**: 6時間ごと（00:00, 06:00, 12:00, 18:00）
- **グリッドサイズ**: 280×880ピクセル

**使用された6つの気候変数**：
1. 平均海面気圧（msl）[Pa]
2. 前処理以降の10m突風（fg10）[m/s]
3. 瞬間10m突風（i10fg）[m/s]
4. 850 mbでの相対渦度（vo850）[s⁻¹]
5. 300 mbでの気温（t300）[K]
6. 500 mbでの気温（t500）[K]

### 2.2 データ処理

#### パッチ生成とラベリング
- ERA5マップ（280×880ピクセル）を7×22の非重複パッチに分割
- 各パッチサイズ：40×40ピクセル
- 6つの気候ドライバーをスタック：40×40×6の次元
- **ポジティブパッチ**：TCを含むパッチ
- **ネガティブパッチ**：TCを含まないパッチ（[-1, -1]でラベル付け）

#### データセット構築
**訓練セット**：
- 各10年間から2年間をテスト用に選択（1983, 1984, 1993, 1994, 2003, 2004, 2013, 2014）
- 残りの年を訓練用に使用
- ポジティブサンプル：55,639個
- ネガティブサンプル：212,679個
- 不均衡比：20%がTCを含む

**データ拡張**：
- 左右反転
- 上下反転
- 180°回転

**テストセット**：
- ネガティブパッチ：967,513個
- ポジティブパッチ：14,149個
- 不均衡比：1.46%がTCを含む

### 2.3 ニューラルネットワークアーキテクチャ

#### VGGライクアーキテクチャ
- **エンコーダ部**：
  - 畳み込み層とマックスプーリング層の連続
  - 高さと幅を減少させながら深さを増加
  - ボトルネック層で低次元表現を生成

- **デコーダ部**：
  - 全結合層の連続
  - TC中心の行-列座標を出力

#### モデルバリエーション
1. **VGG V1, V2, V3**：複雑度が異なる
2. **VGG V4**：カスタマイズされた畳み込み層
   - Conv + Gaussian Noise（オプション）
   - Batch Normalization（オプション）
   - Dropout（オプション）
   - Leaky ReLU活性化関数

#### 訓練設定
- **エポック数**: 500
- **バッチサイズ**: 8,192パッチ
- **オプティマイザ**: Adam（学習率：1e⁻⁴）
- **検証セット**: 訓練データの25%

#### 損失関数
1. **MAE（平均絶対誤差）**：実座標と予測座標間
2. **CCL（Cyclone Classification Localization）損失**：
   - MAE + BCE（Binary Cross Entropy）+ L2距離の線形結合
   - 分類誤差と位置特定誤差を同時に最小化

### 2.4 評価指標

#### 分類指標
- False Positives (FP)
- True Positives (TP)
- False Negatives (FN)
- True Negatives (TN)
- 適合率（Precision）
- 再現率（Recall）

#### 位置特定指標
- 実際と予測のTC中心座標間のユークリッド距離（TPのみ）

### 2.5 アンサンブル手法

#### コンセンサスメカニズム
1. 13個の異なるハイパーパラメータ設定でモデルを訓練
2. 各パッチに対して、最低m個（m=7）のモデルがポジティブと判定した場合のみTCとして扱う
3. IQR（四分位範囲）法で外れ値を除外
4. 残りのモデルの予測を平均してTC中心を推定

#### IQR法
外れ値の定義：
```
x < Q₁ - 1.5×IQR  または  x > Q₃ + 1.5×IQR
```
- Q₁：第1四分位数
- Q₃：第3四分位数
- IQR = Q₃ - Q₁

## 3. 結果

### 3.1 個別モデルの性能

**位置特定精度**（ユークリッド距離、km）：
- VGG V1（モデル#1）：128.84 km
- VGG V4（モデル#4）：116.08 km（最良）
- VGG V4（カーネルサイズ5）：116.38 km

**分類性能のトレードオフ**：
- FN率が低い → FP率が高い
- 極端気象事象（EWE）の検出では、FN（見逃し）よりFP（誤警報）の方が望ましい

### 3.2 アンサンブルの性能

#### 不均衡テストセット
- **平均ユークリッド距離**: 118.46 km
- IQR適用前：127.5 km → **9 kmの改善**
- **FP率**: 5.38%
- **FN率**: 10.71%
- **再現率**: 89.29%
- **適合率**: 19.53%（不均衡データのため低い）

#### バランステストセット（10,000サブセット）
- 各サブセット：16,000パッチ（均等サンプリング）
- **適合率**: 94.31%（大幅改善）
- **再現率**: 89.29%（変化なし）
- その他の指標：変化なし

### 3.3 感度分析

**TC Chantal（1983年9月10-15日）の事例**：
- **初期段階**：MSW 35ノット（弱いTC）
  - vo850の円形パターンが不明瞭
  - 位置特定誤差が大きい
  - モデルの予測が分散
  
- **中期段階**：MSW 65ノット（強いTC）
  - vo850の円形パターンが明確
  - 位置特定誤差が小さい
  - モデルの予測が収束
  
- **最終段階**：MSW 30ノット（弱いTC）
  - 再び位置特定誤差が増加

**結論**：TC強度（MSW）と位置特定精度には相関がある

### 3.4 ケーススタディ

#### TC Keoni（1993年8月9日-9月4日）
- ハリケーンに発達（最大MSW 115ノット）
- **観察結果**：
  - 初期・最終段階：低MSW → 高い位置特定誤差
  - 中期段階：高MSW → 低い位置特定誤差
  - アンサンブルがモデル#13より実際の経路に収束
  - 両者の不連続点（TC未検出）は同じ

#### TC Julio（日付不明）
- **特筆すべき結果**：
  - 訓練セットから除外されたDisturbance Storm（DS）ステータスも検出可能
  - アンサンブルの位置特定誤差がモデル#13より大幅に小さい
  - アンサンブルがより堅牢で実際の経路に収束

## 4. 考察と結論

### 4.1 主要な成果

1. **アンサンブルアプローチの有効性**
   - 単一モデルより高い位置特定精度（平均118.46 km）
   - IQR法により9 kmの追加改善
   - 13個のモデルから異なる空間特徴を学習

2. **汎化能力**
   - 訓練に使用されなかったTCカテゴリ（DS、NR）も検出可能
   - 様々なTC強度に対応

3. **非サイクロン中心パッチの利点**
   - TC中心がパッチ内の任意の位置に出現可能
   - 位置に依存しない空間パターン学習

4. **複数TC検出**
   - 同時に複数のTCが発生する場合にも対応

### 4.2 限界と課題

1. **データの不確実性**
   - IBTrACS：0.1°グリッドでの位置情報
   - ERA5：0.25°グリッドでの再解析データ
   - TC強度に反比例する不確実性

2. **ERA5の特性**
   - TCの同化が行われていない（JRA-55やNCEP-CFSRとは異なる）
   - それでも高い空間解像度により良好な性能

3. **適用範囲**
   - 北太平洋・北大西洋に限定
   - 他の形成海域への適用は未検証

4. **複雑なワークフロー**
   - 大規模データ処理
   - 高性能計算インフラが必要

### 4.3 今後の展望

1. **決定論的手法との比較**
   - NOAA TStormなどとの性能比較を計画

2. **統合パイプラインの開発**
   - ESMシミュレーション出力への直接適用
   - eFlows4HPCプロジェクトでの実装

3. **気候変動への応用**
   - interTwinプロジェクトでの展開
   - CMIP実験データを用いた将来予測
   - TC頻度と位置への気候変動影響評価

4. **他の海域への拡張**
   - 世界中のTC形成海域への適用

### 4.4 技術的貢献

1. **エンドツーエンド学習**
   - TC分類と位置特定を単一タスクで実現
   - 主観的閾値の排除

2. **アンサンブル学習**
   - 複数モデルの知識統合
   - 不確実性の低減

3. **データ駆動アプローチ**
   - 再解析データから直接学習
   - 決定論的手法の補完

## 5. データとコードの公開

### データソース
1. **ERA5再解析データ**
   - 単一レベル：https://cds.climate.copernicus.eu/
   - 気圧レベル：https://cds.climate.copernicus.eu/

2. **IBTrACSデータ**
   - https://www.ncei.noaa.gov/data/international-best-track-archive-for-climate-stewardship-ibtracs/

3. **ソースコード**
   - https://github.com/CMCC-Foundation/ml-tropical-cyclones-detection

## 6. 謝辞

本研究は以下のプロジェクトの支援を受けています：
- eFlows4HPC（Horizon 2020、助成金番号：955558）
- InterTwin（Horizon Europe、助成金番号：101058386）

## まとめ

本論文は、ERA5再解析データを用いた機械学習アンサンブルアプローチによる熱帯低気圧検出手法を提案しました。13個のVGGライクニューラルネットワークを組み合わせることで、従来の決定論的手法の限界を克服し、平均118.46 kmの位置特定精度を達成しました。特に、訓練に使用されなかったTCカテゴリも検出可能という汎化能力の高さが示されました。今後、気候変動研究やリアルタイム予測への応用が期待されます。
