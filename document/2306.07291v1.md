# ERA5再解析データを用いた熱帯低気圧検出のためのアンサンブル機械学習アプローチ

## 著者情報
- **Gabriele Accarino**¹ - Centro Euro-Mediterraneo sui Cambiamenti Climatici (CMCC)、Advanced Scientific Computing Division
- **Davide Donno**¹ - CMCC
- **Francesco Immorlano**¹'² - CMCC & University of Salento
- **Donatello Elia**¹ - CMCC
- **Giovanni Aloisio**¹'² - CMCC & University of Salento

¹Advanced Scientific Computing Division, Centro Euro-Mediterraneo sui Cambiamenti Climatici, Lecce, Italy
²Department of Innovation Engineering, University of Salento, Lecce, Italy

**掲載誌：** Journal of Advances in Modeling Earth Systems

## 要点

- ERA5再解析とIBTrACS記録を用いた機械学習（ML）ベースのTC検出アプローチを提案
- 訓練に使用したものよりも低いTCカテゴリーを正確に検出することができた
- アンサンブルアプローチにより、単一モデルのTC中心推定と比較してTC位置特定性能がさらに向上

## 概要

熱帯低気圧（TC）は、自然界で最も破壊的な現象の一つです。毎年、世界平均で約90個のTCが熱帯海域で発生し、地球温暖化によってより強力で大規模、そしてより破壊的になっています。このような現象の正確な検出と追跡は、気象・気候科学において重要で興味深い研究分野となっています。

従来、TCは主観的な閾値に依存する決定論的追跡スキームを使用して、大規模気候データセット内で識別されてきました。機械学習（ML）モデルは、利用可能なデータから入力気候駆動因子とTC中心の地理的位置との間のマッピングを捉える能力により、決定論的アプローチを補完することができます。

本研究は、TC分類と位置特定の両方を単一のエンドツーエンド学習タスクに組み込んで、TC中心座標を特定するMLアンサンブルアプローチを提示します。アンサンブルは、入力データにTCの存在について合意する異なるMLモデルのTC中心推定を組み合わせます。モデルの訓練とテストには、ERA5再解析とIBTrACS記録が共同で使用されました。

### 主な成果

結果は、MLアプローチがTC検出に適しており、サンプル外データに対して優れた汎化能力を提供することを示しました。特に、訓練に使用されたものよりも低いTCカテゴリーを正確に検出することができました。さらに、アンサンブルアプローチは、単一モデルのTC中心推定と比較してTC位置特定性能をさらに向上させることができ、提案されたアプローチの優れた能力を実証しました。

## 1. はじめに

### 1.1 熱帯低気圧の特性

熱帯低気圧（TC）は、ハリケーンや台風としても知られ、自然界で見られる最も魅力的で破壊的な現象の一つです。TC形成の基礎には複数の条件があります：

#### TC形成の条件
1. **暖かい海水の凝縮** - システムにエネルギーの大部分を提供
2. **赤道からの十分な距離** - コリオリ力が作用し、典型的な回転運動を生じさせる
3. **凝縮による熱エネルギーの放出** - 空気を温め、気圧を下げる
4. **低気圧領域** - TC中心（目）は通常、強風と深い積乱雲に囲まれた低気圧領域に位置する

TCが移動すると、海洋から継続的にエネルギーを収集する自己充足システムとなります。TCが陸上に移動（上陸）すると、暖かい水の凝縮から得られるエネルギーを失い、急速に消散します。

### 1.2 サイクロン形成流域

TC形成が支持される地理的領域は「サイクロン形成流域」と呼ばれます。世界には7つの流域があり、それぞれ特定の水深と海面温度を持っています。主な結果は、年間のTC数とそれらが発達する季節の違いです。

**統計情報：**
- 毎年、世界平均で約90個のTCが熱帯海域で発生
- 地球温暖化により、より強力、大規模、破壊的になっている
- 過去50年間で：
  - 1,942件の災害がTCに起因
  - 経済損失：1兆4,076億米ドル
  - 死者：約800万人

### 1.3 研究の背景と動機

#### 従来の手法：決定論的追跡スキーム
伝統的に、TCは決定論的追跡スキーム（TCトラッカー）を使用して大規模気候データセット内で識別されてきました。これらは、サイクロン生成に重要な変数に適用される閾値によって、グリッドデータセット内の暖かいコアに関連するパターンを識別し、TC軌道に沿ってそれらを接続できるアルゴリズムです。

**2つの主要カテゴリー：**
1. **物理ベース** - 様々な気象変数に基づく
2. **力学ベース** - TRACKメソッドとOkubo-Weiss-Zeta（OWZ）アルゴリズムを含む

#### 従来手法の課題
- 閾値はスキームの作成者によって設定されるため主観的
- 主に現象に関する人間の専門知識に依存
- 特定の地理的領域や形成流域、TCカテゴリーに依存する可能性
- 手動の閾値調整は主観的なバイアスを生じる可能性
- 他の状況やドメインへの汎化能力の欠如の可能性

#### 機械学習の利点
MLモデルは以下の理由で適しています：
- 主観的な閾値を必要とせずに、入力気候駆動因子とTC中心の地理的位置との間のマッピングを利用可能なデータから捉えることができる
- 決定論的追跡スキームを補完できる

### 1.4 本研究の貢献

本研究では、北太平洋と大西洋のTC形成流域を対象としたMLベースのTC検出アプローチを提案します。

**他の研究との主な違い：**

1. **方法論的観点：**
   - MLアンサンブルアプローチを提案してTC中心座標を正確に特定
   - 単一のMLモデルでは複雑さのため信頼性の低い結果となる
   - アンサンブルにより、入力データにTCの存在について合意する異なるMLモデルのTC中心推定を組み合わせる
   - 各モデルがTC構造の異なる空間特性を学習可能
   - TC分類と位置特定を単一のエンドツーエンド学習タスクに組み込む

2. **データソース：**
   - 衛星データの代わりに、6つのERA5再解析TC予測因子を使用：
     * 平均海面気圧
     * 前回の後処理以降の10m風速突風
     * 瞬間10m風速突風
     * 850 mbでの相対渦度
     * 300 mbと500 mbでの温度
   - 再解析データは、過去の気候変数の最良の表現を提供するためにモデルシミュレーションと観測を組み合わせる

3. **正確なTC中心座標：**
   - IBTrACS（International Best Track Archive for Climate Stewardship）データセットから取得
   - 歴史的TC発生の最も完全なグローバルコレクション

## 2. 材料と方法

### 2.1 データソース

#### 2.1.1 International Best Track Archive for Climate Stewardship（IBTrACS）

**概要：**
- 制度的でオープンアクセスの中央アーカイブ
- グローバルレベルで最も完全な歴史的TCベストトラックデータセットを提供
- 12の異なる気象機関からの歴史的記録と観測を統合

**データ仕様：**
- 空間解像度：0.1°（約10 km）
- 時間範囲：1841年から現在まで
- 時間頻度：3時間毎

**本研究での選択：**
- IBTrACS v4から1980-2019年のTC記録を選択
- 時間頻度：6時間毎
- **1980年を選択した理由：** 地球規模での静止衛星画像の広範な使用を特徴とする現代時代の始まり
- **2019年までとした理由：** より最近のTC情報は異なる気象機関によって頻繁に再解析される

**地理的ドメイン：**
- 北太平洋形成流域を主なターゲット（最も活発な地域）
- 多くのTC事象が北太平洋と北大西洋の両地域を横断
- **最終対象ドメイン：** 100-320°E、0-70°N（北大西洋と北太平洋の合同）

#### 2.1.2 ERA5再解析

**データソース：** Copernicus Climate Change Service（C3S）ERA5再解析データセット

**ERA5の特徴：**
- グローバル数値気象予測と新たに利用可能な観測を最適な方法で組み合わせる
- 大気の状態の一貫した推定を生成

**収集された変数：**

1. **ERA5単一レベル再解析から：**
   - 平均海面気圧 [Pa]（msl）
   - 前回の後処理以降の10m風速突風 [m/s]（fg10）
   - 瞬間10m風速突風 [m/s]（i10fg）

2. **ERA5気圧レベル再解析から：**
   - 850 mbでの相対渦度 [s⁻¹]（vo850）
   - 300 mbでの温度 [K]（t300）
   - 500 mbでの温度 [K]（t500）

**データ仕様：**
- 空間解像度：0.25° × 0.25°（約27 km × 27 km）
- グリッドサイズ：280 × 880ピクセルの2次元マップ
- 時間解像度：6時間毎（00:00、06:00、12:00、18:00）
- 期間：1980-2019年（IBTrACSレコードと一致）
- **fg10の特別処理：** 元々は1時間毎に収集されたため、各タイムステップで過去6時間の最大値を計算

### 2.2 データ処理

#### 2.2.1 IBTrACSのフィルタリングと選択

**選択基準：**

1. **track_typeフィールド：**
   - `main`フラグが立っているレコードのみを考慮
   - 除外：`provisional`、`spur`、`provisional-spur`トラック（不確実性が高い）

2. **natureフィールド：**
   - 除外するカテゴリー：
     * **Not Reported（NR）：** 性質不明
     * **Disturbance Storms（DS）：** MSWが34ノット未満の十分に形成されていない嵐
     * **Mixture（MX）：** 異なる機関から観測システムの性質について矛盾した報告を受けたトラック

3. **最終選択：**
   - Tropical Storms（TS）
   - Extra Tropical（ET）
   - Subtropical Storms（SS）
   - 時間解像度：6時間毎

**TCトラックの分類：**
図1は、研究期間中に対象ドメインで発生した選択されたTC記録を示しています：
- **北大西洋**（水色）- 同じ流域内に限定
- **西太平洋**（黄色）- 同じ流域内に限定
- **東太平洋**（オレンジ）- 同じ流域内に限定
- **東・西太平洋**（青）- 異なる流域を横断
- **東太平洋・北大西洋**（紫）- 異なる流域を横断

#### 2.2.2 パッチ生成とラベリング

**パッチ生成プロセス：**

1. **タイリング：**
   - 各気候駆動因子について、ERA5マップ（280 × 880ピクセル）を7 × 22の重複しない40 × 40ピクセルのパッチに均等にタイル分割
   - TC目は必ずしもパッチの中心ではなく、パッチ内の任意のピクセルで発生可能（非サイクロン中心パッチ）

2. **スタッキング：**
   - 駆動因子をまとめてスタック
   - 結果のデータ次元：40 × 40 × 6

3. **ラベリング：**
   - **正例パッチ（TCを含む）：** IBTrACSから抽出された緯度・経度座標をERA5グリッド解像度（0.25° × 0.25°）に丸める
   - 丸められた座標を行・列インデックスペア（40 × 40パッチを行列として）としてローカルパッチ位置に変換
   - **負例パッチ（TCを含まない）：** 負の行・列座標（[-1, -1]）でラベル付け

**重要な考慮事項：**
- 特定の時刻に対象ドメイン内で複数のTC現象が同時に発生する可能性
- したがって、単一のERA5マップから複数の正例パッチを取得可能

### 2.3 実験設定

#### 2.3.1 データセット作成

**訓練・テストセット分割：**
- **テストセット：** 各10年間の連続する2年間を選択（1983、1984、1993、1994、2003、2004、2013、2014）
- **訓練セット：** 残りの年のパッチ
- **利点：** 訓練セットが全期間にわたるため、入力大気駆動因子に影響を与える可能性のある気候変動パターンをMLモデルが捉えて学習できる

**訓練セットの負例選択戦略：**

1. **近傍パッチ（nearest patches）：**
   - 正例パッチを囲むエッジパッチの中から、暴風中心に最も近い3つのコーナーパッチを負例として選択
   - これらは負例としてラベル付けされるが、中央パッチに位置するTCの残存構造（螺旋状の風速突風の尾、平均海面気圧の最小領域など）を含む可能性
   - モデル訓練に有益

2. **ランダムパッチ：**
   - 各正例パッチについて、7 × 22パッチの中から、前述のエッジパッチを除いてランダムに1つの負例サンプルを選択
   - 主要なTC現象が選択されたパッチ内に発生しないことを保証

**データ不均衡への対処：**
- 訓練セットは負例サンプルに不均衡（55,639正例パッチ、212,679負例パッチ = 20%がTCを含む）
- **選択的データ拡張：**
  - 各正例サンプルについて3つの変換を適用：
    * 左右反転
    * 上下反転
    * 180°回転

**テストセット：**
- テストセット年の各マップの全7 × 22パッチを選択
- **構成：** 967,513負例パッチ、14,149正例パッチ
- **強い不均衡：** わずか1.46%の正例サンプル

#### 2.3.2 ニューラルネットワークアーキテクチャ

**タスクの定義：**
6つの気候駆動因子を含む各入力パッチについて、TC検出タスクはTC中心に対応するローカル行・列座標（存在する場合）を予測することを目的とします。

**タスクの分割：**
論理的には、検出タスクは2つの連続するサブタスクに分割できます：

1. **分類：** 入力パッチ内のTCの存在または不在を判定
2. **位置特定：** 存在する場合、TC中心座標を予測

**アーキテクチャ：VGG様ニューラルネットワーク**

複数のVGG様ニューラルネットワークアーキテクチャを開発および訓練：
- レイヤー数、フィルター、カーネルサイズが異なる

**全体アーキテクチャ（図3）：**

1. **エンコーダー段階：**
   - 一連の畳み込み層とマックスプーリング層
   - 入力ボリュームをエンコード
   - 高さと幅の次元を徐々に減少させながら、活性化ボリュームの深さを増加
   - ボトルネック層で終了（処理された情報を圧縮し、パッチコンテンツの低次元表現を生成）

2. **デコーダー段階：**
   - ボトルネック出力をフラット化
   - 一連の密層を通して処理
   - 情報を徐々に再構築し、パッチ内のTC中心のターゲット行・列座標とリンク

**VGGネットワークの学習目標：**
入力気候駆動因子の内容と2つの出力座標との間のマッピングを学習

**モデル構成：**
合計4つの異なるモデル構成を評価：

1. **VGG V1、V2、V3：** 複雑さが異なる
2. **VGG V4：** 各基本畳み込み層をカスタマイズされたものに置き換え：
   - Conv + ガウスノイズ（オプション）
   - バッチ正規化（オプション）
   - ドロップアウト（オプション）
   - Leaky ReLU
   - オプションのハイパーパラメータは各レイヤーで選択的に活性化
   - 最初の2つの畳み込み層はカーネルサイズが可変
   - TC目とその周囲構造を含むより広い空間特徴を捉えることが可能

#### 2.3.3 訓練と検証

**データ分割：**
- 各モデル構成について、訓練パッチの25%を検証目的で使用
- 残りを実際の訓練に使用

**前処理：**
- 6つの入力駆動因子を[0, 1]範囲で正規化
- データ拡張手順に従って拡張

**訓練パラメータ：**
- エポック数：500
- バッチサイズ：8,192パッチ
- オプティマイザ：Adam
- 学習率：1e⁻⁴

**損失関数：**

1. **平均絶対誤差（MAE）：**
   - 実座標と予測座標の間のMAE

2. **サイクロン分類位置特定（CCL）損失（カスタム損失）：**
   - MAE、二値クロスエントロピー（BCE）損失、実座標と予測座標間のユークリッド距離（L2）の線形結合
   - 2つの目標を同時に追求：
     * 分類誤差の最小化（BCEを通じて）
     * 位置特定誤差の最小化（MAEとL2項を通じて）

**訓練されたモデル：**
異なるハイパーパラメータ構成に基づき、合計13モデルを訓練

#### 2.3.4 テストメトリクス

テストセットは、サンプル外データに対する訓練済みMLモデルの汎化能力を評価するために使用されました。

**評価メトリクス：**

1. **分類メトリクス：**
   - 偽陽性（FP）率
   - 真陽性（TP）率
   - 偽陰性（FN）率
   - 真陰性（TN）率
   - 適合率（Precision）
   - 再現率（Recall）
   - **注記：** この文脈でのFPは、実際には存在しないのにMLモデルがパッチをTCを含むと誤って分類した場合に発生

2. **位置特定メトリクス：**
   - 実TC中心座標と予測TC中心座標間のユークリッド距離
   - MLモデルによって正しく正例（TP）として分類されたパッチについてのみ計算

#### 2.3.5 コンセンサスとモデルアンサンブル

**アンサンブルの必要性：**
13モデルは異なるハイパーパラメータおよび/またはレイヤー構成のセットで訓練されているため、各モデルは訓練セットパッチ内の異なる特性と高レベル特徴を学習します。

**アンサンブルアプローチ（図4）：**

1. **コンセンサス評価：**
   - テストセットの各パッチについて、まず何個のモデルがそれを正例として分類することに合意するかを評価
   - 合意すべきモデル数（図4のm）は追加のハイパーパラメータ
   - パッチがTCを含む可能性が高いと見なされるために必要な最小コンセンサスレベルを示す

2. **パラメータ設定：**
   - 試行錯誤により、検証セットでm = 7に設定
   - テストセットでのFP率とFN率の間のトレードオフを達成
   - 極端気象事象（EWE）の発生予測タスクでは、FNの数が少ない方が望ましい

3. **四分位範囲（IQR）法：**
   - さらなるフィルタリングステップとして採用
   - 中央値に近い推定のみを保持
   - 以下の不等式を満たすTC中心推定（x）を外れ値として考慮：
     ```
     x < Q₁ - 1.5 * IQR ∨ x > Q₃ + 1.5 * IQR
     ```
   - IQRは第3四分位（Q₃）と第1四分位（Q₁）の差として計算
   - データの中央値周辺の広がりに関する情報を提供

4. **最終位置特定：**
   - インライア（外れ値でないもの）の行・列推定のアンサンブル平均としてTC中心を位置特定

## 3. 結果

### 3.1 個別モデルの性能

表1は、セクション2.3.4で提示された評価メトリクスに従った、テストセットでの13モデルの平均結果をまとめています。

**位置特定サブタスクの結果：**

- **最良モデル：** VGG V1とVGG V4（モデル#1と#4）
  - 予測TC中心座標と実TC中心座標間の平均ユークリッド距離が最小
  - VGG V2とVGG V3（モデル#2と#3）と比較して優れた性能
  - すべてカーネルサイズ3で訓練

- **CCL損失の使用：**
  - MAEの代わりにCCL損失を使用した場合も同様の結果（モデル#5〜#8）

- **カーネルサイズの影響：**
  - VGG V4モデル、カーネルサイズ5、MAE損失（モデル#9）：ユークリッド距離116.38 km
  - カーネルサイズを13まで増やしても位置特定誤差はさらに改善されない
  - カーネルサイズの増加により空間TCパターンをより良く抽出でき、FNの数が減少（モデル#12と#13）

- **一般的な傾向：**
  - ユークリッド距離での高い位置特定誤差は、FN率の低減に対応（低い方が良い）

**分類サブタスクの結果：**

- **トレードオフ：** FP率とFN率はトレードオフの関係
  - 低いFN率は高いFP率に対応
  - EWE検出の研究では、FNよりもFPの方が一般的に適切
  - 誤報（FP）は、モデルがTCを存在しないと誤って分類する状況（FN）よりも望ましい

### 3.2 MLアンサンブルアプローチによる検出

**アンサンブル性能（表1、最後から2行目）：**

- **位置特定精度：** 
  - 実TC中心と推定TC中心間の平均位置特定距離：約118.46 km
  - IQR法を適用しない場合：127.5 km
  - **改善：** IQR法により9 kmの位置特定精度向上

- **分類性能：**
  - FP率：5.38%
  - FN率：10.71%
  - 再現率：89.29%（TCセンターの識別に高い信頼性）
  - 適合率：19.53%（FPの数（52,051）がTPの数（12,634）の4倍以上）

**不均衡データセットでの評価の問題：**
正例サンプルと負例サンプル間の強い不均衡により、アンサンブル分類スキルの誤解を招く認識を生じる可能性があります。

**バランスの取れたサブセットでの追加評価：**
- テストセットからランダムにサンプリングされた10,000のバランスの取れたサブセット
- 各サブセット：16,000テストパッチ
- ランダム性とサブセットの多数により実験の統計的意義を保証

**結果（表1、最後の行）：**
- 適合率：94.31%に大幅に増加
- 他のメトリクスはほとんど影響を受けない
- アンサンブルはバランスの取れたデータセットで適合率と再現率の両方の観点から優れた分類スキル
